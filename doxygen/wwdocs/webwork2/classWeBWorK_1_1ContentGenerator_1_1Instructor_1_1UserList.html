<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WeBWorK2: WeBWorK::ContentGenerator::Instructor::UserList Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="classWeBWorK.html">WeBWorK</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator.html">ContentGenerator</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html">Instructor</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html">UserList</a>
  </div>
</div>
<div class="contents">
<h1>WeBWorK::ContentGenerator::Instructor::UserList Class Reference</h1><!-- doxytag: class="WeBWorK::ContentGenerator::Instructor::UserList" --><!-- doxytag: inherits="WeBWorK::ContentGenerator::Instructor" --><div class="dynheader">
Inheritance diagram for WeBWorK::ContentGenerator::Instructor::UserList:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList__inherit__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_inherit__map" alt="Inheritance graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_inherit__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_inherit__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="33,155,289,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="65,80,257,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="120,5,203,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for WeBWorK::ContentGenerator::Instructor::UserList:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList__coll__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_coll__map" alt="Collaboration graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_coll__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList_coll__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="33,155,289,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="65,80,257,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="120,5,203,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a52a8254a0a998cac40bfb8cb8a32c4ac">savePassword_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#aacddf7204d9d3b34ceb694b6dad65046">cancelEdit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a5f48074bdc6117f3308b3c3214b41dad">export_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ac10194bad0086538ac682b7188b52355">menuLabels</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a48a904752b913f9100ac72c87d95354a">bySection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2e4b796feeb6965523bee81683b1f95b">saveEdit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a189ddae798e4df2dd9de306f60d686d0">byPermission</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a05f897e633a49e8f18eb95ece73f1972">cancelPassword_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a0516915a55298174e507ea77b702f778">byComment</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8b3a694eeb482ebf52d929148a891fe1">add_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#af3e82a35c1bb47c72fc4554f9df47f8e">byRecitation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3823d5e5c9087851f428862c4d00ecd0">cancelEdit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3160f367879c3d0c4cced3441de29597">recordEditHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ab7a7853ace4205eeab5f537f212b3547">delete_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3012034a77fe6b5f1fb34580c8a33c8b">import_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae17a2b6ba3e3ef398577c26038c77cc5">edit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#aa31b0960cc8dcf8c14cd96cf085205c6">getTableParams</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#acddcbb733f3c62c352edf2a75358d317">printTableHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2afee224c85e387c6e6f3e62413c4172">export_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2163f9025eeacd96615fe149f9ea587d">importUsersFromCSV</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9fedaced9ca6e907c78a8d8e0a68df27">sort_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adc01385f3a67a0d0baed41277763d816">delete_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae4bbf62c4004804fd47c131e525695c8">exportUsersToCSV</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a19a8406fc05a59e064ae80b79eddc8fd">filter_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#abf19a3a98cfe26f4235979b1f7f121ac">add_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a659da84268e933f8d41856060679d77e">pre_header_initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9828fbe24b12ffcbac972f4d5e85331b">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a61d96f770322da0c8d4da81ef89e1f30">body</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8571c130f4e668504dc10787b279e8d7">sort_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9a42241e6d9eacfe66143a429f4f226d">edit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8c1397c6d01ff43174ccd5224ef1be3c">byLastName</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a1c9f24e6ef92d7f80b8d7112c82981ea">saveEdit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a54e0165e434342f15e2588d82c1eea45">byStatus</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a4d423604bdbf7fb549bb41b89b2e3671">byStudentID</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adbd92ad94b62de690abdc21afe5c65a2">fieldEditHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a564175bbda42b1549c82ea771fbcde68">password_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a4178dd49c9c5b919d8b46c7bfbaca14c">password_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a59e93bcd65989ef606b5b4fb558086f0">filter_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#abbe8b2a8690e9ce60467949aef469e82">getActionParams</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a5ea0ebdc5e1f2c2ad95e0e64c557bc85">savePassword_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae73485bd1ebbc1686048c39149dc32de">byEmailAddress</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a82bb742bee9d19170c4b1f738582b98e">byUserID</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae8b458814fdc9a6314a08e77c1cc3caf">cancelPassword_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8deed1b7764b27799f62cc83debeac65">import_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adb6acb2b819ca8add09adaff34b0fd5a">byFirstName</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="NAME">
NAME</a></h2>
<p><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html">WeBWorK::ContentGenerator::Instructor::UserList</a> - Entry point for User-specific data editing </p>
<p>What do we want to be able to do here? </p>
<p><a class="el" href="classFilter.html">Filter</a> what users are shown:</p>
<ul>
<li>none, all, selected</li>
<li>matching user_id, matching section, matching recitation Switch from view mode to edit mode:</li>
<li>showing visible users</li>
<li>showing selected users Switch from edit mode to view and save changes Switch from edit mode to view and abandon changes Switch from view mode to password mode:</li>
<li>showing visible users</li>
<li>showing selected users Switch from password mode to view and save changes Switch from password mode to view and abandon changes Delete users:</li>
<li>visible</li>
<li>selected Import users:</li>
<li>replace:<ul>
<li>any users</li>
<li>visible users</li>
<li>selected users</li>
<li>no users</li>
</ul>
</li>
<li>add:<ul>
<li>any users</li>
<li>no users Export users:</li>
</ul>
</li>
<li>export:<ul>
<li>all</li>
<li>visible</li>
<li>selected</li>
</ul>
</li>
<li>to:<ul>
<li>existing file on server (overwrite): [ list of files ]</li>
<li>new file on server (create): [ filename ] </li>
</ul>
</li>
</ul>

<p>Definition at line <a class="el" href="UserList_8pm_source.html#l00063">63</a> of file <a class="el" href="UserList_8pm_source.html">UserList.pm</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8b3a694eeb482ebf52d929148a891fe1"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::add_form" ref="a8b3a694eeb482ebf52d929148a891fe1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::add_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-add_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in add_form: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8b3a694eeb482ebf52d929148a891fe1">add_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Add &quot;</span>, CGI::input({name=&gt;<span class="stringliteral">&#39;number_of_students&#39;</span>, value=&gt;1,size =&gt; 3}), <span class="stringliteral">&quot; student(s). &quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="abf19a3a98cfe26f4235979b1f7f121ac"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::add_handler" ref="abf19a3a98cfe26f4235979b1f7f121ac" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::add_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-add_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in add_handler: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#abf19a3a98cfe26f4235979b1f7f121ac">add_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
<span class="preprocessor">    # This action is redirected to the addUser.pm module using ../instructor/add_user/...</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Nothing done by add student handler&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a61d96f770322da0c8d4da81ef89e1f30"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::body" ref="a61d96f770322da0c8d4da81ef89e1f30" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::body </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-body' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-body-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-body-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-body-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in body: 341</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a61d96f770322da0c8d4da81ef89e1f30">body</a> {
    my ($self)       = @_;
    my $r            = $self-&gt;r;
    my $urlpath      = $r-&gt;urlpath;
    my $db           = $r-&gt;db;
    my $ce           = $r-&gt;ce;
    my $authz        = $r-&gt;authz;   
    my $courseName   = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setID        = $urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);       
    my $user         = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    
    my $root = $ce-&gt;{webworkURLs}-&gt;{root};

<span class="preprocessor">    # templates for getting field names</span>
<span class="preprocessor"></span>    my $userTemplate            = $self-&gt;{userTemplate}            = $db-&gt;newUser;
    my $permissionLevelTemplate = $self-&gt;{permissionLevelTemplate} = $db-&gt;newPermissionLevel;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to access the instructor tools.&quot;</span>))
        unless $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;access_instructor_tools&quot;</span>);
    
<span class="preprocessor">    # This table can be consulted when display-ready forms of field names are needed.</span>
<span class="preprocessor"></span>    my %prettyFieldNames = map { $_ =&gt; $_ } 
        $userTemplate-&gt;FIELDS(),
        $permissionLevelTemplate-&gt;FIELDS();
    
    @prettyFieldNames{qw(
        user_id 
        first_name 
        last_name 
        email_address 
        student_id 
        status 
        section 
        recitation 
        comment 
        permission
    )} = (
        <span class="stringliteral">&quot;Login Name&quot;</span>, 
        <span class="stringliteral">&quot;First Name&quot;</span>, 
        <span class="stringliteral">&quot;Last Name&quot;</span>, 
        <span class="stringliteral">&quot;Email Address&quot;</span>, 
        <span class="stringliteral">&quot;Student ID&quot;</span>, 
        <span class="stringliteral">&quot;Status&quot;</span>, 
        <span class="stringliteral">&quot;Section&quot;</span>, 
        <span class="stringliteral">&quot;Recitation&quot;</span>, 
        <span class="stringliteral">&quot;Comment&quot;</span>, 
        <span class="stringliteral">&quot;Permission Level&quot;</span>
    );
    
    $self-&gt;{prettyFieldNames} = \%prettyFieldNames;
<span class="preprocessor">    ########## set initial values for state fields</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    # exclude set-level proctors</span>
<span class="preprocessor"></span>    my @allUserIDs = grep {$_ !~ /^set_id:/} $db-&gt;listUsers;
<span class="preprocessor">    # DBFIXME count would work</span>
<span class="preprocessor"></span>    $self-&gt;{totalSets} = $db-&gt;listGlobalSets; # save <span class="keywordflow">for</span> use in <span class="stringliteral">&quot;assigned sets&quot;</span> links
    $self-&gt;{allUserIDs} = \@allUserIDs;
    
<span class="preprocessor">    # DBFIXME filter in the database</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;visable_user_string&quot;</span>)) {
        my @visableUserIDs = split /:/, $r-&gt;param(<span class="stringliteral">&quot;visable_user_string&quot;</span>);
        $self-&gt;{visibleUserIDs} = [ @visableUserIDs ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;visible_users&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [];
    } <span class="keywordflow">else</span> {
        <span class="keywordflow">if</span> ((@allUserIDs &gt; HIDE_USERS_THRESHHOLD) and (not defined $r-&gt;param(<span class="stringliteral">&quot;show_all_users&quot;</span>) )) {
            $self-&gt;{visibleUserIDs} = [];
        } <span class="keywordflow">else</span> {
            $self-&gt;{visibleUserIDs} = [ @allUserIDs ];
        }
    }
    
    $self-&gt;{prevVisibleUserIDs} = $self-&gt;{visibleUserIDs};
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;selected_users&quot;</span>)) {
        $self-&gt;{selectedUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;selected_users&quot;</span>) ];
    } <span class="keywordflow">else</span> {
        $self-&gt;{selectedUserIDs} = [];
    }
    
    $self-&gt;{editMode} = $r-&gt;param(<span class="stringliteral">&quot;editMode&quot;</span>) || 0;

    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to modify student data&quot;</span>))
        <span class="keywordflow">if</span> $self-&gt;{editMode} and not $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;modify_student_data&quot;</span>);


    $self-&gt;{passwordMode} = $r-&gt;param(<span class="stringliteral">&quot;passwordMode&quot;</span>) || 0;

    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to modify student data&quot;</span>))
        <span class="keywordflow">if</span> $self-&gt;{passwordMode} and not $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;modify_student_data&quot;</span>);

    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;labelSortMethod&quot;</span>)) {
        $self-&gt;{primarySortField} = $r-&gt;param(<span class="stringliteral">&quot;labelSortMethod&quot;</span>);
        $self-&gt;{secondarySortField} = $r-&gt;param(<span class="stringliteral">&quot;primarySortField&quot;</span>);
        $self-&gt;{ternarySortField} = $r-&gt;param(<span class="stringliteral">&quot;secondarySortField&quot;</span>);
    }
    <span class="keywordflow">else</span> {          
        $self-&gt;{primarySortField} = $r-&gt;param(<span class="stringliteral">&quot;primarySortField&quot;</span>) || <span class="stringliteral">&quot;last_name&quot;</span>;
        $self-&gt;{secondarySortField} = $r-&gt;param(<span class="stringliteral">&quot;secondarySortField&quot;</span>) || <span class="stringliteral">&quot;first_name&quot;</span>;
        $self-&gt;{ternarySortField} = $r-&gt;param(<span class="stringliteral">&quot;ternarySortField&quot;</span>) || <span class="stringliteral">&quot;student_id&quot;</span>;
    }
    
<span class="preprocessor">    # DBFIXME use an iterator</span>
<span class="preprocessor"></span>    my @allUsers = $db-&gt;getUsers(@allUserIDs);
    my (%sections, %recitations);
    <span class="keywordflow">foreach</span> my $User (@allUsers) {
        push @{$sections{defined $User-&gt;section ? $User-&gt;section : <span class="stringliteral">&quot;&quot;</span>}}, $User-&gt;user_id;
        push @{$recitations{defined $User-&gt;recitation ? $User-&gt;recitation : <span class="stringliteral">&quot;&quot;</span>}}, $User-&gt;user_id;
    }
    $self-&gt;{sections} = \%sections;
    $self-&gt;{recitations} = \%recitations;
    
<span class="preprocessor">    ########## call action handler</span>
<span class="preprocessor"></span>    
    my $actionID = $r-&gt;param(<span class="stringliteral">&quot;action&quot;</span>);
    <span class="keywordflow">if</span> ($actionID) {
        unless (grep { $_ eq $actionID } @{ VIEW_FORMS() }, @{ EDIT_FORMS() }, @{ PASSWORD_FORMS() } ) {
            die <span class="stringliteral">&quot;Action $actionID not found&quot;</span>;
        }
<span class="preprocessor">        # Check permissions</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (not FORM_PERMS()-&gt;{$actionID} or $authz-&gt;hasPermissions($user, FORM_PERMS()-&gt;{$actionID})) {
            my $actionHandler = <span class="stringliteral">&quot;${actionID}_handler&quot;</span>;
            my %genericParams;
            <span class="keywordflow">foreach</span> my $param (qw(selected_users)) {
                $genericParams{$param} = [ $r-&gt;param($param) ];
            }
            my %actionParams = $self-&gt;getActionParams($actionID);
            my %tableParams = $self-&gt;getTableParams();
            print CGI::p(
                <span class="stringliteral">&#39;&lt;div style=&quot;color:green&quot;&gt;&#39;</span>,
                <span class="stringliteral">&quot;Result of last action performed: &quot;</span>,
                CGI::i($self-&gt;$actionHandler(\%genericParams, \%actionParams, \%tableParams)),
                <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>,
                CGI::hr()
            );
        } <span class="keywordflow">else</span> {
            <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to perform this action.&quot;</span>));
        }
    }
        
<span class="preprocessor">    ########## retrieve possibly changed values for member fields</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    #@allUserIDs = @{ $self-&gt;{allUserIDs} }; # do we need this one?</span>
<span class="preprocessor"></span><span class="preprocessor">    # DBFIXME instead of re-listing, why not add added users to $self-&gt;{allUserIDs} ?</span>
<span class="preprocessor"></span><span class="preprocessor">    # exclude set-level proctors</span>
<span class="preprocessor"></span>    @allUserIDs = grep {$_ !~ /^set_id:/} $db-&gt;listUsers; # recompute value in <span class="keywordflow">case</span> some were added
    my @visibleUserIDs = @{ $self-&gt;{visibleUserIDs} };
    my @prevVisibleUserIDs = @{ $self-&gt;{prevVisibleUserIDs} };
    my @selectedUserIDs = @{ $self-&gt;{selectedUserIDs} };
    my $editMode = $self-&gt;{editMode};
    my $passwordMode = $self-&gt;{passwordMode};   
    my $primarySortField = $self-&gt;{primarySortField};
    my $secondarySortField = $self-&gt;{secondarySortField};
    my $ternarySortField = $self-&gt;{ternarySortField};
    
<span class="preprocessor">    #warn &quot;visibleUserIDs=@visibleUserIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;prevVisibleUserIDs=@prevVisibleUserIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;selectedUserIDs=@selectedUserIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;editMode=$editMode\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;passwordMode=$passwordMode\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;primarySortField=$primarySortField\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;secondarySortField=$secondarySortField\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;ternarySortField=$ternarySortField\n&quot;;</span>
<span class="preprocessor"></span>
<span class="preprocessor">    ########## get required users</span>
<span class="preprocessor"></span>        
    my @Users = grep { defined $_ } @visibleUserIDs ? $db-&gt;getUsers(@visibleUserIDs) : ();

    my %sortSubs = %{ SORT_SUBS() };
    my $primarySortSub = $sortSubs{$primarySortField};
    my $secondarySortSub = $sortSubs{$secondarySortField};
    my $ternarySortSub = $sortSubs{$ternarySortField};
    
<span class="preprocessor">    # add permission level to user record hash so we can sort it if necessary</span>
<span class="preprocessor"></span><span class="preprocessor">    # DBFIXME this calls for a join... (i&#39;d like the User record to contain permission level info)</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($primarySortField eq <span class="stringliteral">&#39;permission&#39;</span> or $secondarySortField eq <span class="stringliteral">&#39;permission&#39;</span> or $ternarySortField eq <span class="stringliteral">&#39;permission&#39;</span>) {
        <span class="keywordflow">foreach</span> my $User (@Users) {
            next unless $User;
            my $permissionLevel = $db-&gt;getPermissionLevel($User-&gt;user_id);
                            $User-&gt;{permission} = $permissionLevel-&gt;permission;
        }
    }
        
    
<span class="preprocessor">#   # don&#39;t forget to sort in opposite order of importance</span>
<span class="preprocessor"></span><span class="preprocessor">#   @Users = sort $secondarySortSub @Users;</span>
<span class="preprocessor"></span><span class="preprocessor">#   @Users = sort $primarySortSub @Users;</span>
<span class="preprocessor"></span><span class="preprocessor">#   #@Users = sort byLnFnUid @Users;</span>
<span class="preprocessor"></span>
<span class="preprocessor">#   Always have a definite sort order even if first three sorts don&#39;t determine things</span>
<span class="preprocessor"></span>    @Users = sort {
        &amp;$primarySortSub
            ||
        &amp;$secondarySortSub 
            ||
        &amp;$ternarySortSub
            ||
        <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8c1397c6d01ff43174ccd5224ef1be3c">byLastName</a>
            ||
        <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adb6acb2b819ca8add09adaff34b0fd5a">byFirstName</a>
            ||
        <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a82bb742bee9d19170c4b1f738582b98e">byUserID</a>
        } 
        @Users;
        
    my @PermissionLevels;
    
    <span class="keywordflow">for</span> (my $i = 0; $i &lt; @Users; $i++) {
        my $User = $Users[$i];
<span class="preprocessor">        # DBFIX we maybe already have the permission level from above (for use in sorting)</span>
<span class="preprocessor"></span>        my $PermissionLevel = $db-&gt;getPermissionLevel($User-&gt;user_id); # checked
        
<span class="preprocessor">        # DBFIXME this should go in the DB layer</span>
<span class="preprocessor"></span>        unless ($PermissionLevel) {
<span class="preprocessor">            # uh oh! no permission level record found!</span>
<span class="preprocessor"></span>            warn <span class="stringliteral">&quot;added missing permission level for user &quot;</span>, $User-&gt;user_id, <span class="stringliteral">&quot;\n&quot;</span>;
            
<span class="preprocessor">            # create a new permission level record</span>
<span class="preprocessor"></span>            $PermissionLevel = $db-&gt;newPermissionLevel;
            $PermissionLevel-&gt;user_id($User-&gt;user_id);
            $PermissionLevel-&gt;permission(0);
            
<span class="preprocessor">            # add it to the database</span>
<span class="preprocessor"></span>            $db-&gt;addPermissionLevel($PermissionLevel);
        }
        
        $PermissionLevels[$i] = $PermissionLevel;
    }
    
<span class="preprocessor">    ########## print beginning of form</span>
<span class="preprocessor"></span>    
    print CGI::start_form({method=&gt;<span class="stringliteral">&quot;post&quot;</span>, action=&gt;$self-&gt;systemLink($urlpath,authen=&gt;0), name=&gt;<span class="stringliteral">&quot;userlist&quot;</span>});
    print $self-&gt;hidden_authen_fields();
    
<span class="preprocessor">    ########## print state data</span>
<span class="preprocessor"></span>    
    print <span class="stringliteral">&quot;\n&lt;!-- state data here --&gt;\n&quot;</span>;
    
    <span class="keywordflow">if</span> (@visibleUserIDs) {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;visible_users&quot;</span>, -value=&gt;\@visibleUserIDs);
    } <span class="keywordflow">else</span> {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;no_visible_users&quot;</span>, -value=&gt;<span class="stringliteral">&quot;1&quot;</span>);
    }
    
    <span class="keywordflow">if</span> (@prevVisibleUserIDs) {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;prev_visible_users&quot;</span>, -value=&gt;\@prevVisibleUserIDs);
    } <span class="keywordflow">else</span> {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;no_prev_visible_users&quot;</span>, -value=&gt;<span class="stringliteral">&quot;1&quot;</span>);
    }
    
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;editMode&quot;</span>, -value=&gt;$editMode);
    
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;passwordMode&quot;</span>, -value=&gt;$passwordMode);
    
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;primarySortField&quot;</span>, -value=&gt;$primarySortField);
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;secondarySortField&quot;</span>, -value=&gt;$secondarySortField);
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;ternarySortField&quot;</span>, -value=&gt;$ternarySortField);
    
    print <span class="stringliteral">&quot;\n&lt;!-- state data here --&gt;\n&quot;</span>;
    
<span class="preprocessor">    ########## print action forms</span>
<span class="preprocessor"></span>    
    print CGI::start_table({});
    print CGI::Tr({}, CGI::td({-colspan=&gt;2}, <span class="stringliteral">&quot;Select an action to perform:&quot;</span>));
    
    my @formsToShow;
    <span class="keywordflow">if</span> ($editMode) {
        @formsToShow = @{ EDIT_FORMS() };
    }elsif ($passwordMode) {
        @formsToShow = @{ PASSWORD_FORMS() };   
    } <span class="keywordflow">else</span> {
        @formsToShow = @{ VIEW_FORMS() };
    }
    
    my $i = 0;
    <span class="keywordflow">foreach</span> my $actionID (@formsToShow) {
<span class="preprocessor">        # Check permissions</span>
<span class="preprocessor"></span>        next <span class="keywordflow">if</span> FORM_PERMS()-&gt;{$actionID} and not $authz-&gt;hasPermissions($user, FORM_PERMS()-&gt;{$actionID});
        my $actionForm = <span class="stringliteral">&quot;${actionID}_form&quot;</span>;
        my $onChange = <span class="stringliteral">&quot;document.userlist.action[$i].checked=true&quot;</span>;
        my %actionParams = $self-&gt;getActionParams($actionID);
        
        print CGI::Tr({-valign=&gt;<span class="stringliteral">&quot;top&quot;</span>},
            CGI::td({}, CGI::input({-type=&gt;<span class="stringliteral">&quot;radio&quot;</span>, -name=&gt;<span class="stringliteral">&quot;action&quot;</span>, -value=&gt;$actionID})),
            CGI::td({}, $self-&gt;$actionForm($onChange, %actionParams))
        );
        
        $i++;
    }
    my $selectAll =CGI::input({-type=&gt;<span class="stringliteral">&#39;button&#39;</span>, -name=&gt;<span class="stringliteral">&#39;check_all&#39;</span>, -value=&gt;<span class="stringliteral">&#39;Select all users&#39;</span>,
           onClick =&gt; <span class="stringliteral">&quot;for (i in document.userlist.elements)  { </span>
<span class="stringliteral">                           if (document.userlist.elements[i].name ==&#39;selected_users&#39;) { </span>
<span class="stringliteral">                               document.userlist.elements[i].checked = true</span>
<span class="stringliteral">                           }</span>
<span class="stringliteral">                        }&quot;</span> });
    my $selectNone =CGI::input({-type=&gt;<span class="stringliteral">&#39;button&#39;</span>, -name=&gt;<span class="stringliteral">&#39;check_none&#39;</span>, -value=&gt;<span class="stringliteral">&#39;Unselect all users&#39;</span>,
           onClick =&gt; <span class="stringliteral">&quot;for (i in document.userlist.elements)  { </span>
<span class="stringliteral">                           if (document.userlist.elements[i].name ==&#39;selected_users&#39;) { </span>
<span class="stringliteral">                              document.userlist.elements[i].checked = false</span>
<span class="stringliteral">                           }</span>
<span class="stringliteral">                        }&quot;</span> });
    unless ($editMode or $passwordMode) {
        print CGI::Tr({}, CGI::td({ colspan=&gt;2, -align=&gt;<span class="stringliteral">&quot;center&quot;</span>},
            $selectAll.<span class="stringliteral">&quot; &quot;</span>. $selectNone
            )
        );
    }
    print CGI::Tr({}, CGI::td({ colspan=&gt;2, -align=&gt;<span class="stringliteral">&quot;center&quot;</span>},
        CGI::submit(-value=&gt;<span class="stringliteral">&quot;Take Action!&quot;</span>) 
        )
    );
    print CGI::end_table();
    
<span class="preprocessor">    ########## print table</span>
<span class="preprocessor"></span>    
    print CGI::p({},<span class="stringliteral">&quot;Showing &quot;</span>, scalar @Users, <span class="stringliteral">&quot; out of &quot;</span>, scalar @allUserIDs, <span class="stringliteral">&quot; users.&quot;</span>);
    
    print CGI::p(<span class="stringliteral">&quot;If a password field is left blank, the student&#39;s current password will be maintained.&quot;</span>) if $passwordMode;
    if ($editMode) {
       

        print CGI::p(<span class="stringliteral">&#39;&lt;b&gt;Click&lt;/b&gt; on the login name to &lt;b&gt;edit individual problem set data&lt;/b&gt;, (e.g. due dates) for these students.&#39;</span>);
    }
    $self-&gt;printTableHTML(\@Users, \@PermissionLevels, \%prettyFieldNames,
        editMode =&gt; $editMode,
        passwordMode =&gt; $passwordMode,
        selectedUserIDs =&gt; \@selectedUserIDs,
        primarySortField =&gt; $primarySortField,
        secondarySortField =&gt; $secondarySortField,
        visableUserIDs =&gt; \@visibleUserIDs,
    );
    
    
<span class="preprocessor">    ########## print end of form</span>
<span class="preprocessor"></span>    
    print CGI::end_form();

    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a0516915a55298174e507ea77b702f778"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byComment" ref="a0516915a55298174e507ea77b702f778" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byComment </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byComment' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byComment-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byComment-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byComment-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byComment: 1</span>
<span class="preprocessor">sub byComment      { lc $a-&gt;comment       cmp lc $b-&gt;comment       }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae73485bd1ebbc1686048c39149dc32de"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byEmailAddress" ref="ae73485bd1ebbc1686048c39149dc32de" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byEmailAddress </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byEmailAddress' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byEmailAddress-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byEmailAddress-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byEmailAddress-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byEmailAddress: 1</span>
<span class="preprocessor">sub byEmailAddress { lc $a-&gt;email_address cmp lc $b-&gt;email_address }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="adb6acb2b819ca8add09adaff34b0fd5a"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byFirstName" ref="adb6acb2b819ca8add09adaff34b0fd5a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byFirstName </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byFirstName' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byFirstName-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byFirstName-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byFirstName-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byFirstName: 1</span>
<span class="preprocessor">sub byFirstName    {  (defined $a-&gt;first_name &amp;&amp; defined $b-&gt;first_name) ?  lc $a-&gt;first_name cmp lc $b-&gt;first_name  : 0;  }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a8c1397c6d01ff43174ccd5224ef1be3c"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byLastName" ref="a8c1397c6d01ff43174ccd5224ef1be3c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byLastName </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byLastName' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byLastName-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byLastName-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byLastName-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byLastName: 1</span>
<span class="preprocessor">sub byLastName     {  (defined $a-&gt;last_name  &amp;&amp; defined $b-&gt;last_name ) ?  lc $a-&gt;last_name  cmp lc $b-&gt;last_name   : 0;  }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a189ddae798e4df2dd9de306f60d686d0"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byPermission" ref="a189ddae798e4df2dd9de306f60d686d0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byPermission </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byPermission' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byPermission-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byPermission-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byPermission-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byPermission: 1</span>
<span class="preprocessor">sub byPermission   { $a-&gt;{permission}    &lt;=&gt;  $b-&gt;{permission}     }  ## permission level is added to user record hash so we can sort it if necessary</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="af3e82a35c1bb47c72fc4554f9df47f8e"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byRecitation" ref="af3e82a35c1bb47c72fc4554f9df47f8e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byRecitation </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byRecitation' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byRecitation-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byRecitation-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byRecitation-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byRecitation: 1</span>
<span class="preprocessor">sub byRecitation   { lc $a-&gt;recitation    cmp lc $b-&gt;recitation    }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a48a904752b913f9100ac72c87d95354a"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::bySection" ref="a48a904752b913f9100ac72c87d95354a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::bySection </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-bySection' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-bySection-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-bySection-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-bySection-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in bySection: 1</span>
<span class="preprocessor">sub bySection      { lc $a-&gt;section       cmp lc $b-&gt;section       }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a54e0165e434342f15e2588d82c1eea45"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byStatus" ref="a54e0165e434342f15e2588d82c1eea45" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byStatus </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byStatus' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byStatus-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byStatus-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byStatus-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byStatus: 1</span>
<span class="preprocessor">sub byStatus       { lc $a-&gt;status        cmp lc $b-&gt;status        }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a4d423604bdbf7fb549bb41b89b2e3671"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byStudentID" ref="a4d423604bdbf7fb549bb41b89b2e3671" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byStudentID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byStudentID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byStudentID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byStudentID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byStudentID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byStudentID: 1</span>
<span class="preprocessor">sub byStudentID    { lc $a-&gt;student_id    cmp lc $b-&gt;student_id    }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a82bb742bee9d19170c4b1f738582b98e"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::byUserID" ref="a82bb742bee9d19170c4b1f738582b98e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::byUserID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byUserID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byUserID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byUserID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byUserID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byUserID: 1</span>
<span class="preprocessor">sub byUserID       { lc $a-&gt;user_id       cmp lc $b-&gt;user_id       }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3823d5e5c9087851f428862c4d00ecd0"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::cancelEdit_form" ref="a3823d5e5c9087851f428862c4d00ecd0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::cancelEdit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelEdit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelEdit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelEdit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelEdit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelEdit_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3823d5e5c9087851f428862c4d00ecd0">cancelEdit_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Abandon changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aacddf7204d9d3b34ceb694b6dad65046"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::cancelEdit_handler" ref="aacddf7204d9d3b34ceb694b6dad65046" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::cancelEdit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelEdit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelEdit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelEdit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelEdit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelEdit_handler: 17</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#aacddf7204d9d3b34ceb694b6dad65046">cancelEdit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r      = $self-&gt;r;
    
<span class="preprocessor">    #$self-&gt;{selectedUserIDs} = $self-&gt;{visibleUserIDs};</span>
<span class="preprocessor"></span><span class="preprocessor">        # only do the above if we arrived here via &quot;edit selected users&quot;</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    $self-&gt;{editMode} = 0;
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;changes abandoned&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae8b458814fdc9a6314a08e77c1cc3caf"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::cancelPassword_form" ref="ae8b458814fdc9a6314a08e77c1cc3caf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::cancelPassword_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelPassword_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelPassword_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelPassword_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelPassword_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelPassword_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae8b458814fdc9a6314a08e77c1cc3caf">cancelPassword_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Abandon changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a05f897e633a49e8f18eb95ece73f1972"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::cancelPassword_handler" ref="a05f897e633a49e8f18eb95ece73f1972" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::cancelPassword_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelPassword_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelPassword_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelPassword_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelPassword_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelPassword_handler: 17</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a05f897e633a49e8f18eb95ece73f1972">cancelPassword_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r      = $self-&gt;r;
    
<span class="preprocessor">    #$self-&gt;{selectedUserIDs} = $self-&gt;{visibleUserIDs};</span>
<span class="preprocessor"></span><span class="preprocessor">        # only do the above if we arrived here via &quot;edit selected users&quot;</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    $self-&gt;{passwordMode} = 0;
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;changes abandoned&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ab7a7853ace4205eeab5f537f212b3547"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::delete_form" ref="ab7a7853ace4205eeab5f537f212b3547" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::delete_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-delete_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in delete_form: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ab7a7853ace4205eeab5f537f212b3547">delete_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
            CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>},
        <span class="stringliteral">&quot;Delete &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.delete.scope&quot;</span>,
            -values =&gt; [qw(none selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.delete.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;none&quot;</span>,
            -labels =&gt; {
                none     =&gt; <span class="stringliteral">&quot;no users.&quot;</span>,
<span class="preprocessor">                #visible  =&gt; &quot;visible users.&quot;,</span>
<span class="preprocessor"></span>                selected =&gt; <span class="stringliteral">&quot;selected users.&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
        CGI::em(<span class="stringliteral">&quot; Deletion destroys all user-related data and is not undoable!&quot;</span>),
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="adc01385f3a67a0d0baed41277763d816"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::delete_handler" ref="adc01385f3a67a0d0baed41277763d816" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::delete_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-delete_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in delete_handler: 39</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adc01385f3a67a0d0baed41277763d816">delete_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r         = $self-&gt;r;
    my $db        = $r-&gt;db;
    my $user      = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.delete.scope&quot;</span>}-&gt;[0];
    
    my @userIDsToDelete = ();
<span class="preprocessor">    #if ($scope eq &quot;visible&quot;) {</span>
<span class="preprocessor"></span><span class="preprocessor">    #   @userIDsToDelete = @{ $self-&gt;{visibleUserIDs} };</span>
<span class="preprocessor"></span><span class="preprocessor">    #} elsif ($scope eq &quot;selected&quot;) {</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @userIDsToDelete = @{ $self-&gt;{selectedUserIDs} };
    }
    
    my %allUserIDs = map { $_ =&gt; 1 } @{ $self-&gt;{allUserIDs} };
    my %visibleUserIDs = map { $_ =&gt; 1 } @{ $self-&gt;{visibleUserIDs} };
    my %selectedUserIDs = map { $_ =&gt; 1 } @{ $self-&gt;{selectedUserIDs} };
    
    my $error = <span class="stringliteral">&quot;&quot;</span>;
    my $num = 0;
    <span class="keywordflow">foreach</span> my $userID (@userIDsToDelete) {
        <span class="keywordflow">if</span> ($user eq $userID) { # don<span class="stringliteral">&#39;t delete yourself!!</span>
<span class="stringliteral">            $error = &quot;You cannot delete yourself!&quot;;</span>
<span class="stringliteral">            next;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        delete $allUserIDs{$userID};</span>
<span class="stringliteral">        delete $visibleUserIDs{$userID};</span>
<span class="stringliteral">        delete $selectedUserIDs{$userID};</span>
<span class="stringliteral">        $db-&gt;deleteUser($userID);</span>
<span class="stringliteral">        $num++;</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    $self-&gt;{allUserIDs} = [ keys %allUserIDs ];</span>
<span class="stringliteral">    $self-&gt;{visibleUserIDs} = [ keys %visibleUserIDs ];</span>
<span class="stringliteral">    $self-&gt;{selectedUserIDs} = [ keys %selectedUserIDs ];</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return &quot;deleted $num user&quot; . ($num == 1 ? &quot;&quot; : &quot;s.  &quot;) . $error;</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a9a42241e6d9eacfe66143a429f4f226d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::edit_form" ref="a9a42241e6d9eacfe66143a429f4f226d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::edit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-edit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-edit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-edit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-edit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in edit_form: 18</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9a42241e6d9eacfe66143a429f4f226d">edit_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Edit &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.edit.scope&quot;</span>,
            -values =&gt; [qw(all visible selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.edit.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;selected&quot;</span>,
            -labels =&gt; {
                all =&gt; <span class="stringliteral">&quot;all users&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible users&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected users&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae17a2b6ba3e3ef398577c26038c77cc5"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::edit_handler" ref="ae17a2b6ba3e3ef398577c26038c77cc5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::edit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-edit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-edit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-edit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-edit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in edit_handler: 20</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae17a2b6ba3e3ef398577c26038c77cc5">edit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.edit.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing all users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $self-&gt;{allUserIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing visible users&quot;</span>;
<span class="preprocessor">        # leave visibleUserIDs alone</span>
<span class="preprocessor"></span>    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing selected users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $genericParams-&gt;{selected_users}; # an arrayref
    }
    $self-&gt;{editMode} = 1;
    
    <span class="keywordflow">return</span> $result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a2afee224c85e387c6e6f3e62413c4172"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::export_form" ref="a2afee224c85e387c6e6f3e62413c4172" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::export_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-export_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in export_form: 34</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2afee224c85e387c6e6f3e62413c4172">export_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Export &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.export.scope&quot;</span>,
            -values =&gt; [qw(all visible selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.export.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;visible&quot;</span>,
            -labels =&gt; {
                all =&gt; <span class="stringliteral">&quot;all users&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible users&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected users&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot; to &quot;</span>,
        CGI::popup_menu(
            -name=&gt;<span class="stringliteral">&quot;action.export.target&quot;</span>,
            -values =&gt; [ <span class="stringliteral">&quot;new&quot;</span>, $self-&gt;getCSVList() ],
            -labels =&gt; { <span class="keyword">new</span> =&gt; <span class="stringliteral">&quot;a new file named:&quot;</span> },
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.export.target&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,
            -onchange =&gt; $onChange,
        ),
        #CGI::br(),
<span class="preprocessor">        #&quot;new file to create: &quot;,</span>
<span class="preprocessor"></span>        CGI::textfield(
            -name =&gt; <span class="stringliteral">&quot;action.export.new&quot;</span>,
            -value =&gt; $actionParams{<span class="stringliteral">&quot;action.export.new&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,,
            -width =&gt; <span class="stringliteral">&quot;50&quot;</span>,
            -onchange =&gt; $onChange,
        ),
        CGI::tt(<span class="stringliteral">&quot;.lst&quot;</span>),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a5f48074bdc6117f3308b3c3214b41dad"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::export_handler" ref="a5f48074bdc6117f3308b3c3214b41dad" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::export_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-export_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in export_handler: 35</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a5f48074bdc6117f3308b3c3214b41dad">export_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r       = $self-&gt;r;
    my $ce      = $r-&gt;ce;
    my $dir     = $ce-&gt;{courseDirs}-&gt;{templates};
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.export.scope&quot;</span>}-&gt;[0];
    my $target = $actionParams-&gt;{<span class="stringliteral">&quot;action.export.target&quot;</span>}-&gt;[0];
    my $new = $actionParams-&gt;{<span class="stringliteral">&quot;action.export.new&quot;</span>}-&gt;[0];
    
<span class="preprocessor">    #get name of templates directory as it appears in file manager</span>
<span class="preprocessor"></span>    $dir =~ s|.*/||;
    
    my $fileName;
    <span class="keywordflow">if</span> ($target eq <span class="stringliteral">&quot;new&quot;</span>) {
        $fileName = $new;
    } <span class="keywordflow">else</span> {
        $fileName = $target;
    }
    
    $fileName .= <span class="stringliteral">&quot;.lst&quot;</span> unless $fileName =~ m/\.lst$/;
    
    my @userIDsToExport;
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        @userIDsToExport = @{ $self-&gt;{allUserIDs} };
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        @userIDsToExport = @{ $self-&gt;{visibleUserIDs} };
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @userIDsToExport = @{ $self-&gt;{selectedUserIDs} };
    }
    
    $self-&gt;exportUsersToCSV($fileName, @userIDsToExport);
    
    <span class="keywordflow">return</span> scalar @userIDsToExport . <span class="stringliteral">&quot; users exported to file &amp;nbsp;&amp;nbsp; $dir/$fileName&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae4bbf62c4004804fd47c131e525695c8"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::exportUsersToCSV" ref="ae4bbf62c4004804fd47c131e525695c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::exportUsersToCSV </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-exportUsersToCSV' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-exportUsersToCSV-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-exportUsersToCSV-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-exportUsersToCSV-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in exportUsersToCSV: 27</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ae4bbf62c4004804fd47c131e525695c8">exportUsersToCSV</a> {
    my ($self, $fileName, @userIDsToExport) = @_;
    my $r       = $self-&gt;r;
    my $ce      = $r-&gt;ce;
    my $db      = $r-&gt;db;
    my $dir     = $ce-&gt;{courseDirs}-&gt;{templates};
        
    die <span class="stringliteral">&quot;illegal character in input: &#39;/&#39;&quot;</span> <span class="keywordflow">if</span> $fileName =~ m|/|;
    
    my @records;
    
<span class="preprocessor">    # DBFIXME use an iterator here</span>
<span class="preprocessor"></span>    my @Users = $db-&gt;getUsers(@userIDsToExport);
    my @Passwords = $db-&gt;getPasswords(@userIDsToExport);
    my @PermissionLevels = $db-&gt;getPermissionLevels(@userIDsToExport);
    <span class="keywordflow">foreach</span> my $i (0 .. $#userIDsToExport) {
        my $User = $Users[$i];
        my $Password = $Passwords[$i];
        my $PermissionLevel = $PermissionLevels[$i];
        next unless defined $User;
        my %record = (
            defined $PermissionLevel ? $PermissionLevel-&gt;toHash : (),
            defined $Password ? $Password-&gt;toHash : (),
            $User-&gt;toHash,
        );
        push @records, \%record;
    }
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="adbd92ad94b62de690abdc21afe5c65a2"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::fieldEditHTML" ref="adbd92ad94b62de690abdc21afe5c65a2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::fieldEditHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-fieldEditHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-fieldEditHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fieldEditHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fieldEditHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in fieldEditHTML: 101</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#adbd92ad94b62de690abdc21afe5c65a2">fieldEditHTML</a> {
    my ($self, $fieldName, $value, $properties) = @_;
    my $ce = $self-&gt;r-&gt;ce;
    my $size = $properties-&gt;{size};
    my $type = $properties-&gt;{type};
    my $access = $properties-&gt;{access};
    my $items = $properties-&gt;{items};
    my $synonyms = $properties-&gt;{synonyms};
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;email&quot;</span>) {
        <span class="keywordflow">if</span> ($value eq <span class="stringliteral">&#39;&amp;nbsp;&#39;</span>) {
            <span class="keywordflow">return</span> $value;}
        <span class="keywordflow">else</span> {
            <span class="keywordflow">return</span> CGI::a({-href=&gt;<span class="stringliteral">&quot;mailto:$value&quot;</span>},$value);
        }
    }
    
    <span class="keywordflow">if</span> ($access eq <span class="stringliteral">&quot;readonly&quot;</span>) {
<span class="preprocessor">        # hack for status</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;status&quot;</span>) {
            my $status_name = $ce-&gt;status_abbrev_to_name($value);
            <span class="keywordflow">if</span> (defined $status_name) {
                $value = <span class="stringliteral">&quot;$status_name ($value)&quot;</span>;
            }
        }
        <span class="keywordflow">return</span> $value;
    }
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;number&quot;</span> or $type eq <span class="stringliteral">&quot;text&quot;</span>) {
        <span class="keywordflow">return</span> CGI::input({type=&gt;<span class="stringliteral">&quot;text&quot;</span>, name=&gt;$fieldName, value=&gt;$value, size=&gt;$size});
    }
        
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;enumerable&quot;</span>) {
        my $matched = undef; # Whether a synonym match has occurred

<span class="preprocessor">        # Process synonyms for enumerable objects</span>
<span class="preprocessor"></span>        <span class="keywordflow">foreach</span> my $synonym (keys %$synonyms) {
            <span class="keywordflow">if</span> ($synonym ne <span class="stringliteral">&quot;*&quot;</span> and $value =~ m/$synonym/) {
                $value = $synonyms-&gt;{$synonym};
                $matched = 1;
            }
        }
        
        <span class="keywordflow">if</span> (!$matched and exists $synonyms-&gt;{<span class="stringliteral">&quot;*&quot;</span>}) {
            $value = $synonyms-&gt;{<span class="stringliteral">&quot;*&quot;</span>};
        }
        
        <span class="keywordflow">return</span> CGI::popup_menu({
            name =&gt; $fieldName, 
            values =&gt; [keys %$items],
            <span class="keywordflow">default</span> =&gt; $value,
            labels =&gt; $items,
        });
    }
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;status&quot;</span>) {
<span class="preprocessor">        # we used to surreptitously map synonyms to a canonical value...</span>
<span class="preprocessor"></span><span class="preprocessor">        # so should we continue to do that?</span>
<span class="preprocessor"></span>        my $status_name = $ce-&gt;status_abbrev_to_name($value);
        <span class="keywordflow">if</span> (defined $status_name) {
            $value = ($ce-&gt;status_name_to_abbrevs($status_name))[0];
        }
        
        my (@values, %labels);
        <span class="keywordflow">while</span> (my ($k, $v) = each %{$ce-&gt;{statuses}}) {
            my @abbrevs = @{$v-&gt;{abbrevs}};
            push @values, $abbrevs[0];
            <span class="keywordflow">foreach</span> my $abbrev (@abbrevs) {
                $labels{$abbrev} = $k;
            }
        }
        
        <span class="keywordflow">return</span> CGI::popup_menu({
            name =&gt; $fieldName, 
            values =&gt; \@values,
            <span class="keywordflow">default</span> =&gt; $value,
            labels =&gt; \%labels,
        });
    }

    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;permission&quot;</span>) {
        my ($default, @values, %labels);
        my %roles = %{$ce-&gt;{userRoles}};
        <span class="keywordflow">foreach</span> my $role (sort {$roles{$a}&lt;=&gt;$roles{$b}} keys(%roles) ) {
            my $val = $roles{$role};

            push(@values, $val);
            $labels{$val} = $role;
            $default = $val <span class="keywordflow">if</span> ( $value eq $role );
        }
        <span class="keywordflow">return</span> CGI::popup_menu({
            -name =&gt; $fieldName,
            -values =&gt; \@values,
             -<span class="keywordflow">default</span> =&gt; [$default], # force <span class="keywordflow">default</span> of 0 to be a selector value (instead of 
                                    # being considered as a null -- now works with CGI 3.42
            #-<span class="keywordflow">default</span> =&gt; $default,   # works with CGI 3.49 (but the above does not, <a class="code" href="classWeBWorK_1_1ContentGenerator.html#a1fc5c34b5b217b62c505317d7573adb8">go</a> figure
            -labels =&gt; \%labels,
            -<span class="keyword">override</span> =&gt; 1,    # force <span class="keywordflow">default</span> value to be selected. (corrects bug on newer CGI
        });
    }
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a59e93bcd65989ef606b5b4fb558086f0"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::filter_form" ref="a59e93bcd65989ef606b5b4fb558086f0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::filter_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-filter_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-filter_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-filter_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-filter_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in filter_form: 61</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a59e93bcd65989ef606b5b4fb558086f0">filter_form</a> {
    my ($self, $onChange, %actionParams) = @_;
<span class="preprocessor">    #return CGI::table({}, CGI::Tr({-valign=&gt;&quot;top&quot;},</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::td({}, </span>
<span class="preprocessor"></span>    
    my %prettyFieldNames = %{ $self-&gt;{prettyFieldNames} };
    
    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>, 
            <span class="stringliteral">&quot;Show &quot;</span>,
            CGI::popup_menu(
                -name =&gt; <span class="stringliteral">&quot;action.filter.scope&quot;</span>,
                -values =&gt; [qw(all none selected match_regex)],
                -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.filter.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;match_regex&quot;</span>,
                -labels =&gt; {
                    all =&gt; <span class="stringliteral">&quot;all users&quot;</span>,
                    none =&gt; <span class="stringliteral">&quot;no users&quot;</span>,
                    selected =&gt; <span class="stringliteral">&quot;selected users&quot;</span>,
<span class="preprocessor">#                   match_ids =&gt; &quot;users with matching user IDs:&quot;,</span>
<span class="preprocessor"></span>                    match_regex =&gt; <span class="stringliteral">&quot;users who match:&quot;</span>, 
<span class="preprocessor">#                   match_section =&gt; &quot;users in selected section&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   match_recitation =&gt; &quot;users in selected recitation&quot;,</span>
<span class="preprocessor"></span>                },
                -onchange =&gt; $onChange,
            ),
            <span class="stringliteral">&quot; &quot;</span>,
            CGI::textfield(
                -name =&gt; <span class="stringliteral">&quot;action.filter.user_ids&quot;</span>,
                -value =&gt; $actionParams{<span class="stringliteral">&quot;action.filter.user_ids&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,,
                -width =&gt; <span class="stringliteral">&quot;50&quot;</span>,
                -onchange =&gt; $onChange,
            ),
#           <span class="stringliteral">&quot; (separate multiple IDs with commas)&quot;</span>,
#           CGI::br(),
#           <span class="stringliteral">&quot;sections: &quot;</span>,
#           CGI::popup_menu(
#               -name =&gt; <span class="stringliteral">&quot;action.filter.section&quot;</span>,
#               -values =&gt; [ keys %{ $self-&gt;{sections} } ],
<span class="preprocessor">#               -default =&gt; $actionParams{&quot;action.filter.section&quot;}-&gt;[0] || &quot;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -labels =&gt; { $self-&gt;menuLabels($self-&gt;{sections}) },</span>
<span class="preprocessor"></span><span class="preprocessor">#               -onchange =&gt; $onChange,</span>
<span class="preprocessor"></span><span class="preprocessor">#           ),</span>
<span class="preprocessor"></span><span class="preprocessor">#           &quot; recitations: &quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#           CGI::popup_menu(</span>
<span class="preprocessor"></span><span class="preprocessor">#               -name =&gt; &quot;action.filter.recitation&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -values =&gt; [ keys %{ $self-&gt;{recitations} } ],</span>
<span class="preprocessor"></span><span class="preprocessor">#               -default =&gt; $actionParams{&quot;action.filter.recitation&quot;}-&gt;[0] || &quot;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -labels =&gt; { $self-&gt;menuLabels($self-&gt;{recitations}) },</span>
<span class="preprocessor"></span><span class="preprocessor">#               -onchange =&gt; $onChange,</span>
<span class="preprocessor"></span><span class="preprocessor">#           ),</span>
<span class="preprocessor"></span>            <span class="stringliteral">&quot; in their &quot;</span>,
            CGI::popup_menu(
                -name =&gt; <span class="stringliteral">&quot;action.filter.field&quot;</span>,
                -value =&gt; [ keys %{ FIELD_PROPERTIES() } ],
                -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.filter.field&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;user_id&quot;</span>,
                -labels =&gt; \%prettyFieldNames,
                -onchange =&gt; $onChange,
            ),
    );
<span class="preprocessor">    #   ),</span>
<span class="preprocessor"></span><span class="preprocessor">    #));</span>
<span class="preprocessor">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a19a8406fc05a59e064ae80b79eddc8fd"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::filter_handler" ref="a19a8406fc05a59e064ae80b79eddc8fd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::filter_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-filter_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-filter_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-filter_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-filter_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in filter_handler: 48</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a19a8406fc05a59e064ae80b79eddc8fd">filter_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $r = $self-&gt;r;
    my $db = $r-&gt;db;
    
    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing all users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $self-&gt;{allUserIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;none&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing no users&quot;</span>;
        $self-&gt;{visibleUserIDs} = [];
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing selected users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $genericParams-&gt;{selected_users}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;match_regex&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing matching users&quot;</span>;
        my $regex = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.user_ids&quot;</span>}-&gt;[0];
        my $field = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.field&quot;</span>}-&gt;[0];
        my @userRecords = $db-&gt;getUsers(@{$self-&gt;{allUserIDs}});
        my @userIDs;
        <span class="keywordflow">foreach</span> my $record (@userRecords) {
            next unless $record;

<span class="preprocessor">            # add permission level to user record hash so we can match it if necessary</span>
<span class="preprocessor"></span>            <span class="keywordflow">if</span> ($field eq <span class="stringliteral">&quot;permission&quot;</span>) {
                my $permissionLevel = $db-&gt;getPermissionLevel($record-&gt;user_id);
                            $record-&gt;{permission} = $permissionLevel-&gt;permission;
            }
            push @userIDs, $record-&gt;user_id <span class="keywordflow">if</span> $record-&gt;{$field} =~ /^$regex/i;
        }
        $self-&gt;{visibleUserIDs} = \@userIDs;
    } elsif ($scope eq <span class="stringliteral">&quot;match_ids&quot;</span>) {
        my @userIDs = split /\s*,\s*/, $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.user_ids&quot;</span>}-&gt;[0];
        $self-&gt;{visibleUserIDs} = \@userIDs;
    } elsif ($scope eq <span class="stringliteral">&quot;match_section&quot;</span>) {
        my $section = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.section&quot;</span>}-&gt;[0];
        $self-&gt;{visibleUserIDs} = $self-&gt;{sections}-&gt;{$section}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;match_recitation&quot;</span>) {
        my $recitation = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.recitation&quot;</span>}-&gt;[0];
        $self-&gt;{visibleUserIDs} = $self-&gt;{recitations}-&gt;{$recitation}; # an arrayref
    }
    
    <span class="keywordflow">return</span> $result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="abbe8b2a8690e9ce60467949aef469e82"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::getActionParams" ref="abbe8b2a8690e9ce60467949aef469e82" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::getActionParams </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-getActionParams' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-getActionParams-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-getActionParams-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-getActionParams-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in getActionParams: 11</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#abbe8b2a8690e9ce60467949aef469e82">getActionParams</a> {
    my ($self, $actionID) = @_;
    my $r = $self-&gt;{<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a>};
    
    my %actionParams;
    <span class="keywordflow">foreach</span> my $param ($r-&gt;param) {
        next unless $param =~ m/^action\.$actionID\./;
        $actionParams{$param} = [ $r-&gt;param($param) ];
    }
    <span class="keywordflow">return</span> %actionParams;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aa31b0960cc8dcf8c14cd96cf085205c6"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::getTableParams" ref="aa31b0960cc8dcf8c14cd96cf085205c6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::getTableParams </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-getTableParams' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-getTableParams-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-getTableParams-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-getTableParams-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in getTableParams: 11</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#aa31b0960cc8dcf8c14cd96cf085205c6">getTableParams</a> {
    my ($self) = @_;
    my $r = $self-&gt;{<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a>};
    
    my %tableParams;
    <span class="keywordflow">foreach</span> my $param ($r-&gt;param) {
        next unless $param =~ m/^(?:user|permission)\./;
        $tableParams{$param} = [ $r-&gt;param($param) ];
    }
    <span class="keywordflow">return</span> %tableParams;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a8deed1b7764b27799f62cc83debeac65"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::import_form" ref="a8deed1b7764b27799f62cc83debeac65" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::import_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-import_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in import_form: 37</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8deed1b7764b27799f62cc83debeac65">import_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot; &quot;</span>,
        <span class="stringliteral">&quot;Import users from file&quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.import.source&quot;</span>,
            -values =&gt; [ $self-&gt;getCSVList() ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.import.source&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;replacing&quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.import.replace&quot;</span>,
            -values =&gt; [qw(any visible selected none)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.import.replace&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;none&quot;</span>,
            -labels =&gt; {
                any =&gt; <span class="stringliteral">&quot;any&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected&quot;</span>,
                none =&gt; <span class="stringliteral">&quot;no&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;existing users and adding&quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.import.add&quot;</span>,
            -values =&gt; [qw(any none)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.import.add&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;any&quot;</span>,
            -labels =&gt; {
                any =&gt; <span class="stringliteral">&quot;any&quot;</span>,
                none =&gt; <span class="stringliteral">&quot;no&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;new users&quot;</span>,
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3012034a77fe6b5f1fb34580c8a33c8b"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::import_handler" ref="a3012034a77fe6b5f1fb34580c8a33c8b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::import_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-import_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in import_handler: 38</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3012034a77fe6b5f1fb34580c8a33c8b">import_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $source = $actionParams-&gt;{<span class="stringliteral">&quot;action.import.source&quot;</span>}-&gt;[0];
    my $add = $actionParams-&gt;{<span class="stringliteral">&quot;action.import.add&quot;</span>}-&gt;[0];
    my $replace = $actionParams-&gt;{<span class="stringliteral">&quot;action.import.replace&quot;</span>}-&gt;[0];
    
    my $fileName = $source;
    my $createNew = $add eq <span class="stringliteral">&quot;any&quot;</span>;
    my $replaceExisting;
    my @replaceList;
    <span class="keywordflow">if</span> ($replace eq <span class="stringliteral">&quot;any&quot;</span>) {
        $replaceExisting = <span class="stringliteral">&quot;any&quot;</span>;
    } elsif ($replace eq <span class="stringliteral">&quot;none&quot;</span>) {
        $replaceExisting = <span class="stringliteral">&quot;none&quot;</span>;
    } elsif ($replace eq <span class="stringliteral">&quot;visible&quot;</span>) {
        $replaceExisting = <span class="stringliteral">&quot;listed&quot;</span>;
        @replaceList = @{ $self-&gt;{visibleUserIDs} };
    } elsif ($replace eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $replaceExisting = <span class="stringliteral">&quot;listed&quot;</span>;
        @replaceList = @{ $self-&gt;{selectedUserIDs} };
    }
    
    my ($replaced, $added, $skipped)
        = $self-&gt;importUsersFromCSV($fileName, $createNew, $replaceExisting, @replaceList);
    
<span class="preprocessor">    # make new users visible... do we really want to do this? probably.</span>
<span class="preprocessor"></span>    push @{ $self-&gt;{visibleUserIDs} }, @$added;
    
    my $numReplaced = @$replaced;
    my $numAdded = @$added;
    my $numSkipped = @$skipped;
    
    <span class="keywordflow">return</span> $numReplaced . <span class="stringliteral">&quot; user&quot;</span> . ($numReplaced == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; replaced, &quot;</span>
        . $numAdded . <span class="stringliteral">&quot; user&quot;</span> . ($numAdded == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; added, &quot;</span>
        . $numSkipped . <span class="stringliteral">&quot; user&quot;</span> . ($numSkipped == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; skipped&quot;</span>
        . <span class="stringliteral">&quot; (&quot;</span> . join (<span class="stringliteral">&quot;, &quot;</span>, @$skipped) . <span class="stringliteral">&quot;) &quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a2163f9025eeacd96615fe149f9ea587d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::importUsersFromCSV" ref="a2163f9025eeacd96615fe149f9ea587d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::importUsersFromCSV </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-importUsersFromCSV' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-importUsersFromCSV-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-importUsersFromCSV-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-importUsersFromCSV-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in importUsersFromCSV: 94</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2163f9025eeacd96615fe149f9ea587d">importUsersFromCSV</a> {
    my ($self, $fileName, $createNew, $replaceExisting, @replaceList) = @_;
    my $r     = $self-&gt;r;
    my $ce    = $r-&gt;ce;
    my $db    = $r-&gt;db;
    my $dir   = $ce-&gt;{courseDirs}-&gt;{templates};
    my $user  = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    
    die <span class="stringliteral">&quot;illegal character in input: &#39;/&#39;&quot;</span> <span class="keywordflow">if</span> $fileName =~ m|/|;
    die <span class="stringliteral">&quot;won&#39;t be able to read from file $dir/$fileName: does it exist? is it readable?&quot;</span>
        unless -<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a> <span class="stringliteral">&quot;$dir/$fileName&quot;</span>;
    
    my %allUserIDs = map { $_ =&gt; 1 } @{ $self-&gt;{allUserIDs} };
    my %replaceOK;
    <span class="keywordflow">if</span> ($replaceExisting eq <span class="stringliteral">&quot;none&quot;</span>) {
        %replaceOK = ();
    } elsif ($replaceExisting eq <span class="stringliteral">&quot;listed&quot;</span>) {
        %replaceOK = map { $_ =&gt; 1 } @replaceList;
    } elsif ($replaceExisting eq <span class="stringliteral">&quot;any&quot;</span>) {
        %replaceOK = %allUserIDs;
    }
    
    my $default_permission_level = $ce-&gt;{default_permission_level};
    
    my (@replaced, @added, @skipped);
    
<span class="preprocessor">    # get list of hashrefs representing lines in classlist file</span>
<span class="preprocessor"></span>    my <span class="keyword">@class</span>list = parse_classlist(<span class="stringliteral">&quot;$dir/$fileName&quot;</span>);
    
<span class="preprocessor">    # Default status is enrolled -- fetch abbreviation for enrolled</span>
<span class="preprocessor"></span>    my $default_status_abbrev = $ce-&gt;{statuses}-&gt;{Enrolled}-&gt;{abbrevs}-&gt;[0];
    
    <span class="keywordflow">foreach</span> my $record (@classlist) {
        my %record = %$record;
        my $user_id = $record{user_id};
        
        unless (<a class="code" href="classWeBWorK_1_1DB.html#a5f14c32aa8ecb86b3ca858cd8688d818">WeBWorK::DB::check_user_id</a>($user_id) ) {  # <span class="keywordflow">try</span> to <span class="keywordflow">catch</span> lines with bad characters
            push @skipped, $user_id;
            next;
        }
        <span class="keywordflow">if</span> ($user_id eq $user) { # don<span class="stringliteral">&#39;t replace yourself!!</span>
<span class="stringliteral">            push @skipped, $user_id;</span>
<span class="stringliteral">            next;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        if (exists $allUserIDs{$user_id} and not exists $replaceOK{$user_id}) {</span>
<span class="stringliteral">            push @skipped, $user_id;</span>
<span class="stringliteral">            next;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        if (not exists $allUserIDs{$user_id} and not $createNew) {</span>
<span class="stringliteral">            push @skipped, $user_id;</span>
<span class="stringliteral">            next;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        # set default status is status field is &quot;empty&quot;</span>
<span class="stringliteral">        $record{status} = $default_status_abbrev</span>
<span class="stringliteral">            unless defined $record{status} and $record{status} ne &quot;&quot;;</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        # set password from student ID if password field is &quot;empty&quot;</span>
<span class="stringliteral">        if (not defined $record{password} or $record{password} eq &quot;&quot;) {</span>
<span class="stringliteral">            if (defined $record{student_id} and $record{student_id} ne &quot;&quot;) {</span>
<span class="stringliteral">                # crypt the student ID and use that</span>
<span class="stringliteral">                $record{password} = cryptPassword($record{student_id});</span>
<span class="stringliteral">            } else {</span>
<span class="stringliteral">                # an empty password field in the database disables password login</span>
<span class="stringliteral">                $record{password} = &quot;&quot;;</span>
<span class="stringliteral">            }</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        # set default permission level if permission level is &quot;empty&quot;</span>
<span class="stringliteral">        $record{permission} = $default_permission_level</span>
<span class="stringliteral">            unless defined $record{permission} and $record{permission} ne &quot;&quot;;</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        my $User = $db-&gt;newUser(%record);</span>
<span class="stringliteral">        my $PermissionLevel = $db-&gt;newPermissionLevel(user_id =&gt; $user_id, permission =&gt; $record{permission});</span>
<span class="stringliteral">        my $Password = $db-&gt;newPassword(user_id =&gt; $user_id, password =&gt; $record{password});</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        # DBFIXME use REPLACE</span>
<span class="stringliteral">        if (exists $allUserIDs{$user_id}) {</span>
<span class="stringliteral">            $db-&gt;putUser($User);</span>
<span class="stringliteral">            $db-&gt;putPermissionLevel($PermissionLevel);</span>
<span class="stringliteral">            $db-&gt;putPassword($Password);</span>
<span class="stringliteral">            push @replaced, $user_id;</span>
<span class="stringliteral">        } else {</span>
<span class="stringliteral">            $db-&gt;addUser($User);</span>
<span class="stringliteral">            $db-&gt;addPermissionLevel($PermissionLevel);</span>
<span class="stringliteral">            $db-&gt;addPassword($Password);</span>
<span class="stringliteral">            push @added, $user_id;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return \@replaced, \@added, \@skipped;</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a9828fbe24b12ffcbac972f4d5e85331b"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::initialize" ref="a9828fbe24b12ffcbac972f4d5e85331b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in initialize: 25</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9828fbe24b12ffcbac972f4d5e85331b">initialize</a> {
    my ($self) = @_;
    my $r      = $self-&gt;r;
    my $db     = $r-&gt;db;
    my $ce     = $r-&gt;ce;
    my $authz  = $r-&gt;authz;
    my $user   = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);

<span class="preprocessor">    # Check permissions</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> unless $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;access_instructor_tools&quot;</span>);
    
<span class="preprocessor">    #if (defined($r-&gt;param(&#39;addStudent&#39;))) {</span>
<span class="preprocessor"></span><span class="preprocessor">    #   my $newUser = $db-&gt;newUser;</span>
<span class="preprocessor"></span><span class="preprocessor">    #   my $newPermissionLevel = $db-&gt;newPermissionLevel;</span>
<span class="preprocessor"></span><span class="preprocessor">    #   my $newPassword = $db-&gt;newPassword;</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $newUser-&gt;user_id($r-&gt;param(&#39;newUserID&#39;));</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $newPermissionLevel-&gt;user_id($r-&gt;param(&#39;newUserID&#39;));</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $newPassword-&gt;user_id($r-&gt;param(&#39;newUserID&#39;));</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $newUser-&gt;status(&#39;C&#39;);</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $newPermissionLevel-&gt;permission(0);</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $db-&gt;addUser($newUser);</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $db-&gt;addPermissionLevel($newPermissionLevel);</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $db-&gt;addPassword($newPassword);</span>
<span class="preprocessor"></span><span class="preprocessor">    #}</span>
<span class="preprocessor">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ac10194bad0086538ac682b7188b52355"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::menuLabels" ref="ac10194bad0086538ac682b7188b52355" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::menuLabels </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-menuLabels' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-menuLabels-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-menuLabels-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-menuLabels-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in menuLabels: 12</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#ac10194bad0086538ac682b7188b52355">menuLabels</a> {
    my ($self, $hashRef) = @_;
    my %hash = %$hashRef;
    
    my %result;
    <span class="keywordflow">foreach</span> my $key (keys %hash) {
        my $count = @{ $hash{$key} };
        my $displayKey = $key || <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>;
        $result{$key} = <span class="stringliteral">&quot;$displayKey ($count users)&quot;</span>;
    }
    <span class="keywordflow">return</span> %result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a4178dd49c9c5b919d8b46c7bfbaca14c"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::password_form" ref="a4178dd49c9c5b919d8b46c7bfbaca14c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::password_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-password_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-password_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-password_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-password_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in password_form: 18</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a4178dd49c9c5b919d8b46c7bfbaca14c">password_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Give new password to &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.password.scope&quot;</span>,
            -values =&gt; [qw(all visible selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.password.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;selected&quot;</span>,
            -labels =&gt; {
                all =&gt; <span class="stringliteral">&quot;all users&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible users&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected users&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a564175bbda42b1549c82ea771fbcde68"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::password_handler" ref="a564175bbda42b1549c82ea771fbcde68" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::password_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-password_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-password_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-password_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-password_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in password_handler: 20</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a564175bbda42b1549c82ea771fbcde68">password_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.password.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;giving new passwords to all users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $self-&gt;{allUserIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        $result = <span class="stringliteral">&quot;giving new passwords to visible users&quot;</span>;
<span class="preprocessor">        # leave visibleUserIDs alone</span>
<span class="preprocessor"></span>    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;giving new passwords to selected users&quot;</span>;
        $self-&gt;{visibleUserIDs} = $genericParams-&gt;{selected_users}; # an arrayref
    }
    $self-&gt;{passwordMode} = 1;
    
    <span class="keywordflow">return</span> $result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a659da84268e933f8d41856060679d77e"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::pre_header_initialize" ref="a659da84268e933f8d41856060679d77e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::pre_header_initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-pre_header_initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-pre_header_initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-pre_header_initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-pre_header_initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in pre_header_initialize: 35</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a659da84268e933f8d41856060679d77e">pre_header_initialize</a> {
    my $self          = shift;
    my $r             = $self-&gt;r;
    my $urlpath       = $r-&gt;urlpath;
    my $authz         = $r-&gt;authz;
    my $ce            = $r-&gt;ce;
    my $courseName    = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $user          = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
<span class="preprocessor">    # Handle redirects, if any.</span>
<span class="preprocessor"></span><span class="preprocessor">    ##############################</span>
<span class="preprocessor"></span><span class="preprocessor">    # Redirect to the addUser page</span>
<span class="preprocessor"></span><span class="preprocessor">    ##################################</span>
<span class="preprocessor"></span>
<span class="preprocessor">    # Check permissions</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> unless $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;access_instructor_tools&quot;</span>);
    
    defined($r-&gt;param(<span class="stringliteral">&#39;action&#39;</span>)) &amp;&amp; $r-&gt;param(<span class="stringliteral">&#39;action&#39;</span>) eq <span class="stringliteral">&#39;add&#39;</span> &amp;&amp; <span class="keywordflow">do</span> {
<span class="preprocessor">        # fix url and redirect</span>
<span class="preprocessor"></span>        my $root              = $ce-&gt;{webworkURLs}-&gt;{root};
        
        my $numberOfStudents  = $r-&gt;param(<span class="stringliteral">&#39;number_of_students&#39;</span>);
        warn <span class="stringliteral">&quot;number of students not defined &quot;</span> unless defined $numberOfStudents;

        my $uri=$self-&gt;systemLink( $urlpath-&gt;newFromModule(<span class="stringliteral">&#39;WeBWorK::ContentGenerator::Instructor::AddUsers&#39;</span>, $r, courseID=&gt;$courseName),
                                   params=&gt;{
                                            number_of_students=&gt;$numberOfStudents,
                                           }
        );
<span class="preprocessor">        #FIXME  does the display mode need to be defined?</span>
<span class="preprocessor"></span><span class="preprocessor">        #FIXME  url_authen_args also includes an effective user, so the new one must come first.</span>
<span class="preprocessor"></span><span class="preprocessor">        # even that might not work with every browser since there are two effective User assignments.</span>
<span class="preprocessor"></span>        $self-&gt;reply_with_redirect($uri);
        <span class="keywordflow">return</span>;
    };
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="acddcbb733f3c62c352edf2a75358d317"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::printTableHTML" ref="acddcbb733f3c62c352edf2a75358d317" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::printTableHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-printTableHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-printTableHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-printTableHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-printTableHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in printTableHTML: 119</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#acddcbb733f3c62c352edf2a75358d317">printTableHTML</a> {
    my ($self, $UsersRef, $PermissionLevelsRef, $fieldNamesRef, %options) = @_;
    my $r                       = $self-&gt;r;
    my $urlpath     = $r-&gt;urlpath;
    my $courseName  = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $userTemplate            = $self-&gt;{userTemplate};
    my $permissionLevelTemplate = $self-&gt;{permissionLevelTemplate};
    my @Users                   = @$UsersRef;
    my @PermissionLevels        = @$PermissionLevelsRef;
    my %fieldNames              = %$fieldNamesRef;
    
    my $editMode                = $options{editMode};
    my $passwordMode            = $options{passwordMode};
    my %selectedUserIDs         = map { $_ =&gt; 1 } @{ $options{selectedUserIDs} };
<span class="preprocessor">#   my $currentSort             = $options{currentSort};</span>
<span class="preprocessor"></span>    my $primarySortField        = $options{primarySortField};
    my $secondarySortField      = $options{secondarySortField}; 
    my @visableUserIDs          = @{ $options{visableUserIDs} };    
        
<span class="preprocessor">    # names of headings:</span>
<span class="preprocessor"></span>    my @realFieldNames = (
            $userTemplate-&gt;KEYFIELDS,
            $userTemplate-&gt;NONKEYFIELDS,
            $permissionLevelTemplate-&gt;NONKEYFIELDS,
    );
    
<span class="preprocessor">#   my %sortSubs = %{ SORT_SUBS() };</span>
<span class="preprocessor"></span><span class="preprocessor">    #my @stateParams = @{ STATE_PARAMS() };</span>
<span class="preprocessor"></span><span class="preprocessor">    #my $hrefPrefix = $r-&gt;uri . &quot;?&quot; . $self-&gt;url_args(@stateParams); # $self-&gt;url_authen_args</span>
<span class="preprocessor"></span>    my @tableHeadings;
    <span class="keywordflow">foreach</span> my $field (@realFieldNames) {
        my $result = $fieldNames{$field};
        push @tableHeadings, $result;
    };
    
<span class="preprocessor">    # prepend selection checkbox? only if we&#39;re NOT editing!</span>
<span class="preprocessor"></span>    unless($editMode or $passwordMode) {

<span class="preprocessor">        #warn &quot;line 1582 visibleUserIDs=@visableUserIDs \n&quot;;</span>
<span class="preprocessor"></span>        my %current_state =();
        <span class="keywordflow">if</span> (@visableUserIDs) {
<span class="preprocessor">            # This is a hack to get around: Maximum URL Length Is 2,083 Characters in Internet Explorer.</span>
<span class="preprocessor"></span><span class="preprocessor">            # Without passing visable users the URL is about 250 characters. If the total URL is under the limit</span>
<span class="preprocessor"></span><span class="preprocessor">            # we will pass visable users. If it is over, we will not pass any and all users will be displayed.</span>
<span class="preprocessor"></span><span class="preprocessor">            # Maybe we should replace the GET method by POST (but this doesn&#39;t look good) --- AKP</span>
<span class="preprocessor"></span>
            my $visableUserIDsString = join <span class="charliteral">&#39;:&#39;</span>, @visableUserIDs;
            <span class="keywordflow">if</span> (length($visableUserIDsString) &lt; 1830) {
                %current_state = (
                    primarySortField =&gt; <span class="stringliteral">&quot;$primarySortField&quot;</span>, 
                    secondarySortField =&gt; <span class="stringliteral">&quot;$secondarySortField&quot;</span>,
                    visable_user_string =&gt; <span class="stringliteral">&quot;$visableUserIDsString&quot;</span>
                );
            } <span class="keywordflow">else</span> {
                %current_state = (
                primarySortField =&gt; <span class="stringliteral">&quot;$primarySortField&quot;</span>, 
                secondarySortField =&gt; <span class="stringliteral">&quot;$secondarySortField&quot;</span>,
                show_all_users =&gt; <span class="stringliteral">&quot;1&quot;</span>
                );
            }   
        } <span class="keywordflow">else</span> {
            %current_state = (
            primarySortField =&gt; <span class="stringliteral">&quot;$primarySortField&quot;</span>, 
            secondarySortField =&gt; <span class="stringliteral">&quot;$secondarySortField&quot;</span>,
            no_visible_users =&gt; <span class="stringliteral">&quot;1&quot;</span>
            );
        }   
        @tableHeadings = (
            <span class="stringliteral">&quot;Select&quot;</span>,
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;user_id&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Login Name&#39;</span>),
            <span class="stringliteral">&quot;Login Status&quot;</span>, 
            <span class="stringliteral">&quot;Assigned Sets&quot;</span>,
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;first_name&#39;</span>, %current_state})}, <span class="stringliteral">&#39;First Name&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;last_name&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Last Name&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;email_address&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Email Address&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;student_id&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Student ID&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;status&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Status&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;section&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Section&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;recitation&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Recitation&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;comment&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Comment&#39;</span>),
            CGI::a({href =&gt; $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName,} ), params=&gt;{labelSortMethod=&gt;<span class="stringliteral">&#39;permission&#39;</span>, %current_state})}, <span class="stringliteral">&#39;Permission Level&#39;</span>),
        )   
    }
    <span class="keywordflow">if</span>($passwordMode) { 
        unshift @tableHeadings, <span class="stringliteral">&quot;New Password&quot;</span>;
        }       
        
<span class="preprocessor">    # print the table</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode or $passwordMode) {
        print CGI::start_table({});
    } <span class="keywordflow">else</span> {
        print CGI::start_table({-border=&gt;1, -nowrap=&gt;1});
    }
    
    print CGI::Tr({}, CGI::th({}, \@tableHeadings));
    

    <span class="keywordflow">for</span> (my $i = 0; $i &lt; @Users; $i++) {
        my $User = $Users[$i];
        my $PermissionLevel = $PermissionLevels[$i];
        
        print $self-&gt;recordEditHTML($User, $PermissionLevel,
            editMode =&gt; $editMode,
            passwordMode =&gt; $passwordMode,
            userSelected =&gt; exists $selectedUserIDs{$User-&gt;user_id}
        );
    }
    
    print CGI::end_table();
<span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # if there are no users shown print message</span>
<span class="preprocessor"></span><span class="preprocessor">    # </span>
<span class="preprocessor"></span><span class="preprocessor">    ##########################################</span>
<span class="preprocessor"></span>    
    print CGI::p(
                  CGI::i(<span class="stringliteral">&quot;No students shown.  Choose one of the options above to </span>
<span class="stringliteral">                  list the students in the course.&quot;</span>)
    ) unless @Users;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3160f367879c3d0c4cced3441de29597"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::recordEditHTML" ref="a3160f367879c3d0c4cced3441de29597" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::recordEditHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-recordEditHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-recordEditHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-recordEditHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-recordEditHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in recordEditHTML: 136</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a3160f367879c3d0c4cced3441de29597">recordEditHTML</a> {
    my ($self, $User, $PermissionLevel, %options) = @_;
    my $r           = $self-&gt;r;
    my $urlpath     = $r-&gt;urlpath;
    my $db          = $r-&gt;db;
    my $ce          = $r-&gt;ce;
    my $authz   = $r-&gt;authz;
    my $user    = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $root        = $ce-&gt;{webworkURLs}-&gt;{root};
    my $courseName  = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    
    my $editMode = $options{editMode};
    my $passwordMode = $options{passwordMode};
    my $userSelected = $options{userSelected};

    my $statusClass = $ce-&gt;status_abbrev_to_name($User-&gt;status);

    my $sets = $db-&gt;countUserSets($User-&gt;user_id);
    my $totalSets = $self-&gt;{totalSets};
    
    my $changeEUserURL = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;set_list&#39;</span>,args=&gt;{courseID=&gt;$courseName}),
                                           params =&gt; {effectiveUser =&gt; $User-&gt;user_id}
    );
    
    my $setsAssignedToUserURL = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_detail&#39;</span>,
                                                                args=&gt;{courseID =&gt; $courseName, 
                                                                       userID   =&gt; $User-&gt;user_id
                                                                       }),
                                           params =&gt; {effectiveUser =&gt; $User-&gt;user_id}
    );

    my $userListURL = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_user_list&#39;</span>, args=&gt;{courseID =&gt; $courseName} )) . <span class="stringliteral">&quot;&amp;editMode=1&amp;visible_users=&quot;</span> . $User-&gt;user_id;

    my $imageURL = $ce-&gt;{webworkURLs}-&gt;{htdocs}.<span class="stringliteral">&quot;/images/edit.gif&quot;</span>;
        my $imageLink = CGI::a({href =&gt; $userListURL}, CGI::img({src=&gt;$imageURL, border=&gt;0}));
    
    my @tableCells;
    
<span class="preprocessor">    # Select</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode or $passwordMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # selection checkbox</span>
<span class="preprocessor"></span>        push @tableCells, CGI::checkbox(
            -name =&gt; <span class="stringliteral">&quot;selected_users&quot;</span>,
            -value =&gt; $User-&gt;user_id,
            -checked =&gt; $userSelected,
            -label =&gt; <span class="stringliteral">&quot;&quot;</span>,
        );
    }
    
<span class="preprocessor">    # Act As</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode or $passwordMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # selection checkbox</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( FIELD_PERMS()-&gt;{act_as} and not $authz-&gt;hasPermissions($user, FIELD_PERMS()-&gt;{act_as}) ){
            push @tableCells, $User-&gt;user_id . $imageLink;
        } <span class="keywordflow">else</span> {
            push @tableCells, CGI::a({href=&gt;$changeEUserURL}, $User-&gt;user_id) . $imageLink;
        }
    }
    
<span class="preprocessor">    # Login Status</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode or $passwordMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # check to see if a user is currently logged in</span>
<span class="preprocessor"></span><span class="preprocessor">        # DBFIXME use a WHERE clause</span>
<span class="preprocessor"></span>        my $Key = $db-&gt;getKey($User-&gt;user_id);
        my $is_active = ($Key and time &lt;= $Key-&gt;timestamp()+$ce-&gt;{sessionKeyTimeout}); # cribbed from check_session
        push @tableCells, $is_active ? CGI::b(<span class="stringliteral">&quot;active&quot;</span>) : CGI::em(<span class="stringliteral">&quot;inactive&quot;</span>);
    }
    
<span class="preprocessor">    # change password (only in password mode)</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($passwordMode) {
        <span class="keywordflow">if</span> ($User-&gt;user_id eq $user) {
            push @tableCells, <span class="stringliteral">&#39;&#39;</span>   # don<span class="stringliteral">&#39;t allow a professor to change their own password from this form</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        else {</span>
<span class="stringliteral">            my $fieldName = &#39;</span>user.<span class="stringliteral">&#39; . $User-&gt;user_id . &#39;</span>.<span class="stringliteral">&#39; . &#39;</span>new_password<span class="stringliteral">&#39;;</span>
<span class="stringliteral">            push @tableCells, CGI::input({type=&gt;&quot;text&quot;, name=&gt;$fieldName, size=&gt;14});;</span>
<span class="stringliteral">        }   </span>
<span class="stringliteral">    }   </span>
<span class="stringliteral">    # User ID (edit mode) or Assigned Sets (otherwise)</span>
<span class="stringliteral">    if ( $passwordMode) {</span>
<span class="stringliteral">        # straight user ID</span>
<span class="stringliteral">        push @tableCells, CGI::div({class=&gt;$statusClass}, $User-&gt;user_id);</span>
<span class="stringliteral">    } elsif ($editMode) {</span>
<span class="stringliteral">        # straight user ID</span>
<span class="stringliteral">         my $userDetailPage = $urlpath-&gt;new(type =&gt;&#39;</span>instructor_user_detail<span class="stringliteral">&#39;,</span>
<span class="stringliteral">                                           args =&gt;{</span>
<span class="stringliteral">                                                     courseID =&gt; $courseName,</span>
<span class="stringliteral">                                                     userID   =&gt; $User-&gt;user_id, #FIXME eventually this should be a list??</span>
<span class="stringliteral">                    }</span>
<span class="stringliteral">        );</span>
<span class="stringliteral">        my $userDetailUrl = $self-&gt;systemLink($userDetailPage,params =&gt;{});</span>
<span class="stringliteral">        push @tableCells, CGI::a({href=&gt;$userDetailUrl}, $User-&gt;user_id);</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    } else {</span>
<span class="stringliteral">        # &quot;edit sets assigned to user&quot; link</span>
<span class="stringliteral">        #push @tableCells, CGI::a({href=&gt;$setsAssignedToUserURL}, &quot;Edit sets&quot;);</span>
<span class="stringliteral">        if ( FIELD_PERMS()-&gt;{sets} and not $authz-&gt;hasPermissions($user, FIELD_PERMS()-&gt;{sets}) ) {</span>
<span class="stringliteral">            push @tableCells, &quot;$sets/$totalSets&quot;;</span>
<span class="stringliteral">        } else {</span>
<span class="stringliteral">            push @tableCells, CGI::a({href=&gt;$setsAssignedToUserURL}, &quot;$sets/$totalSets&quot;);</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">    }</span>
<span class="stringliteral"></span>
<span class="stringliteral">    # User Fields</span>
<span class="stringliteral">    foreach my $field ($User-&gt;NONKEYFIELDS) {</span>
<span class="stringliteral">        my $fieldName = &#39;</span>user.<span class="stringliteral">&#39; . $User-&gt;user_id . &#39;</span>.<span class="stringliteral">&#39; . $field,</span>
<span class="stringliteral">        my $fieldValue = $User-&gt;$field;</span>
<span class="stringliteral">        my %properties = %{ FIELD_PROPERTIES()-&gt;{$field} };</span>
<span class="stringliteral">        $properties{access} = &#39;</span>readonly<span class="stringliteral">&#39; unless $editMode;</span>
<span class="stringliteral">        $properties{type} = &#39;</span>email<span class="stringliteral">&#39; if ($field eq &#39;</span>email_address<span class="stringliteral">&#39; and !$editMode and !$passwordMode);</span>
<span class="stringliteral">        $fieldValue = $self-&gt;nbsp($fieldValue) unless $editMode;</span>
<span class="stringliteral">        push @tableCells, CGI::div({class=&gt;$statusClass}, $self-&gt;fieldEditHTML($fieldName, $fieldValue, \%properties));</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    # PermissionLevel Fields</span>
<span class="stringliteral">    foreach my $field ($PermissionLevel-&gt;NONKEYFIELDS) {</span>
<span class="stringliteral">        my $fieldName = &#39;</span>permission.<span class="stringliteral">&#39; . $PermissionLevel-&gt;user_id . &#39;</span>.<span class="stringliteral">&#39; . $field,</span>
<span class="stringliteral">        my $fieldValue = $PermissionLevel-&gt;$field;</span>
<span class="stringliteral">        # get name out of permission level </span>
<span class="stringliteral">        if ( $field eq &#39;</span>permission<span class="stringliteral">&#39; ) {</span>
<span class="stringliteral">            ($fieldValue) = grep { $ce-&gt;{userRoles}-&gt;{$_} eq $fieldValue } ( keys ( %{$ce-&gt;{userRoles}} ) );</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        my %properties = %{ FIELD_PROPERTIES()-&gt;{$field} };</span>
<span class="stringliteral">        $properties{access} = &#39;</span>readonly<span class="stringliteral">&#39; unless $editMode;</span>
<span class="stringliteral">        $fieldValue = $self-&gt;nbsp($fieldValue) unless $editMode;</span>
<span class="stringliteral">        push @tableCells, CGI::div({class=&gt;$statusClass}, $self-&gt;fieldEditHTML($fieldName, $fieldValue, \%properties));</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return CGI::Tr({}, CGI::td({nowrap=&gt;1}, \@tableCells));</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a2e4b796feeb6965523bee81683b1f95b"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::saveEdit_form" ref="a2e4b796feeb6965523bee81683b1f95b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::saveEdit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveEdit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveEdit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveEdit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveEdit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveEdit_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a2e4b796feeb6965523bee81683b1f95b">saveEdit_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a1c9f24e6ef92d7f80b8d7112c82981ea"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::saveEdit_handler" ref="a1c9f24e6ef92d7f80b8d7112c82981ea" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::saveEdit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveEdit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveEdit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveEdit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveEdit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveEdit_handler: 41</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a1c9f24e6ef92d7f80b8d7112c82981ea">saveEdit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r           = $self-&gt;r;
    my $db          = $r-&gt;db;
    
    my @visibleUserIDs = @{ $self-&gt;{visibleUserIDs} };
    <span class="keywordflow">foreach</span> my $userID (@visibleUserIDs) {
        my $User = $db-&gt;getUser($userID); # checked
        die <span class="stringliteral">&quot;record for visible user $userID not found&quot;</span> unless $User;
        my $PermissionLevel = $db-&gt;getPermissionLevel($userID); # checked
        die <span class="stringliteral">&quot;permissions for $userID not defined&quot;</span> unless defined $PermissionLevel;
        <span class="keywordflow">foreach</span> my $field ($User-&gt;NONKEYFIELDS()) {
            my $param = <span class="stringliteral">&quot;user.${userID}.${field}&quot;</span>;
            <span class="keywordflow">if</span> (defined $tableParams-&gt;{$param}-&gt;[0]) {
                $User-&gt;$field($tableParams-&gt;{$param}-&gt;[0]);
            }
        }
        
        <span class="keywordflow">foreach</span> my $field ($PermissionLevel-&gt;NONKEYFIELDS()) {
            my $param = <span class="stringliteral">&quot;permission.${userID}.${field}&quot;</span>;
            <span class="keywordflow">if</span> (defined $tableParams-&gt;{$param}-&gt;[0]) {
                $PermissionLevel-&gt;$field($tableParams-&gt;{$param}-&gt;[0]);
            }
        }
        
        $db-&gt;putUser($User);
        $db-&gt;putPermissionLevel($PermissionLevel);
    }
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    
    $self-&gt;{editMode} = 0;
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;changes saved&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a5ea0ebdc5e1f2c2ad95e0e64c557bc85"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::savePassword_form" ref="a5ea0ebdc5e1f2c2ad95e0e64c557bc85" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::savePassword_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-savePassword_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-savePassword_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-savePassword_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-savePassword_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in savePassword_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a5ea0ebdc5e1f2c2ad95e0e64c557bc85">savePassword_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a52a8254a0a998cac40bfb8cb8a32c4ac"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::savePassword_handler" ref="a52a8254a0a998cac40bfb8cb8a32c4ac" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::savePassword_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-savePassword_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-savePassword_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-savePassword_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-savePassword_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in savePassword_handler: 31</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a52a8254a0a998cac40bfb8cb8a32c4ac">savePassword_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r           = $self-&gt;r;
    my $db          = $r-&gt;db;
    
    my @visibleUserIDs = @{ $self-&gt;{visibleUserIDs} };
    <span class="keywordflow">foreach</span> my $userID (@visibleUserIDs) {
        my $User = $db-&gt;getUser($userID); # checked
        die <span class="stringliteral">&quot;record for visible user $userID not found&quot;</span> unless $User;
        my $param = <span class="stringliteral">&quot;user.${userID}.new_password&quot;</span>;
            <span class="keywordflow">if</span> ((defined $tableParams-&gt;{$param}-&gt;[0]) and ($tableParams-&gt;{$param}-&gt;[0])) {
                my $newP = $tableParams-&gt;{$param}-&gt;[0];
                my $Password = eval {$db-&gt;getPassword($User-&gt;user_id)}; # checked       
                my  $cryptPassword = cryptPassword($newP);                                           
                $Password-&gt;password(cryptPassword($newP));
                eval { $db-&gt;putPassword($Password) };               
            }
    }
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_users&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_users&quot;</span>)) {
        $self-&gt;{visibleUserIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    
    $self-&gt;{passwordMode} = 0;
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;new passwords saved&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a9fedaced9ca6e907c78a8d8e0a68df27"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::sort_form" ref="a9fedaced9ca6e907c78a8d8e0a68df27" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::sort_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-sort_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-sort_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-sort_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-sort_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in sort_form: 64</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a9fedaced9ca6e907c78a8d8e0a68df27">sort_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Sort by &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.sort.primary&quot;</span>,
            -values =&gt; [qw(user_id first_name last_name email_address student_id status section recitation comment permission)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.sort.primary&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;last_name&quot;</span>,
            -labels =&gt; {
                user_id     =&gt; <span class="stringliteral">&quot;Login Name&quot;</span>,
                first_name  =&gt; <span class="stringliteral">&quot;First Name&quot;</span>,
                last_name   =&gt; <span class="stringliteral">&quot;Last Name&quot;</span>,
                email_address   =&gt; <span class="stringliteral">&quot;Email Address&quot;</span>,
                student_id  =&gt; <span class="stringliteral">&quot;Student ID&quot;</span>,
                status      =&gt; <span class="stringliteral">&quot;Enrollment Status&quot;</span>,
                section     =&gt; <span class="stringliteral">&quot;Section&quot;</span>,
                recitation  =&gt; <span class="stringliteral">&quot;Recitation&quot;</span>,
                comment     =&gt; <span class="stringliteral">&quot;Comment&quot;</span>,
                permission  =&gt; <span class="stringliteral">&quot;Permission Level&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;, then by &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.sort.secondary&quot;</span>,
            -values =&gt; [qw(user_id first_name last_name email_address student_id status section recitation comment permission)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.sort.secondary&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;first_name&quot;</span>,
            -labels =&gt; {
                user_id     =&gt; <span class="stringliteral">&quot;Login Name&quot;</span>,
                first_name  =&gt; <span class="stringliteral">&quot;First Name&quot;</span>,
                last_name   =&gt; <span class="stringliteral">&quot;Last Name&quot;</span>,
                email_address   =&gt; <span class="stringliteral">&quot;Email Address&quot;</span>,
                student_id  =&gt; <span class="stringliteral">&quot;Student ID&quot;</span>,
                status      =&gt; <span class="stringliteral">&quot;Enrollment Status&quot;</span>,
                section     =&gt; <span class="stringliteral">&quot;Section&quot;</span>,
                recitation  =&gt; <span class="stringliteral">&quot;Recitation&quot;</span>,
                comment     =&gt; <span class="stringliteral">&quot;Comment&quot;</span>,
                permission  =&gt; <span class="stringliteral">&quot;Permission Level&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;, then by &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.sort.ternary&quot;</span>,
            -values =&gt; [qw(user_id first_name last_name email_address student_id status section recitation comment permission)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.sort.ternary&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;user_id&quot;</span>,
            -labels =&gt; {
                user_id     =&gt; <span class="stringliteral">&quot;Login Name&quot;</span>,
                first_name  =&gt; <span class="stringliteral">&quot;First Name&quot;</span>,
                last_name   =&gt; <span class="stringliteral">&quot;Last Name&quot;</span>,
                email_address   =&gt; <span class="stringliteral">&quot;Email Address&quot;</span>,
                student_id  =&gt; <span class="stringliteral">&quot;Student ID&quot;</span>,
                status      =&gt; <span class="stringliteral">&quot;Enrollment Status&quot;</span>,
                section     =&gt; <span class="stringliteral">&quot;Section&quot;</span>,
                recitation  =&gt; <span class="stringliteral">&quot;Recitation&quot;</span>,
                comment     =&gt; <span class="stringliteral">&quot;Comment&quot;</span>,
                permission  =&gt; <span class="stringliteral">&quot;Permission Level&quot;</span>
            },
            -onchange =&gt; $onChange,
        ),

        <span class="stringliteral">&quot;.&quot;</span>,
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a8571c130f4e668504dc10787b279e8d7"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::UserList::sort_handler" ref="a8571c130f4e668504dc10787b279e8d7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::UserList::sort_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-sort_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-sort_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-sort_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-sort_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in sort_handler: 26</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1UserList.html#a8571c130f4e668504dc10787b279e8d7">sort_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $primary = $actionParams-&gt;{<span class="stringliteral">&quot;action.sort.primary&quot;</span>}-&gt;[0];
    my $secondary = $actionParams-&gt;{<span class="stringliteral">&quot;action.sort.secondary&quot;</span>}-&gt;[0];
    my $ternary = $actionParams-&gt;{<span class="stringliteral">&quot;action.sort.ternary&quot;</span>}-&gt;[0];
    
    $self-&gt;{primarySortField} = $primary;
    $self-&gt;{secondarySortField} = $secondary;
    $self-&gt;{ternarySortField} = $ternary;

    my %names = (
                user_id     =&gt; <span class="stringliteral">&quot;Login Name&quot;</span>,
                first_name  =&gt; <span class="stringliteral">&quot;First Name&quot;</span>,
                last_name   =&gt; <span class="stringliteral">&quot;Last Name&quot;</span>,
                email_address   =&gt; <span class="stringliteral">&quot;Email Address&quot;</span>,
                student_id  =&gt; <span class="stringliteral">&quot;Student ID&quot;</span>,
                status      =&gt; <span class="stringliteral">&quot;Enrollment Status&quot;</span>,
                section     =&gt; <span class="stringliteral">&quot;Section&quot;</span>,
                recitation  =&gt; <span class="stringliteral">&quot;Recitation&quot;</span>,
                comment     =&gt; <span class="stringliteral">&quot;Comment&quot;</span>,
                permission  =&gt; <span class="stringliteral">&quot;Permission Level&quot;</span>
    );
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Users sorted by $names{$primary}, then by $names{$secondary}, then by $names{$ternary}.&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="UserList_8pm_source.html">UserList.pm</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:58:31 2012 for WeBWorK2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
