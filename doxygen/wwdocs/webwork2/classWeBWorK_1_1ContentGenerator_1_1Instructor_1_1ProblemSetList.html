<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WeBWorK2: WeBWorK::ContentGenerator::Instructor::ProblemSetList Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="classWeBWorK.html">WeBWorK</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator.html">ContentGenerator</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html">Instructor</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html">ProblemSetList</a>
  </div>
</div>
<div class="contents">
<h1>WeBWorK::ContentGenerator::Instructor::ProblemSetList Class Reference</h1><!-- doxytag: class="WeBWorK::ContentGenerator::Instructor::ProblemSetList" --><!-- doxytag: inherits="WeBWorK::ContentGenerator::Instructor" --><div class="dynheader">
Inheritance diagram for WeBWorK::ContentGenerator::Instructor::ProblemSetList:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList__inherit__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_inherit__map" alt="Inheritance graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_inherit__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_inherit__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="53,155,309,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="85,80,277,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="140,5,223,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for WeBWorK::ContentGenerator::Instructor::ProblemSetList:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList__coll__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_coll__map" alt="Collaboration graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_coll__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList_coll__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="53,155,309,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="85,80,277,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="140,5,223,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a09268ba766126b26a4bd7bacc4e9b6e7">cancelEdit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a106764e726954c67139c4e5eadc07eab">enable_reduced_scoring_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ac54cbd05a475d8b0fd3ded9c504acdb9">export_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3d4ef4d8f675914be822ced8098ba577">menuLabels</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a975fb102bbe2aaffddc8416fc5d875e9">saveEdit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a1fdb52ee00ea0e8635c9209c715499c8">byAnswerDate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ab24e8a0a4eb58bb79ebf301876c810ba">publish_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a764e242225f5100b235459ae3296586d">score_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3462335c8764f1ef4f5691b1abde251f">cancelEdit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a0e7ee9e3752eb418ebe135227232c4bb">saveExport_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af08e94dd156c4df2d7fb8231f005902f">enable_reduced_scoring_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3640eb85f061beeb8ce183d18fe105c7">recordEditHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a5599fb2ccf44904a7c3050c8ad4c95ee">delete_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a972b7cd7d244c78185a31b801a04c7f6">import_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a19c08a742296209316e003193c12dc58">edit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a9ed77db55bdf9afc4b033a1dc08c7be2">score_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa7b932b50716d7759315b7138f16d112">getTableParams</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af4395b239779296f9b33509d6d683d89">readSetDef</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa9aa6ef3caa8b9bd1dcc855479b0a7ef">printTableHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aedb56c4b187c9a44c33edede68663c38">export_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a61cced079ae2e993b23e4e831d110a59">byOpenDate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a618b798bc388fe7089bd7921d4ef3bb2">delete_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a77063db9fee569f64c295dfe9ed68e7d">sort_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a1c7e312117efcae80deddac8d7a602cf">duplicate_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af1697724b3b90f592548070ba091deef">filter_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a591723bfbce9c67b1b8baf7fbf20a4eb">byDueDate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a14bc674a462e5ed071ac00f653723edb">duplicate_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a285d95ae64918c3a4adc9cd37048d883">publish_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a0b1829cdcaa8abdc9cb074ebb4baad19">pre_header_initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ae51e454d30b9a1ab91fe52f2b80d3c0b">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a159cc4faeca3f76a9d45480e8c1913a4">create_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a48dc0156b6b477c643bc45aaf275f326">cancelExport_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa77e5ef38443c9ca1f587f8febf561d7">saveExport_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a9c632e844aba59a800d8e20c136b69bc">body</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#abc023f40279d632ebbf5c0776e690a62">sort_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ab18b65676765c8cab6256696664ac853">edit_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a23aa91c87e961e26943c4f47d6993ff1">saveEdit_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa58eec4df910c24069aa70a3db133099">cancelExport_handler</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aaa47d5dcff1fe7148ca0dcbaa08da315">fieldEditHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a5e035a0ff7410b04b1644326bf849f70">filter_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a612f2607f001321bf8bab5221386fb21">getActionParams</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a41700f7d5527eb129e99261309b0f0b1">exportSetsToDef</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a31f1b01eeddfbafde09abd9999e018cf">create_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a72dc6d41bc32479941ee0151bbb2b4dd">byVisible</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a898cc2cb5f76bdef44b5753c31c0d6a0">byOpenDue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a803c05212b11e2d8e54b82213595153c">importSetsFromDef</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a8e150e5f2551fa029d92c32d76994711">import_form</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a59c328a10628a0d02d632870f2cf6a7a">bySetID</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="NAME">
NAME</a></h2>
<p><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html">WeBWorK::ContentGenerator::Instructor::ProblemSetList</a> - Entry point for Set-specific data editing/viewing </p>
<p>What do we want to be able to do here? </p>
<p>filter sort edit publish import create delete </p>
<p><a class="el" href="classFilter.html">Filter</a> what sets are shown:</p>
<ul>
<li>none, all, selected</li>
<li>matching set_id, visible to students, hidden from students </li>
</ul>
<p>Sort sets by:</p>
<ul>
<li>set name</li>
<li>open date</li>
<li>due date</li>
<li>answer date</li>
<li>header files</li>
<li>visibility to students </li>
</ul>
<p>Switch from view mode to edit mode:</p>
<ul>
<li>showing visible sets</li>
<li>showing selected sets Switch from edit mode to view and save changes Switch from edit mode to view and abandon changes </li>
</ul>
<p>Make sets visible to or hidden from students:</p>
<ul>
<li>all, selected </li>
</ul>
<p>Import sets:</p>
<ul>
<li>replace:<ul>
<li>any users</li>
<li>visible users</li>
<li>selected users</li>
<li>no users</li>
</ul>
</li>
<li>add:<ul>
<li>any users</li>
<li>no users </li>
</ul>
</li>
</ul>
<p>Score sets:</p>
<ul>
<li>all</li>
<li>visible</li>
<li>selected </li>
</ul>
<p>Create a set with a given name </p>
<p>Delete sets:</p>
<ul>
<li>visible</li>
<li>selected</li>
</ul>
<h2><a class="anchor" id="AUTHOR">
AUTHOR</a></h2>
<p>Written by Robert Van Dam, toenail (at) cif.rochester.edu </p>

<p>Definition at line <a class="el" href="ProblemSetList_8pm_source.html#l00073">73</a> of file <a class="el" href="ProblemSetList_8pm_source.html">ProblemSetList.pm</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9c632e844aba59a800d8e20c136b69bc"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::body" ref="a9c632e844aba59a800d8e20c136b69bc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::body </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-body' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-body-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-body-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-body-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in body: 203</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a9c632e844aba59a800d8e20c136b69bc">body</a> {
    my ($self)       = @_;
    my $r            = $self-&gt;r;
    my $urlpath      = $r-&gt;urlpath;
    my $db           = $r-&gt;db;
    my $ce           = $r-&gt;ce;
    my $authz        = $r-&gt;authz;   
    my $courseName   = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setID        = $urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);       
    my $user         = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    
    my $root = $ce-&gt;{webworkURLs}-&gt;{root};

<span class="preprocessor">    # templates for getting field names</span>
<span class="preprocessor"></span>    my $setTemplate = $self-&gt;{setTemplate} = $db-&gt;newGlobalSet;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;You are not authorized to access the Instructor tools.&quot;)
        unless $authz-&gt;hasPermissions($user, &quot;access_instructor_tools&quot;);
    
<span class="preprocessor">    # This table can be consulted when display-ready forms of field names are needed.</span>
<span class="preprocessor"></span>    my %prettyFieldNames = map { $_ =&gt; $_ } 
        $setTemplate-&gt;FIELDS();
    
    @prettyFieldNames{qw(
        select
        problems
        users
        filename
        set_id
        set_header
        hardcopy_header
        open_date
        due_date
        answer_date
        visible
        enable_reduced_scoring  
    )} = (
        <span class="stringliteral">&quot;Select&quot;</span>,
        <span class="stringliteral">&quot;Edit&lt;br&gt; Problems&quot;</span>,
        <span class="stringliteral">&quot;Edit&lt;br&gt; Assigned Users&quot;</span>,
        <span class="stringliteral">&quot;Set Definition Filename&quot;</span>,
        <span class="stringliteral">&quot;Edit&lt;br&gt; Set Data&quot;</span>, 
        <span class="stringliteral">&quot;Set Header&quot;</span>, 
        <span class="stringliteral">&quot;Hardcopy Header&quot;</span>, 
        <span class="stringliteral">&quot;Open Date&quot;</span>, 
        <span class="stringliteral">&quot;Due Date&quot;</span>, 
        <span class="stringliteral">&quot;Answer Date&quot;</span>, 
        <span class="stringliteral">&quot;Visible&quot;</span>,
        <span class="stringliteral">&quot;Reduced Credit&lt;br&gt; Enabled&quot;</span> 
    );
    


    my $actionID = $self-&gt;{actionID};
    
<span class="preprocessor">    ########## retrieve possibly changed values for member fields</span>
<span class="preprocessor"></span>    
    my @allSetIDs = @{ $self-&gt;{allSetIDs} }; # <span class="keywordflow">do</span> we need <span class="keyword">this</span> one? YES, deleting or importing a <span class="keyword">set</span> will change this.
    my @visibleSetIDs = @{ $self-&gt;{visibleSetIDs} };
    my @prevVisibleSetIDs = @{ $self-&gt;{prevVisibleSetIDs} };
    my @selectedSetIDs = @{ $self-&gt;{selectedSetIDs} };
    my $editMode = $self-&gt;{editMode};
    my $exportMode = $self-&gt;{exportMode};
    my $primarySortField = $self-&gt;{primarySortField};
    my $secondarySortField = $self-&gt;{secondarySortField};
    
<span class="preprocessor">    #warn &quot;visibleSetIDs=@visibleSetIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;prevVisibleSetIDs=@prevVisibleSetIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;selectedSetIDs=@selectedSetIDs\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;editMode=$editMode\n&quot;;</span>
<span class="preprocessor"></span><span class="preprocessor">    #warn &quot;exportMode = $exportMode\n&quot;;</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    ########## get required users</span>
<span class="preprocessor"></span>        
<span class="preprocessor">    # DBFIXME use an iterator</span>
<span class="preprocessor"></span>    my @Sets = grep { defined $_ } @visibleSetIDs ? $db-&gt;getGlobalSets(@visibleSetIDs) : ();
    
<span class="preprocessor">    # presort users</span>
<span class="preprocessor"></span>    my %sortSubs = %{ SORT_SUBS() };
    my $primarySortSub = $sortSubs{$primarySortField};
    my $secondarySortSub = $sortSubs{$secondarySortField};  
    
<span class="preprocessor">    # don&#39;t forget to sort in opposite order of importance</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($secondarySortField eq <span class="stringliteral">&quot;set_id&quot;</span>) {
        @Sets = sortByName(<span class="stringliteral">&quot;set_id&quot;</span>, @Sets);
    } <span class="keywordflow">else</span> {
        @Sets = sort $secondarySortSub @Sets;
    }

    <span class="keywordflow">if</span> ($primarySortField eq <span class="stringliteral">&quot;set_id&quot;</span>) {
        @Sets = sortByName(<span class="stringliteral">&quot;set_id&quot;</span>, @Sets);
    } <span class="keywordflow">else</span> {
        @Sets = sort $primarySortSub @Sets;
    }

<span class="preprocessor">    ########## print beginning of form</span>
<span class="preprocessor"></span>    
    print CGI::start_form({method=&gt;<span class="stringliteral">&quot;post&quot;</span>, action=&gt;$self-&gt;systemLink($urlpath,authen=&gt;0), name=&gt;<span class="stringliteral">&quot;problemsetlist&quot;</span>});
    print $self-&gt;hidden_authen_fields();
    
<span class="preprocessor">    ########## print state data</span>
<span class="preprocessor"></span>    
    print <span class="stringliteral">&quot;\n&lt;!-- state data here --&gt;\n&quot;</span>;
    
    <span class="keywordflow">if</span> (@visibleSetIDs) {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;visible_sets&quot;</span>, -value=&gt;\@visibleSetIDs);
    } <span class="keywordflow">else</span> {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;no_visible_sets&quot;</span>, -value=&gt;<span class="stringliteral">&quot;1&quot;</span>);
    }
    
    <span class="keywordflow">if</span> (@prevVisibleSetIDs) {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;prev_visible_sets&quot;</span>, -value=&gt;\@prevVisibleSetIDs);
    } <span class="keywordflow">else</span> {
        print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;no_prev_visible_sets&quot;</span>, -value=&gt;<span class="stringliteral">&quot;1&quot;</span>);
    }
    
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;editMode&quot;</span>, -value=&gt;$editMode);
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;exportMode&quot;</span>, -value=&gt;$exportMode);
    
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;primarySortField&quot;</span>, -value=&gt;$primarySortField);
    print CGI::hidden(-name=&gt;<span class="stringliteral">&quot;secondarySortField&quot;</span>, -value=&gt;$secondarySortField);    
    
    print <span class="stringliteral">&quot;\n&lt;!-- state data here --&gt;\n&quot;</span>;
    
<span class="preprocessor">    ########## print action forms</span>
<span class="preprocessor"></span>    
    print CGI::p(CGI::b(<span class="stringliteral">&quot;Any changes made below will be reflected in the set for ALL students.&quot;</span>)) if $editMode;

    print CGI::start_table({});
    print CGI::Tr({}, CGI::td({-colspan=&gt;2}, <span class="stringliteral">&quot;Select an action to perform:&quot;</span>));

    my @formsToShow;
    <span class="keywordflow">if</span> ($editMode) {
        @formsToShow = @{ EDIT_FORMS() };
    } <span class="keywordflow">else</span> {
        @formsToShow = @{ VIEW_FORMS() };
    }
    
    <span class="keywordflow">if</span> ($exportMode) {
        @formsToShow = @{ EXPORT_FORMS() };
    }
    
    my $i = 0;
    <span class="keywordflow">foreach</span> my $actionID (@formsToShow) {
<span class="preprocessor">        # Check permissions</span>
<span class="preprocessor"></span>        next <span class="keywordflow">if</span> FORM_PERMS()-&gt;{$actionID} and not $authz-&gt;hasPermissions($user, FORM_PERMS()-&gt;{$actionID});
        my $actionForm = <span class="stringliteral">&quot;${actionID}_form&quot;</span>;
        my $onChange = <span class="stringliteral">&quot;document.problemsetlist.action[$i].checked=true&quot;</span>;
        my %actionParams = $self-&gt;getActionParams($actionID);
        
        print CGI::Tr({-valign=&gt;<span class="stringliteral">&quot;top&quot;</span>},
            CGI::td({}, CGI::input({-type=&gt;<span class="stringliteral">&quot;radio&quot;</span>, -name=&gt;<span class="stringliteral">&quot;action&quot;</span>, -value=&gt;$actionID})),
            CGI::td({}, $self-&gt;$actionForm($onChange, %actionParams))
        );
        
        $i++;
    }
    
    my $selectAll =CGI::input({-type=&gt;<span class="stringliteral">&#39;button&#39;</span>, -name=&gt;<span class="stringliteral">&#39;check_all&#39;</span>, -value=&gt;<span class="stringliteral">&#39;Select all sets&#39;</span>,
           onClick =&gt; <span class="stringliteral">&quot;for (i in document.problemsetlist.elements)  { </span>
<span class="stringliteral">                           if (document.problemsetlist.elements[i].name ==&#39;selected_sets&#39;) { </span>
<span class="stringliteral">                               document.problemsetlist.elements[i].checked = true</span>
<span class="stringliteral">                           }</span>
<span class="stringliteral">                        }&quot;</span> });
    my $selectNone =CGI::input({-type=&gt;<span class="stringliteral">&#39;button&#39;</span>, -name=&gt;<span class="stringliteral">&#39;check_none&#39;</span>, -value=&gt;<span class="stringliteral">&#39;Unselect all sets&#39;</span>,
           onClick =&gt; <span class="stringliteral">&quot;for (i in document.problemsetlist.elements)  { </span>
<span class="stringliteral">                           if (document.problemsetlist.elements[i].name ==&#39;selected_sets&#39;) { </span>
<span class="stringliteral">                              document.problemsetlist.elements[i].checked = false</span>
<span class="stringliteral">                           }</span>
<span class="stringliteral">                        }&quot;</span> });
    unless ($editMode or $exportMode) {
        print CGI::Tr({}, CGI::td({ colspan=&gt;2, -align=&gt;<span class="stringliteral">&quot;center&quot;</span>},
            $selectAll.<span class="stringliteral">&quot; &quot;</span>. $selectNone
            )
        );
    }
    print CGI::Tr({}, CGI::td({-colspan=&gt;2, -align=&gt;<span class="stringliteral">&quot;center&quot;</span>},
        CGI::submit(-value=&gt;<span class="stringliteral">&quot;Take Action!&quot;</span>))
    );
    print CGI::end_table();
    
<span class="preprocessor">    ########## print table</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    ########## first adjust heading if in editMode</span>
<span class="preprocessor"></span>    $prettyFieldNames{set_id} = <span class="stringliteral">&quot;Edit All &lt;br&gt; Set Data&quot;</span> <span class="keywordflow">if</span> $editMode;
    $prettyFieldNames{enable_reduced_scoring} = <span class="stringliteral">&#39;Enable Reduced&lt;br&gt;Credit&#39;</span> <span class="keywordflow">if</span> $editMode;
    
    
    print CGI::p({},<span class="stringliteral">&quot;Showing &quot;</span>, scalar @visibleSetIDs, <span class="stringliteral">&quot; out of &quot;</span>, scalar @allSetIDs, <span class="stringliteral">&quot; sets.&quot;</span>);
    
    $self-&gt;printTableHTML(\@Sets, \%prettyFieldNames,
        editMode =&gt; $editMode,
        exportMode =&gt; $exportMode,
        selectedSetIDs =&gt; \@selectedSetIDs,
    );
    
    
<span class="preprocessor">    ########## print end of form</span>
<span class="preprocessor"></span>    
    print CGI::end_form();

    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a1fdb52ee00ea0e8635c9209c715499c8"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::byAnswerDate" ref="a1fdb52ee00ea0e8635c9209c715499c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::byAnswerDate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byAnswerDate' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byAnswerDate-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byAnswerDate-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byAnswerDate-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byAnswerDate: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a1fdb52ee00ea0e8635c9209c715499c8">byAnswerDate</a>    { my $result = eval{( $a-&gt;answer_date || 0)    &lt;=&gt; ( $b-&gt;answer_date || 0 )  };    
                      <span class="keywordflow">return</span> $result unless $@;
                      warn <span class="stringliteral">&quot;Answer date not correctly defined.&quot;</span>;
                      <span class="keywordflow">return</span> 0;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a591723bfbce9c67b1b8baf7fbf20a4eb"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::byDueDate" ref="a591723bfbce9c67b1b8baf7fbf20a4eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::byDueDate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byDueDate' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byDueDate-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byDueDate-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byDueDate-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byDueDate: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a591723bfbce9c67b1b8baf7fbf20a4eb">byDueDate</a>       { my $result = eval{( $a-&gt;due_date || 0 )     &lt;=&gt; ( $b-&gt;due_date || 0 )   };      
                      <span class="keywordflow">return</span> $result unless $@;
                      warn <span class="stringliteral">&quot;Due date not correctly defined.&quot;</span>;
                      <span class="keywordflow">return</span> 0;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a61cced079ae2e993b23e4e831d110a59"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::byOpenDate" ref="a61cced079ae2e993b23e4e831d110a59" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::byOpenDate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byOpenDate' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byOpenDate-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byOpenDate-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byOpenDate-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byOpenDate: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a61cced079ae2e993b23e4e831d110a59">byOpenDate</a>      { my $result = eval{( $a-&gt;open_date || 0 )      &lt;=&gt; ( $b-&gt;open_date || 0 ) };
                      <span class="keywordflow">return</span> $result unless $@;
                      warn <span class="stringliteral">&quot;Open date not correctly defined.&quot;</span>;
                      <span class="keywordflow">return</span> 0;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a898cc2cb5f76bdef44b5753c31c0d6a0"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::byOpenDue" ref="a898cc2cb5f76bdef44b5753c31c0d6a0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::byOpenDue </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byOpenDue' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byOpenDue-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byOpenDue-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byOpenDue-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byOpenDue: 1</span>
<span class="preprocessor">sub byOpenDue       { &amp;byOpenDate || &amp;byDueDate }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a59c328a10628a0d02d632870f2cf6a7a"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::bySetID" ref="a59c328a10628a0d02d632870f2cf6a7a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::bySetID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-bySetID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-bySetID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-bySetID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-bySetID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in bySetID: 1</span>
<span class="preprocessor">sub bySetID         { $a-&gt;set_id         cmp $b-&gt;set_id         }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a72dc6d41bc32479941ee0151bbb2b4dd"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::byVisible" ref="a72dc6d41bc32479941ee0151bbb2b4dd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::byVisible </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byVisible' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byVisible-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byVisible-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byVisible-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byVisible: 5</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a72dc6d41bc32479941ee0151bbb2b4dd">byVisible</a>     { my $result = eval{$a-&gt;visible      cmp $b-&gt;visible   };      
                      <span class="keywordflow">return</span> $result unless $@;
                      warn <span class="stringliteral">&quot;Visibility status not correctly defined.&quot;</span>;
                      <span class="keywordflow">return</span> 0;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3462335c8764f1ef4f5691b1abde251f"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelEdit_form" ref="a3462335c8764f1ef4f5691b1abde251f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelEdit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelEdit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelEdit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelEdit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelEdit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelEdit_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3462335c8764f1ef4f5691b1abde251f">cancelEdit_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Abandon changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a09268ba766126b26a4bd7bacc4e9b6e7"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelEdit_handler" ref="a09268ba766126b26a4bd7bacc4e9b6e7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelEdit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelEdit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelEdit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelEdit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelEdit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelEdit_handler: 17</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a09268ba766126b26a4bd7bacc4e9b6e7">cancelEdit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r      = $self-&gt;r;
    
<span class="preprocessor">    #$self-&gt;{selectedSetIDs) = $self-&gt;{visibleSetIDs};</span>
<span class="preprocessor"></span><span class="preprocessor">        # only do the above if we arrived here via &quot;edit selected users&quot;</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    $self-&gt;{editMode} = 0;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, <span class="stringliteral">&quot;changes abandoned&quot;</span>);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a48dc0156b6b477c643bc45aaf275f326"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelExport_form" ref="a48dc0156b6b477c643bc45aaf275f326" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelExport_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelExport_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelExport_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelExport_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelExport_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelExport_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a48dc0156b6b477c643bc45aaf275f326">cancelExport_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Abandon export&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aa58eec4df910c24069aa70a3db133099"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelExport_handler" ref="aa58eec4df910c24069aa70a3db133099" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::cancelExport_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cancelExport_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cancelExport_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cancelExport_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cancelExport_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cancelExport_handler: 17</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa58eec4df910c24069aa70a3db133099">cancelExport_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r      = $self-&gt;r;
    
<span class="preprocessor">    #$self-&gt;{selectedSetIDs) = $self-&gt;{visibleSetIDs};</span>
<span class="preprocessor"></span><span class="preprocessor">        # only do the above if we arrived here via &quot;edit selected users&quot;</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    $self-&gt;{exportMode} = 0;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>},  <span class="stringliteral">&quot;export abandoned&quot;</span>);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a31f1b01eeddfbafde09abd9999e018cf"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::create_form" ref="a31f1b01eeddfbafde09abd9999e018cf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::create_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-create_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-create_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-create_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-create_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in create_form: 25</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a31f1b01eeddfbafde09abd9999e018cf">create_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    my $r      = $self-&gt;r;
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Create a new set named: &quot;</span>, 
        CGI::textfield(
            -name =&gt; <span class="stringliteral">&quot;action.create.name&quot;</span>,
            -value =&gt; $actionParams{<span class="stringliteral">&quot;action.create.name&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,
            -width =&gt; <span class="stringliteral">&quot;50&quot;</span>,
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot; as &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.create.type&quot;</span>,
            -values =&gt; [qw(empty copy)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.create.type&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;empty&quot;</span>,
            -labels =&gt; {
                empty =&gt; <span class="stringliteral">&quot;a new empty set.&quot;</span>,
                copy =&gt; <span class="stringliteral">&quot;a duplicate of the first selected set.&quot;</span>,
            },
            -onchange =&gt; $onChange,
        );
            
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a159cc4faeca3f76a9d45480e8c1913a4"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::create_handler" ref="a159cc4faeca3f76a9d45480e8c1913a4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::create_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-create_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-create_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-create_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-create_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in create_handler: 73</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a159cc4faeca3f76a9d45480e8c1913a4">create_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $r      = $self-&gt;r;
    my $db     = $r-&gt;db;
    
    my $newSetID = $actionParams-&gt;{<span class="stringliteral">&quot;action.create.name&quot;</span>}-&gt;[0];
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;Failed to create <a class="code" href="classWeBWorK_1_1ContentGenerator.html#a8e4bbd5c8a7a1556013d2b2505d92bdd">new</a> set: no set name specified!&quot;) unless $newSetID =~ /\S/;
    return CGI::div({class =&gt; &quot;ResultsWithError&quot;}, &quot;Set $newSetID exists.  No set created&quot;) if $db-&gt;existsGlobalSet($newSetID);
    my $newSetRecord = $db-&gt;newGlobalSet;
    my $oldSetID = $self-&gt;{selectedSetIDs}-&gt;[0];

    my $type = $actionParams-&gt;{<span class="stringliteral">&quot;action.create.type&quot;</span>}-&gt;[0];
<span class="preprocessor">    # It&#39;s convenient to set the open date one week from now so that it is </span>
<span class="preprocessor"></span><span class="preprocessor">    # not accidentally available to students.  We set the due and answer date</span>
<span class="preprocessor"></span><span class="preprocessor">    # to be two weeks from now.</span>
<span class="preprocessor"></span>

    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;empty&quot;</span>) {
        $newSetRecord-&gt;set_id($newSetID);
        $newSetRecord-&gt;set_header(<span class="stringliteral">&quot;defaultHeader&quot;</span>);
        $newSetRecord-&gt;hardcopy_header(<span class="stringliteral">&quot;defaultHeader&quot;</span>);
        $newSetRecord-&gt;open_date(time + ONE_WEEK());
        $newSetRecord-&gt;due_date(time + 2*ONE_WEEK() );
        $newSetRecord-&gt;answer_date(time + 2*ONE_WEEK() );
        $newSetRecord-&gt;visible(DEFAULT_VISIBILITY_STATE()); # don<span class="stringliteral">&#39;t want students to see an empty set</span>
<span class="stringliteral">        $newSetRecord-&gt;enable_reduced_scoring(DEFAULT_ENABLED_REDUCED_SCORING_STATE());</span>
<span class="stringliteral">        $db-&gt;addGlobalSet($newSetRecord);</span>
<span class="stringliteral">    } elsif ($type eq &quot;copy&quot;) {</span>
<span class="stringliteral">        return CGI::div({class =&gt; &quot;ResultsWithError&quot;}, &quot;Failed to duplicate set: no set selected for duplication!&quot;) unless $oldSetID =~ /\S/;</span>
<span class="stringliteral">        $newSetRecord = $db-&gt;getGlobalSet($oldSetID);</span>
<span class="stringliteral">        $newSetRecord-&gt;set_id($newSetID);</span>
<span class="stringliteral">        $db-&gt;addGlobalSet($newSetRecord);</span>
<span class="stringliteral"></span>
<span class="stringliteral">        # take all the problems from the old set and make them part of the new set</span>
<span class="stringliteral">        foreach ($db-&gt;getAllGlobalProblems($oldSetID)) { </span>
<span class="stringliteral">            $_-&gt;set_id($newSetID); </span>
<span class="stringliteral">            $db-&gt;addGlobalProblem($_);</span>
<span class="stringliteral">        }</span>
<span class="stringliteral"></span>
<span class="stringliteral">        # also copy any set_location restrictions and set-level proctor</span>
<span class="stringliteral">        #    information</span>
<span class="stringliteral">        foreach ($db-&gt;getAllGlobalSetLocations($oldSetID)) {</span>
<span class="stringliteral">            $_-&gt;set_id($newSetID);</span>
<span class="stringliteral">            $db-&gt;addGlobalSetLocation($_);</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        if ( $newSetRecord-&gt;restricted_login_proctor eq &#39;</span>Yes<span class="stringliteral">&#39; ) {</span>
<span class="stringliteral">            my $procUser = $db-&gt;getUser(&quot;set_id:$oldSetID&quot;);</span>
<span class="stringliteral">            $procUser-&gt;user_id(&quot;set_id:$newSetID&quot;);</span>
<span class="stringliteral">            eval { $db-&gt;addUser( $procUser ) };</span>
<span class="stringliteral">            if ( ! $@ ) {</span>
<span class="stringliteral">                my $procPerm = $db-&gt;getPermissionLevel(&quot;set_id:$oldSetID&quot;);</span>
<span class="stringliteral">                $procPerm-&gt;user_id(&quot;set_id:$newSetID&quot;);</span>
<span class="stringliteral">                $db-&gt;addPermissionLevel($procPerm);</span>
<span class="stringliteral">                my $procPass = $db-&gt;getPassword(&quot;set_id:$oldSetID&quot;);</span>
<span class="stringliteral">                $procPass-&gt;user_id(&quot;set_id:$newSetID&quot;);</span>
<span class="stringliteral">                $db-&gt;addPassword($procPass);</span>
<span class="stringliteral">            }</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    #  Assign set to current active user</span>
<span class="stringliteral">     my $userName = $r-&gt;param(&#39;</span>user<span class="stringliteral">&#39;); # FIXME possible security risk</span>
<span class="stringliteral">     $self-&gt;assignSetToUser($userName, $newSetRecord); # cures weird date error when no-one assigned to set</span>
<span class="stringliteral">     $self-&gt;addgoodmessage(&quot;Set $newSetID was assigned to $userName.&quot;); # not currently used</span>
<span class="stringliteral"></span>
<span class="stringliteral">    push @{ $self-&gt;{visibleSetIDs} }, $newSetID;</span>
<span class="stringliteral">    push @{ $self-&gt;{allSetIds} }, $newSetID;</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return CGI::div({class =&gt; &quot;ResultsWithError&quot;}, &quot;Failed to create new set: $@&quot;) if $@;</span>
<span class="stringliteral">    </span>
<span class="stringliteral">     return CGI::div({class=&gt;&quot;ResultsWithoutError&quot;},&quot;Successfully created new set $newSetID&quot; );</span>
<span class="stringliteral">    </span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a5599fb2ccf44904a7c3050c8ad4c95ee"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::delete_form" ref="a5599fb2ccf44904a7c3050c8ad4c95ee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::delete_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-delete_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in delete_form: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a5599fb2ccf44904a7c3050c8ad4c95ee">delete_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, 
            <span class="stringliteral">&quot;Delete &quot;</span>,
            CGI::popup_menu(
                -name =&gt; <span class="stringliteral">&quot;action.delete.scope&quot;</span>,
                -values =&gt; [qw(none selected)],
                -<span class="keywordflow">default</span> =&gt; <span class="stringliteral">&quot;none&quot;</span>, #  don<span class="stringliteral">&#39;t make it easy to delete # $actionParams{&quot;action.delete.scope&quot;}-&gt;[0] || &quot;none&quot;,</span>
<span class="stringliteral">                -labels =&gt; {</span>
<span class="stringliteral">                    none =&gt; &quot;no sets.&quot;,</span>
<span class="stringliteral">                    #visible =&gt; &quot;visible sets.&quot;,</span>
<span class="stringliteral">                    selected =&gt; &quot;selected sets.&quot;,</span>
<span class="stringliteral">                },</span>
<span class="stringliteral">                -onchange =&gt; $onChange,</span>
<span class="stringliteral">            ),</span>
<span class="stringliteral">            CGI::em(&quot; Deletion destroys all set-related data and is not undoable!&quot;),</span>
<span class="stringliteral">        )</span>
<span class="stringliteral">    );</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a618b798bc388fe7089bd7921d4ef3bb2"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::delete_handler" ref="a618b798bc388fe7089bd7921d4ef3bb2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::delete_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-delete_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in delete_handler: 35</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a618b798bc388fe7089bd7921d4ef3bb2">delete_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $r      = $self-&gt;r;
    my $db     = $r-&gt;db;

    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.delete.scope&quot;</span>}-&gt;[0];

    
    my @setIDsToDelete = ();

    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @setIDsToDelete = @{ $self-&gt;{selectedSetIDs} };
    }
    
    my %allSetIDs = map { $_ =&gt; 1 } @{ $self-&gt;{allSetIDs} };
    my %visibleSetIDs = map { $_ =&gt; 1 } @{ $self-&gt;{visibleSetIDs} };
    my %selectedSetIDs = map { $_ =&gt; 1 } @{ $self-&gt;{selectedSetIDs} };

    <span class="keywordflow">foreach</span> my $setID (@setIDsToDelete) {
        <span class="keyword">delete</span> $allSetIDs{$setID};
        <span class="keyword">delete</span> $visibleSetIDs{$setID};
        <span class="keyword">delete</span> $selectedSetIDs{$setID};
        $db-&gt;deleteGlobalSet($setID);
    }
    
    $self-&gt;{allSetIDs} = [ keys %allSetIDs ];
    $self-&gt;{visibleSetIDs} = [ keys %visibleSetIDs ];
    $self-&gt;{selectedSetIDs} = [ keys %selectedSetIDs ];
    
    my $num = @setIDsToDelete;
     <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},  <span class="stringliteral">&quot;deleted $num set&quot;</span> .
                                               ($num == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>)
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a1c7e312117efcae80deddac8d7a602cf"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::duplicate_form" ref="a1c7e312117efcae80deddac8d7a602cf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::duplicate_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-duplicate_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-duplicate_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-duplicate_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-duplicate_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in duplicate_form: 18</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a1c7e312117efcae80deddac8d7a602cf">duplicate_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    my $r = $self-&gt;r;
    my @visible_sets = $r-&gt;param(<span class="stringliteral">&#39;visible_sets&#39;</span>);

    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span> unless @visible_sets == 1;
    
    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>, 
        <span class="stringliteral">&quot;Duplicate this set and name it: &quot;</span>, 
        CGI::textfield(
            -name =&gt; <span class="stringliteral">&quot;action.duplicate.name&quot;</span>,
            -value =&gt; $actionParams{<span class="stringliteral">&quot;action.duplicate.name&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,
            -width =&gt; <span class="stringliteral">&quot;50&quot;</span>,
            -onchange =&gt; $onChange,
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a14bc674a462e5ed071ac00f653723edb"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::duplicate_handler" ref="a14bc674a462e5ed071ac00f653723edb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::duplicate_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-duplicate_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-duplicate_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-duplicate_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-duplicate_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in duplicate_handler: 29</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a14bc674a462e5ed071ac00f653723edb">duplicate_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $r = $self-&gt;r;
    my $db = $r-&gt;db;
    
    my $oldSetID = $self-&gt;{selectedSetIDs}-&gt;[0];
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;Failed to duplicate set: no set selected for duplication!&quot;) unless defined($oldSetID) and $oldSetID =~ /\S/;    
    my $newSetID = $actionParams-&gt;{<span class="stringliteral">&quot;action.duplicate.name&quot;</span>}-&gt;[0];
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;Failed to duplicate set: no set name specified!&quot;) unless $newSetID =~ /\S/;     
<span class="preprocessor">    # DBFIXME checking for existence -- don&#39;t need to fetch</span>
<span class="preprocessor"></span>    return CGI::div({class =&gt; &quot;ResultsWithError&quot;}, &quot;Failed to duplicate set: set $newSetID already exists!&quot;) if defined $db-&gt;getGlobalSet($newSetID);

    my $newSet = $db-&gt;getGlobalSet($oldSetID);
    $newSet-&gt;set_id($newSetID);
    eval {$db-&gt;addGlobalSet($newSet)};
    
<span class="preprocessor">    # take all the problems from the old set and make them part of the new set</span>
<span class="preprocessor"></span>    <span class="keywordflow">foreach</span> ($db-&gt;getAllGlobalProblems($oldSetID)) { 
        $_-&gt;set_id($newSetID); 
        $db-&gt;addGlobalProblem($_);
    }
    
    push @{ $self-&gt;{visibleSetIDs} }, $newSetID;

    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;Failed to duplicate set: $<span class="stringliteral">@&quot;) if $@;</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return &quot;</span>SUCCESS&quot;;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ab18b65676765c8cab6256696664ac853"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::edit_form" ref="ab18b65676765c8cab6256696664ac853" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::edit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-edit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-edit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-edit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-edit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in edit_form: 18</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ab18b65676765c8cab6256696664ac853">edit_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Edit &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.edit.scope&quot;</span>,
            -values =&gt; [qw(all visible selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.edit.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;selected&quot;</span>,
            -labels =&gt; {
                all =&gt; <span class="stringliteral">&quot;all sets&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible sets&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected sets&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a19c08a742296209316e003193c12dc58"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::edit_handler" ref="a19c08a742296209316e003193c12dc58" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::edit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-edit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-edit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-edit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-edit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in edit_handler: 20</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a19c08a742296209316e003193c12dc58">edit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.edit.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing all sets&quot;</span>;
        $self-&gt;{visibleSetIDs} = $self-&gt;{allSetIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing visible sets&quot;</span>;
<span class="preprocessor">        # leave visibleUserIDs alone</span>
<span class="preprocessor"></span>    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;editing selected sets&quot;</span>;
        $self-&gt;{visibleSetIDs} = $genericParams-&gt;{selected_sets}; # an arrayref
    }
    $self-&gt;{editMode} = 1;
    
    <span class="keywordflow">return</span> $result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a106764e726954c67139c4e5eadc07eab"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::enable_reduced_scoring_form" ref="a106764e726954c67139c4e5eadc07eab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::enable_reduced_scoring_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-enable_reduced_scoring_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-enable_reduced_scoring_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-enable_reduced_scoring_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-enable_reduced_scoring_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in enable_reduced_scoring_form: 30</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a106764e726954c67139c4e5eadc07eab">enable_reduced_scoring_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Make &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.enable_reduced_scoring.scope&quot;</span>,
            -values =&gt; [ qw(none all selected) ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.enable_reduced_scoring.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;selected&quot;</span>,
            -labels =&gt; {
                none =&gt; <span class="stringliteral">&quot;&quot;</span>,
                all =&gt; <span class="stringliteral">&quot;all sets&quot;</span>,
<span class="preprocessor">#               visible =&gt; &quot;visible sets&quot;,</span>
<span class="preprocessor"></span>                selected =&gt; <span class="stringliteral">&quot;selected sets&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.enable_reduced_scoring.value&quot;</span>,
            -values =&gt; [ 0, 1 ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.enable_reduced_scoring.value&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;1&quot;</span>,
            -labels =&gt; {
                0 =&gt; <span class="stringliteral">&quot;disable&quot;</span>,
                1 =&gt; <span class="stringliteral">&quot;enable&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot; reduced sccoring.&quot;</span>,
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="af08e94dd156c4df2d7fb8231f005902f"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::enable_reduced_scoring_handler" ref="af08e94dd156c4df2d7fb8231f005902f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::enable_reduced_scoring_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-enable_reduced_scoring_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-enable_reduced_scoring_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-enable_reduced_scoring_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-enable_reduced_scoring_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in enable_reduced_scoring_handler: 37</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af08e94dd156c4df2d7fb8231f005902f">enable_reduced_scoring_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $r = $self-&gt;r;
    my $db = $r-&gt;db;

    my $result = <span class="stringliteral">&quot;&quot;</span>;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.enable_reduced_scoring.scope&quot;</span>}-&gt;[0];
    my $value = $actionParams-&gt;{<span class="stringliteral">&quot;action.enable_reduced_scoring.value&quot;</span>}-&gt;[0];

    my $verb = $value ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>;
    
    my @setIDs;
    
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;none&quot;</span>) { # FIXME: <span class="keywordtype">double</span> negative <span class="stringliteral">&quot;Make no sets hidden&quot;</span> might make professor expect all sets to be made visible.
        @setIDs = ();
        $result =  CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, <span class="stringliteral">&quot;No change made to any set.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        @setIDs = @{ $self-&gt;{allSetIDs} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;Reduced Credit $verb for all sets.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        @setIDs = @{ $self-&gt;{visibleSetIDs} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;Reduced Credit $verb for visable sets.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @setIDs = @{ $genericParams-&gt;{selected_sets} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;Reduced Credit $verb for selected sets.&quot;</span>);
    }
    
<span class="preprocessor">    # can we use UPDATE here, instead of fetch/change/store?</span>
<span class="preprocessor"></span>    my @sets = $db-&gt;getGlobalSets(@setIDs);
    
    map { $_-&gt;enable_reduced_scoring(<span class="stringliteral">&quot;$value&quot;</span>) <span class="keywordflow">if</span> $_; $db-&gt;putGlobalSet($_); } @sets;
    
    <span class="keywordflow">return</span> $result
    
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aedb56c4b187c9a44c33edede68663c38"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::export_form" ref="aedb56c4b187c9a44c33edede68663c38" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::export_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-export_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in export_form: 18</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aedb56c4b187c9a44c33edede68663c38">export_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Export &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.export.scope&quot;</span>,
            -values =&gt; [qw(all visible selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.export.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;visible&quot;</span>,
            -labels =&gt; {
                all =&gt; <span class="stringliteral">&quot;all sets&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;visible sets&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected sets&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ac54cbd05a475d8b0fd3ded9c504acdb9"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::export_handler" ref="ac54cbd05a475d8b0fd3ded9c504acdb9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::export_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-export_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in export_handler: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ac54cbd05a475d8b0fd3ded9c504acdb9">export_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.export.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;exporting all sets&quot;</span>;
        $self-&gt;{selectedSetIDs} = $self-&gt;{visibleSetIDs} = $self-&gt;{allSetIDs};

    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        $result = <span class="stringliteral">&quot;exporting visible sets&quot;</span>;
        $self-&gt;{selectedSetIDs} = $self-&gt;{visibleSetIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;exporting selected sets&quot;</span>;
        $self-&gt;{selectedSetIDs} = $self-&gt;{visibleSetIDs} = $genericParams-&gt;{selected_sets}; # an arrayref
    }
    $self-&gt;{exportMode} = 1;
    
    <span class="keywordflow">return</span>   CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},  $result);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a41700f7d5527eb129e99261309b0f0b1"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::exportSetsToDef" ref="a41700f7d5527eb129e99261309b0f0b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::exportSetsToDef </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-exportSetsToDef' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-exportSetsToDef-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-exportSetsToDef-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-exportSetsToDef-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in exportSetsToDef: 135</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a41700f7d5527eb129e99261309b0f0b1">exportSetsToDef</a> {
        my ($self, %filenames) = @_;

    my $r        = $self-&gt;r;
    my $ce       = $r-&gt;ce;
    my $db       = $r-&gt;db;

    my (@exported, @skipped, %reason);

SET:    <span class="keywordflow">foreach</span> my $set (keys %filenames) {

        my $fileName = $filenames{$set};
        $fileName .= <span class="stringliteral">&quot;.def&quot;</span> unless $fileName =~ m/\.def$/;
        $fileName  = <span class="stringliteral">&quot;set&quot;</span> . $fileName unless $fileName =~ m/^<span class="keyword">set</span>/;
<span class="preprocessor">        # files can be exported to sub directories but not parent directories</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ($fileName =~ /\.\./) {
            push @skipped, $set;
            $reason{$set} = <span class="stringliteral">&quot;Illegal filename contains &#39;..&#39;&quot;</span>;
            next SET;
        }

        my $setRecord = $db-&gt;getGlobalSet($set);
        unless (defined $setRecord) {
            push @skipped, $set;
            $reason{$set} = <span class="stringliteral">&quot;No record found.&quot;</span>;
            next SET;
        }
        my $filePath = $ce-&gt;{courseDirs}-&gt;{templates} . <span class="charliteral">&#39;/&#39;</span> . $fileName;

<span class="preprocessor">        # back up existing file</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span>(-e $filePath) {
            rename($filePath, <span class="stringliteral">&quot;$filePath.bak&quot;</span>) or 
                $reason{$set} = <span class="stringliteral">&quot;Existing file $filePath could not be backed up and was lost.&quot;</span>;
        }
        
        my $openDate     = $self-&gt;formatDateTime($setRecord-&gt;open_date);
        my $dueDate      = $self-&gt;formatDateTime($setRecord-&gt;due_date);
        my $answerDate   = $self-&gt;formatDateTime($setRecord-&gt;answer_date);
        my $setHeader    = $setRecord-&gt;set_header;
        my $paperHeader  = $setRecord-&gt;hardcopy_header;
        my @problemList = $db-&gt;listGlobalProblems($set);

        my $problemList  = <span class="stringliteral">&#39;&#39;</span>;
        <span class="keywordflow">foreach</span> my $prob (sort {$a &lt;=&gt; $b} @problemList) {
<span class="preprocessor">            # DBFIXME use an iterator?</span>
<span class="preprocessor"></span>            my $problemRecord = $db-&gt;getGlobalProblem($set, $prob); # checked
            unless (defined $problemRecord) {
                push @skipped, $set;
                $reason{$set} = <span class="stringliteral">&quot;No record found for problem $prob.&quot;</span>;
                next SET;
            }
            my $source_file   = $problemRecord-&gt;source_file();
            my $value         = $problemRecord-&gt;value();
            my $max_attempts  = $problemRecord-&gt;max_attempts();
            
<span class="preprocessor">            # backslash-escape commas in fields</span>
<span class="preprocessor"></span>            $source_file =~ s/([,\\])/\\$1/g;
            $value =~ s/([,\\])/\\$1/g;
            $max_attempts =~ s/([,\\])/\\$1/g;
            $problemList     .= <span class="stringliteral">&quot;$source_file, $value, $max_attempts \n&quot;</span>;
        }

<span class="preprocessor">        # gateway fields</span>
<span class="preprocessor"></span>        my $assignmentType = $setRecord-&gt;assignment_type;
        my $gwFields = <span class="stringliteral">&#39;&#39;</span>;
        <span class="keywordflow">if</span> ( $assignmentType =~ /gateway/ ) {
            my $attemptsPerV = $setRecord-&gt;attempts_per_version;
            my $timeInterval = $setRecord-&gt;time_interval;
            my $vPerInterval = $setRecord-&gt;versions_per_interval;
            my $vTimeLimit   = $setRecord-&gt;version_time_limit;
            my $probRandom   = $setRecord-&gt;problem_randorder;
            my $probPerPage  = $setRecord-&gt;problems_per_page;
            my $hideScore    = $setRecord-&gt;hide_score;
            my $hideWork     = $setRecord-&gt;hide_work;
            my $timeCap      = $setRecord-&gt;time_limit_cap;
            $gwFields =&lt;&lt;EOG;

assignmentType      = $assignmentType
attemptsPerVersion  = $attemptsPerV
timeInterval        = $timeInterval
versionsPerInterval = $vPerInterval
versionTimeLimit    = $vTimeLimit
problemRandOrder    = $probRandom
problemsPerPage     = $probPerPage
hideScore           = $hideScore
hideWork            = $hideWork
capTimeLimit        = $timeCap
EOG
            chomp($gwFields);
        }

<span class="preprocessor">        # ip restriction fields</span>
<span class="preprocessor"></span>        my $restrictIP = $setRecord-&gt;restrict_ip;
        my $restrictFields = <span class="stringliteral">&#39;&#39;</span>;
        <span class="keywordflow">if</span> ( $restrictIP &amp;&amp; $restrictIP ne <span class="stringliteral">&#39;No&#39;</span> ) {
<span class="preprocessor">            # only store the first location</span>
<span class="preprocessor"></span>            my $restrictLoc = ($db-&gt;listGlobalSetLocations($setRecord-&gt;set_id))[0];
            my $relaxRestrict = $setRecord-&gt;relax_restrict_ip;
            $restrictLoc || ($restrictLoc = <span class="stringliteral">&#39;&#39;</span>);
            $restrictFields = <span class="stringliteral">&quot;restrictIP          = $restrictIP&quot;</span> .
                <span class="stringliteral">&quot;\nrestrictLocation    = $restrictLoc\n&quot;</span> . 
                <span class="stringliteral">&quot;relaxRestrictIP     = $relaxRestrict\n&quot;</span>;
        }

        my $fileContents = &lt;&lt;EOF;

openDate          = $openDate
dueDate           = $dueDate
answerDate        = $answerDate
paperHeaderFile   = $paperHeader
screenHeaderFile  = $setHeader$gwFields
${restrictFields}problemList       = 
$problemList
EOF

        $filePath = <a class="code" href="classWeBWorK_1_1Utils.html#aec74ceba9815c67c2d10f46fbe909063">WeBWorK::Utils::surePathToFile</a>($ce-&gt;{courseDirs}-&gt;{templates}, $filePath);
        eval {
            local *SETDEF;
            open SETDEF, <span class="stringliteral">&quot;&gt;$filePath&quot;</span> or die <span class="stringliteral">&quot;Failed to open $filePath&quot;</span>;
            print SETDEF $fileContents;
            close SETDEF;
        };
        
        <span class="keywordflow">if</span> ($@) {
            push @skipped, $set;
            $reason{$set} = $@;
        } <span class="keywordflow">else</span> {
            push @exported, $set;
        }

    }
    
    <span class="keywordflow">return</span> \@exported, \@skipped, \%reason;

}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aaa47d5dcff1fe7148ca0dcbaa08da315"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::fieldEditHTML" ref="aaa47d5dcff1fe7148ca0dcbaa08da315" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::fieldEditHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-fieldEditHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-fieldEditHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-fieldEditHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-fieldEditHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in fieldEditHTML: 65</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aaa47d5dcff1fe7148ca0dcbaa08da315">fieldEditHTML</a> {
    my ($self, $fieldName, $value, $properties) = @_;
    my $size = $properties-&gt;{size};
    my $type = $properties-&gt;{type};
    my $access = $properties-&gt;{access};
    my $items = $properties-&gt;{items};
    my $synonyms = $properties-&gt;{synonyms};
    my $headerFiles = $self-&gt;{headerFiles};
    
    <span class="keywordflow">if</span> ($access eq <span class="stringliteral">&quot;readonly&quot;</span>) {
        <span class="keywordflow">return</span> $value;
    }
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;number&quot;</span> or $type eq <span class="stringliteral">&quot;text&quot;</span>) {
        <span class="keywordflow">return</span> CGI::input({type=&gt;<span class="stringliteral">&quot;text&quot;</span>, name=&gt;$fieldName, value=&gt;$value, size=&gt;$size});
    }
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;filelist&quot;</span>) {
        <span class="keywordflow">return</span> CGI::popup_menu({
            name =&gt; $fieldName,
            value =&gt; [ sort keys %$headerFiles ],
            labels =&gt; $headerFiles,
            <span class="keywordflow">default</span> =&gt; $value || 0,
        });
    }

    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;enumerable&quot;</span>) {
        my $matched = undef; # Whether a synonym match has occurred

<span class="preprocessor">        # Process synonyms for enumerable objects</span>
<span class="preprocessor"></span>        <span class="keywordflow">foreach</span> my $synonym (keys %$synonyms) {
            <span class="keywordflow">if</span> ($synonym ne <span class="stringliteral">&quot;*&quot;</span> and $value =~ m/$synonym/) {
                $value = $synonyms-&gt;{$synonym};
                $matched = 1;
            }
        }
        
        <span class="keywordflow">if</span> (!$matched and exists $synonyms-&gt;{<span class="stringliteral">&quot;*&quot;</span>}) {
            $value = $synonyms-&gt;{<span class="stringliteral">&quot;*&quot;</span>};
        }
        
        <span class="keywordflow">return</span> CGI::popup_menu({
            name =&gt; $fieldName, 
            values =&gt; [keys %$items],
            <span class="keywordflow">default</span> =&gt; $value,
            labels =&gt; $items,
        });
    }
    
    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&quot;checked&quot;</span>) {
        
<span class="preprocessor">        # FIXME: kludge (R)</span>
<span class="preprocessor"></span><span class="preprocessor">        # if the checkbox is checked it returns a 1, if it is unchecked it returns nothing</span>
<span class="preprocessor"></span><span class="preprocessor">        # in which case the hidden field overrides the parameter with a 0</span>
<span class="preprocessor"></span>        <span class="keywordflow">return</span> CGI::checkbox(
            -name =&gt; $fieldName,
            -checked =&gt; $value,
            -label =&gt; <span class="stringliteral">&quot;&quot;</span>,
            -value =&gt; 1
        ) . CGI::hidden(
            -name =&gt; $fieldName,
            -value =&gt; 0
        );
    }
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a5e035a0ff7410b04b1644326bf849f70"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::filter_form" ref="a5e035a0ff7410b04b1644326bf849f70" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::filter_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-filter_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-filter_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-filter_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-filter_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in filter_form: 56</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a5e035a0ff7410b04b1644326bf849f70">filter_form</a> {
    my ($self, $onChange, %actionParams) = @_;
<span class="preprocessor">    #return CGI::table({}, CGI::Tr({-valign=&gt;&quot;top&quot;},</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::td({}, </span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot;&quot;</span>, 
            <span class="stringliteral">&quot;Show &quot;</span>,
            CGI::popup_menu(
                -name =&gt; <span class="stringliteral">&quot;action.filter.scope&quot;</span>,
                -values =&gt; [qw(all none selected match_ids visible unvisible)],
                -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.filter.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;match_ids&quot;</span>,
                -labels =&gt; {
                    all =&gt; <span class="stringliteral">&quot;all sets&quot;</span>,
                    none =&gt; <span class="stringliteral">&quot;no sets&quot;</span>,
                    selected =&gt; <span class="stringliteral">&quot;sets checked below&quot;</span>,
                    visible =&gt; <span class="stringliteral">&quot;sets visible to students&quot;</span>,
                    unvisible =&gt; <span class="stringliteral">&quot;sets hidden from students&quot;</span>, 
                    match_ids =&gt; <span class="stringliteral">&quot;sets with matching set IDs:&quot;</span>,
                },
                -onchange =&gt; $onChange,
            ),
            <span class="stringliteral">&quot; &quot;</span>,
            CGI::textfield(
                -name =&gt; <span class="stringliteral">&quot;action.filter.set_ids&quot;</span>,
                -value =&gt; $actionParams{<span class="stringliteral">&quot;action.filter.set_ids&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;&quot;</span>,,
                -width =&gt; <span class="stringliteral">&quot;50&quot;</span>,
                -onchange =&gt; $onChange,
            ),
            <span class="stringliteral">&quot; (separate multiple IDs with commas)&quot;</span>,
            CGI::br(),
#           <span class="stringliteral">&quot;Open dates: &quot;</span>,
#           CGI::popup_menu(
#               -name =&gt; <span class="stringliteral">&quot;action.filter.open_date&quot;</span>,
#               -values =&gt; [ keys %{ $self-&gt;{open_dates} } ],
<span class="preprocessor">#               -default =&gt; $actionParams{&quot;action.filter.open_date&quot;}-&gt;[0] || &quot;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -labels =&gt; { $self-&gt;menuLabels($self-&gt;{open_dates}) },</span>
<span class="preprocessor"></span><span class="preprocessor">#               -onchange =&gt; $onChange,</span>
<span class="preprocessor"></span><span class="preprocessor">#           ),</span>
<span class="preprocessor"></span><span class="preprocessor">#           &quot; Due dates: &quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#           CGI::popup_menu(</span>
<span class="preprocessor"></span><span class="preprocessor">#               -name =&gt; &quot;action.filter.due_date&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -values =&gt; [ keys %{ $self-&gt;{due_dates} } ],</span>
<span class="preprocessor"></span><span class="preprocessor">#               -default =&gt; $actionParams{&quot;action.filter.due_date&quot;}-&gt;[0] || &quot;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -labels =&gt; { $self-&gt;menuLabels($self-&gt;{due_dates}) },</span>
<span class="preprocessor"></span><span class="preprocessor">#               -onchange =&gt; $onChange,</span>
<span class="preprocessor"></span><span class="preprocessor">#           ),</span>
<span class="preprocessor"></span><span class="preprocessor">#           &quot; Answer dates: &quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#           CGI::popup_menu(</span>
<span class="preprocessor"></span><span class="preprocessor">#               -name =&gt; &quot;action.filter.answer_date&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -values =&gt; [ keys %{ $self-&gt;{answer_dates} } ],</span>
<span class="preprocessor"></span><span class="preprocessor">#               -default =&gt; $actionParams{&quot;action.filter.answer_date&quot;}-&gt;[0] || &quot;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#               -labels =&gt; { $self-&gt;menuLabels($self-&gt;{answer_dates}) },</span>
<span class="preprocessor"></span><span class="preprocessor">#               -onchange =&gt; $onChange,</span>
<span class="preprocessor"></span><span class="preprocessor">#           ),</span>
<span class="preprocessor"></span>            
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="af1697724b3b90f592548070ba091deef"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::filter_handler" ref="af1697724b3b90f592548070ba091deef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::filter_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-filter_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-filter_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-filter_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-filter_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in filter_handler: 44</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af1697724b3b90f592548070ba091deef">filter_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $r = $self-&gt;r ;
    my $db = $r-&gt;db;
    
    my $result;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.scope&quot;</span>}-&gt;[0];
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing all sets&quot;</span>;
        $self-&gt;{visibleSetIDs} = $self-&gt;{allSetIDs};
    } elsif ($scope eq <span class="stringliteral">&quot;none&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing no sets&quot;</span>;
        $self-&gt;{visibleSetIDs} = [];
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        $result = <span class="stringliteral">&quot;showing selected sets&quot;</span>;
        $self-&gt;{visibleSetIDs} = $genericParams-&gt;{selected_sets}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;match_ids&quot;</span>) {
        my @setIDs = split /\s*,\s*/, $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.set_ids&quot;</span>}-&gt;[0];
        $self-&gt;{visibleSetIDs} = \@setIDs;
    } elsif ($scope eq <span class="stringliteral">&quot;match_open_date&quot;</span>) {
        my $open_date = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.open_date&quot;</span>}-&gt;[0];
        $self-&gt;{visibleSetIDs} = $self-&gt;{open_dates}-&gt;{$open_date}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;match_due_date&quot;</span>) {
        my $due_date = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.due_date&quot;</span>}-&gt;[0];
        $self-&gt;{visibleSetIDs} = $self-&gt;{due_date}-&gt;{$due_date}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;match_answer_date&quot;</span>) {
        my $answer_date = $actionParams-&gt;{<span class="stringliteral">&quot;action.filter.answer_date&quot;</span>}-&gt;[0];
        $self-&gt;{visibleSetIDs} = $self-&gt;{answer_dates}-&gt;{$answer_date}; # an arrayref
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
<span class="preprocessor">        # DBFIXME do filtering in the database, please!</span>
<span class="preprocessor"></span>        my @setRecords = $db-&gt;getGlobalSets(@{$self-&gt;{allSetIDs}});
        my @visibleSetIDs = map { $_-&gt;visible ? $_-&gt;set_id : <span class="stringliteral">&quot;&quot;</span>} @setRecords;       
        $self-&gt;{visibleSetIDs} = \@visibleSetIDs;
    } elsif ($scope eq <span class="stringliteral">&quot;unvisible&quot;</span>) {
<span class="preprocessor">        # DBFIXME do filtering in the database, please!</span>
<span class="preprocessor"></span>        my @setRecords = $db-&gt;getGlobalSets(@{$self-&gt;{allSetIDs}});
        my @unvisibleSetIDs = map { (not $_-&gt;visible) ? $_-&gt;set_id : <span class="stringliteral">&quot;&quot;</span>} @setRecords;
        $self-&gt;{visibleSetIDs} = \@unvisibleSetIDs;
    }
    
    <span class="keywordflow">return</span> $result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a612f2607f001321bf8bab5221386fb21"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::getActionParams" ref="a612f2607f001321bf8bab5221386fb21" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::getActionParams </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-getActionParams' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-getActionParams-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-getActionParams-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-getActionParams-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in getActionParams: 11</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a612f2607f001321bf8bab5221386fb21">getActionParams</a> {
    my ($self, $actionID) = @_;
    my $r = $self-&gt;{<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a>};
    
    my %actionParams;
    <span class="keywordflow">foreach</span> my $param ($r-&gt;param) {
        next unless $param =~ m/^action\.$actionID\./;
        $actionParams{$param} = [ $r-&gt;param($param) ];
    }
    <span class="keywordflow">return</span> %actionParams;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aa7b932b50716d7759315b7138f16d112"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::getTableParams" ref="aa7b932b50716d7759315b7138f16d112" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::getTableParams </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-getTableParams' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-getTableParams-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-getTableParams-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-getTableParams-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in getTableParams: 11</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa7b932b50716d7759315b7138f16d112">getTableParams</a> {
    my ($self) = @_;
    my $r = $self-&gt;{<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a>};
    
    my %tableParams;
    <span class="keywordflow">foreach</span> my $param ($r-&gt;param) {
        next unless $param =~ m/^(?:<span class="keyword">set</span>)\./;
        $tableParams{$param} = [ $r-&gt;param($param) ];
    }
    <span class="keywordflow">return</span> %tableParams;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a8e150e5f2551fa029d92c32d76994711"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::import_form" ref="a8e150e5f2551fa029d92c32d76994711" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::import_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-import_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in import_form: 62</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a8e150e5f2551fa029d92c32d76994711">import_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    
    my $r = $self-&gt;r;
    my $authz = $r-&gt;authz;
    my $user = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);

<span class="preprocessor">    # this will make the popup menu alternate between a single selection and a multiple selection menu</span>
<span class="preprocessor"></span><span class="preprocessor">    # Note: search by name is required since document.problemsetlist.action.import.number is not seen as</span>
<span class="preprocessor"></span><span class="preprocessor">    # a valid reference to the object named &#39;action.import.number&#39;</span>
<span class="preprocessor"></span>    my $importScript = join (<span class="stringliteral">&quot; &quot;</span>,
                <span class="stringliteral">&quot;var number = document.getElementsByName(&#39;action.import.number&#39;)[0].value;&quot;</span>,
                <span class="stringliteral">&quot;document.getElementsByName(&#39;action.import.source&#39;)[0].size = number;&quot;</span>,
                <span class="stringliteral">&quot;document.getElementsByName(&#39;action.import.source&#39;)[0].multiple = (number &gt; 1 ? true : false);&quot;</span>,
                <span class="stringliteral">&quot;document.getElementsByName(&#39;action.import.name&#39;)[0].value = (number &gt; 1 ? &#39;(taken from filenames)&#39; : &#39;&#39;);&quot;</span>,
            );
    
    <span class="keywordflow">return</span> join(<span class="stringliteral">&quot; &quot;</span>,
        <span class="stringliteral">&quot;Import &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.import.number&quot;</span>,
            -values =&gt; [ 1, 8 ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.import.number&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;1&quot;</span>,
            -labels =&gt; {
                1 =&gt; <span class="stringliteral">&quot;a single set&quot;</span>,
                8 =&gt; <span class="stringliteral">&quot;multiple sets&quot;</span>,
            },
            -onchange =&gt; <span class="stringliteral">&quot;$onChange;$importScript&quot;</span>,
        ),
        <span class="stringliteral">&quot; from &quot;</span>, # <span class="keyword">set</span> definition file(s) <span class="stringliteral">&quot;,</span>
<span class="stringliteral">        CGI::popup_menu(</span>
<span class="stringliteral">            -name =&gt; &quot;</span>action.import.source<span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -values =&gt; [ &quot;</span><span class="stringliteral">&quot;, $self-&gt;getDefList() ],</span>
<span class="stringliteral">            -labels =&gt; { &quot;</span><span class="stringliteral">&quot; =&gt; &quot;</span>the following file(s)<span class="stringliteral">&quot; },</span>
<span class="stringliteral">            -default =&gt; $actionParams{&quot;</span>action.import.source<span class="stringliteral">&quot;}-&gt;[0] || &quot;</span><span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -size =&gt; $actionParams{&quot;</span>action.import.number<span class="stringliteral">&quot;}-&gt;[0] || &quot;</span>1<span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -onchange =&gt; $onChange,</span>
<span class="stringliteral">        ),</span>
<span class="stringliteral">        &quot;</span> with <span class="keyword">set</span> name(s): <span class="stringliteral">&quot;,</span>
<span class="stringliteral">        CGI::textfield(</span>
<span class="stringliteral">            -name =&gt; &quot;</span>action.import.name<span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -value =&gt; $actionParams{&quot;</span>action.import.name<span class="stringliteral">&quot;}-&gt;[0] || &quot;</span><span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -width =&gt; &quot;</span>50<span class="stringliteral">&quot;,</span>
<span class="stringliteral">            -onchange =&gt; $onChange,</span>
<span class="stringliteral">        ),</span>
<span class="stringliteral">        ($authz-&gt;hasPermissions($user, &quot;</span>assign_problem_sets<span class="stringliteral">&quot;)) </span>
<span class="stringliteral">            ?</span>
<span class="stringliteral">            &quot;</span>assigning <span class="keyword">this</span> <span class="keyword">set</span> to <span class="stringliteral">&quot; .</span>
<span class="stringliteral">            CGI::popup_menu(</span>
<span class="stringliteral">                -name =&gt; &quot;</span>action.import.assign<span class="stringliteral">&quot;,</span>
<span class="stringliteral">                -value =&gt; [qw(user all)],</span>
<span class="stringliteral">                -default =&gt; $actionParams{&quot;</span>action.import.assign<span class="stringliteral">&quot;}-&gt;[0] || &quot;</span>user<span class="stringliteral">&quot;,</span>
<span class="stringliteral">                -labels =&gt; {</span>
<span class="stringliteral">                    all =&gt; &quot;</span>all current users.<span class="stringliteral">&quot;,</span>
<span class="stringliteral">                    user =&gt; &quot;</span>only $user.<span class="stringliteral">&quot;,</span>
<span class="stringliteral">                },</span>
<span class="stringliteral">                -onchange =&gt; $onChange,</span>
<span class="stringliteral">            )</span>
<span class="stringliteral">            :</span>
<span class="stringliteral">            &quot;</span><span class="stringliteral">&quot;  #user does not have permissions to assign problem sets</span>
<span class="stringliteral">    );</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a972b7cd7d244c78185a31b801a04c7f6"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::import_handler" ref="a972b7cd7d244c78185a31b801a04c7f6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::import_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-import_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in import_handler: 24</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a972b7cd7d244c78185a31b801a04c7f6">import_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my @fileNames = @{ $actionParams-&gt;{<span class="stringliteral">&quot;action.import.source&quot;</span>} };
    my $newSetName = $actionParams-&gt;{<span class="stringliteral">&quot;action.import.name&quot;</span>}-&gt;[0];
    $newSetName = <span class="stringliteral">&quot;&quot;</span> <span class="keywordflow">if</span> $actionParams-&gt;{<span class="stringliteral">&quot;action.import.number&quot;</span>}-&gt;[0] &gt; 1; # cannot assign <span class="keyword">set</span> names to multiple imports
    my $assign = $actionParams-&gt;{<span class="stringliteral">&quot;action.import.assign&quot;</span>}-&gt;[0];
    
    my ($added, $skipped) = $self-&gt;importSetsFromDef($newSetName, $assign, @fileNames);

<span class="preprocessor">    # make new sets visible... do we really want to do this? probably.</span>
<span class="preprocessor"></span>    push @{ $self-&gt;{visibleSetIDs} }, @$added;
    push @{ $self-&gt;{allSetIDs} }, @$added;
    
    my $numAdded = @$added;
    my $numSkipped = @$skipped;

   <span class="keywordflow">return</span> CGI::div(
        {<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>}, 
        $numAdded . <span class="stringliteral">&quot; set&quot;</span> . ($numAdded == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; added, &quot;</span>
        . $numSkipped . <span class="stringliteral">&quot; set&quot;</span> . ($numSkipped == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; skipped&quot;</span>
        . <span class="stringliteral">&quot; (&quot;</span> . join (<span class="stringliteral">&quot;, &quot;</span>, @$skipped) . <span class="stringliteral">&quot;) &quot;</span>
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a803c05212b11e2d8e54b82213595153c"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::importSetsFromDef" ref="a803c05212b11e2d8e54b82213595153c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::importSetsFromDef </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-importSetsFromDef' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-importSetsFromDef-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-importSetsFromDef-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-importSetsFromDef-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in importSetsFromDef: 135</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a803c05212b11e2d8e54b82213595153c">importSetsFromDef</a> {
    my ($self, $newSetName, $assign, @setDefFiles) = @_;
    my $r     = $self-&gt;r;
    my $ce    = $r-&gt;ce;
    my $db    = $r-&gt;db;
    my $dir   = $ce-&gt;{courseDirs}-&gt;{templates};

<span class="preprocessor">    # if the user includes &quot;following files&quot; in a multiple selection</span>
<span class="preprocessor"></span><span class="preprocessor">    # it shows up here as &quot;&quot; which causes the importing to die</span>
<span class="preprocessor"></span><span class="preprocessor">    # so, we select on filenames containing non-whitespace</span>
<span class="preprocessor"></span>    @setDefFiles = grep(/\S/, @setDefFiles);

<span class="preprocessor">    # FIXME: do we really want everything to fail on one bad file name?</span>
<span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $fileName (@setDefFiles) {
        die <span class="stringliteral">&quot;won&#39;t be able to read from file $dir/$fileName: does it exist? is it readable?&quot;</span>
            unless -<a class="code" href="classWeBWorK_1_1ContentGenerator.html#afc1106db125a42082cafaf10746a947b">r</a> <span class="stringliteral">&quot;$dir/$fileName&quot;</span>;
    }

    my @allSetIDs = $db-&gt;listGlobalSets();
<span class="preprocessor">    # FIXME: getGlobalSets takes a lot of time just for checking to see if a set already exists</span>
<span class="preprocessor"></span><span class="preprocessor">    #   this could be avoided by waiting until the call to addGlobalSet below</span>
<span class="preprocessor"></span><span class="preprocessor">    #   and checking to see if the error message says that the set already exists</span>
<span class="preprocessor"></span><span class="preprocessor">    #   but if the error message is ever changed the code here might be broken</span>
<span class="preprocessor"></span><span class="preprocessor">    #   then again, one call to getGlobalSets and skipping unnecessary calls to addGlobalSet</span>
<span class="preprocessor"></span><span class="preprocessor">    #   could be faster than no call to getGlobalSets and lots of unnecessary calls to addGlobalSet</span>
<span class="preprocessor"></span><span class="preprocessor">    # DBFIXME all we need here is set IDs, right? why fetch entire records?</span>
<span class="preprocessor"></span>    my %allSets = map { $_-&gt;set_id =&gt; 1 <span class="keywordflow">if</span> $_} $db-&gt;getGlobalSets(@allSetIDs); # checked

    my (@added, @skipped);

    <span class="keywordflow">foreach</span> my $set_definition_file (@setDefFiles) {

        debug(<span class="stringliteral">&quot;$set_definition_file: reading set definition file&quot;</span>);
<span class="preprocessor">        # read data in set definition file</span>
<span class="preprocessor"></span>        my ($setName, $paperHeaderFile, $screenHeaderFile, $openDate, $dueDate, $answerDate, $ra_problemData, $assignmentType, $attemptsPerVersion, $timeInterval, $versionsPerInterval, $versionTimeLimit, $problemRandOrder, $problemsPerPage, $hideScore, $hideWork,$timeCap,$restrictIP,$restrictLoc,$relaxRestrictIP) = $self-&gt;readSetDef($set_definition_file);
        my @problemList = @{$ra_problemData};

<span class="preprocessor">        # Use the original name if form doesn&#39;t specify a new one.</span>
<span class="preprocessor"></span><span class="preprocessor">        # The set acquires the new name specified by the form.  A blank</span>
<span class="preprocessor"></span><span class="preprocessor">        # entry on the form indicates that the imported set name will be used.</span>
<span class="preprocessor"></span>        $setName = $newSetName <span class="keywordflow">if</span> $newSetName;

        <span class="keywordflow">if</span> ($allSets{$setName}) {
<span class="preprocessor">            # this set already exists!!</span>
<span class="preprocessor"></span>            push @skipped, $setName;
            next;
        } <span class="keywordflow">else</span> {
            push @added, $setName;
        }

        debug(<span class="stringliteral">&quot;$set_definition_file: adding set&quot;</span>);
<span class="preprocessor">        # add the data to the set record</span>
<span class="preprocessor"></span>        my $newSetRecord = $db-&gt;newGlobalSet;
        $newSetRecord-&gt;set_id($setName);
        $newSetRecord-&gt;set_header($screenHeaderFile);
        $newSetRecord-&gt;hardcopy_header($paperHeaderFile);
        $newSetRecord-&gt;open_date($openDate);
        $newSetRecord-&gt;due_date($dueDate);
        $newSetRecord-&gt;answer_date($answerDate);
        $newSetRecord-&gt;visible(DEFAULT_VISIBILITY_STATE);
        $newSetRecord-&gt;enable_reduced_scoring(DEFAULT_ENABLED_REDUCED_SCORING_STATE);

<span class="preprocessor">    # gateway/version data.  these should are all initialized to &#39;&#39;</span>
<span class="preprocessor"></span><span class="preprocessor">        #   by readSetDef, so for non-gateway/versioned sets they&#39;ll just </span>
<span class="preprocessor"></span><span class="preprocessor">        #   be stored as null</span>
<span class="preprocessor"></span>        $newSetRecord-&gt;assignment_type($assignmentType);
        $newSetRecord-&gt;attempts_per_version($attemptsPerVersion);
        $newSetRecord-&gt;time_interval($timeInterval);
        $newSetRecord-&gt;versions_per_interval($versionsPerInterval);
        $newSetRecord-&gt;version_time_limit($versionTimeLimit);
        $newSetRecord-&gt;problem_randorder($problemRandOrder);
        $newSetRecord-&gt;problems_per_page($problemsPerPage);
        $newSetRecord-&gt;hide_score($hideScore);
        $newSetRecord-&gt;hide_work($hideWork);
        $newSetRecord-&gt;time_limit_cap($timeCap);
        $newSetRecord-&gt;restrict_ip($restrictIP);
        $newSetRecord-&gt;relax_restrict_ip($relaxRestrictIP);

<span class="preprocessor">        #create the set</span>
<span class="preprocessor"></span>        eval {$db-&gt;addGlobalSet($newSetRecord)};
        die <span class="stringliteral">&quot;addGlobalSet $setName in ProblemSetList:  $@&quot;</span> <span class="keywordflow">if</span> $@;

<span class="preprocessor">        #do we need to add locations to the set_locations table?</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( $restrictIP ne <span class="stringliteral">&#39;No&#39;</span> &amp;&amp; $restrictLoc ) {
            <span class="keywordflow">if</span> ($db-&gt;existsLocation( $restrictLoc ) ) {
                <span class="keywordflow">if</span> ( ! $db-&gt;existsGlobalSetLocation($setName,$restrictLoc) ) {
                    my $newSetLocation = $db-&gt;newGlobalSetLocation;
                    $newSetLocation-&gt;set_id( $setName );
                    $newSetLocation-&gt;location_id( $restrictLoc );
                    eval {$db-&gt;addGlobalSetLocation($newSetLocation)};
                    warn(<span class="stringliteral">&quot;error adding set location $restrictLoc &quot;</span> .
                         <span class="stringliteral">&quot;for set $setName: $@&quot;</span>) if $@;
                } else {
<span class="preprocessor">                    # this should never happen.</span>
<span class="preprocessor"></span>                    warn(<span class="stringliteral">&quot;input set location $restrictLoc&quot;</span> .
                         <span class="stringliteral">&quot; already exists for set &quot;</span> . 
                         <span class="stringliteral">&quot;$setName.\n&quot;</span>);
                }
            } <span class="keywordflow">else</span> { 
                warn(<span class="stringliteral">&quot;restriction location $restrictLoc &quot;</span> .
                     <span class="stringliteral">&quot;does not exist.  IP restrictions have &quot;</span> .
                     <span class="stringliteral">&quot;been ignored.\n&quot;</span>);
                $newSetRecord-&gt;restrict_ip(<span class="stringliteral">&#39;No&#39;</span>);
                $newSetRecord-&gt;relax_restrict_ip(<span class="stringliteral">&#39;No&#39;</span>);
                eval { $db-&gt;putGlobalSet($newSetRecord) };
<span class="preprocessor">                # we ignore error messages here; if the set</span>
<span class="preprocessor"></span><span class="preprocessor">                #    added without error before, we assume </span>
<span class="preprocessor"></span><span class="preprocessor">                #    (ha) that it will put without trouble</span>
<span class="preprocessor"></span>            }
        }

        debug(<span class="stringliteral">&quot;$set_definition_file: adding problems to database&quot;</span>);
<span class="preprocessor">        # add problems</span>
<span class="preprocessor"></span>        my $freeProblemID = <a class="code" href="classWeBWorK_1_1Utils.html#a3d364a4d0cb81eef75c34845afb179e3">WeBWorK::Utils::max</a>($db-&gt;listGlobalProblems($setName)) + 1;
        <span class="keywordflow">foreach</span> my $rh_problem (@problemList) {
            $self-&gt;addProblemToSet(
              setName =&gt; $setName,
              sourceFile =&gt; $rh_problem-&gt;{source_file},
              problemID =&gt; $freeProblemID++,
              value =&gt; $rh_problem-&gt;{value},
              maxAttempts =&gt; $rh_problem-&gt;{max_attempts});
        }


        <span class="keywordflow">if</span> ($assign eq <span class="stringliteral">&quot;all&quot;</span>) {
            $self-&gt;assignSetToAllUsers($setName);
        }
        <span class="keywordflow">else</span> {
            my $userName = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
            $self-&gt;assignSetToUser($userName, $newSetRecord); ## always assign <span class="keyword">set</span> to instructor
        }
    }

    <span class="keywordflow">return</span> \@added, \@skipped;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae51e454d30b9a1ab91fe52f2b80d3c0b"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::initialize" ref="ae51e454d30b9a1ab91fe52f2b80d3c0b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in initialize: 116</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ae51e454d30b9a1ab91fe52f2b80d3c0b">initialize</a> {

    my ($self)       = @_;
    my $r            = $self-&gt;r;
    my $urlpath      = $r-&gt;urlpath;
    my $db           = $r-&gt;db;
    my $ce           = $r-&gt;ce;
    my $authz        = $r-&gt;authz;   
    my $courseName   = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setID        = $urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);       
    my $user         = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    

    my $root = $ce-&gt;{webworkURLs}-&gt;{root};

<span class="preprocessor">    # templates for getting field names</span>
<span class="preprocessor"></span>    my $setTemplate = $self-&gt;{setTemplate} = $db-&gt;newGlobalSet;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class </span>=&gt; &quot;ResultsWithError&quot;}, &quot;You are not authorized to access the Instructor tools.&quot;)
        unless $authz-&gt;hasPermissions($user, &quot;access_instructor_tools&quot;);
    
<span class="preprocessor">    ########## set initial values for state fields</span>
<span class="preprocessor"></span>    
    my @allSetIDs = $db-&gt;listGlobalSets;
<span class="preprocessor">    # DBFIXME count would suffice here :P</span>
<span class="preprocessor"></span>    my @users = $db-&gt;listUsers;
    $self-&gt;{allSetIDs} = \@allSetIDs;
    $self-&gt;{totalUsers} = scalar @users;
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;visible_sets&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [];
    } <span class="keywordflow">else</span> {
        <span class="keywordflow">if</span> (@allSetIDs &gt; HIDE_SETS_THRESHOLD) {
            $self-&gt;{visibleSetIDs} = [];
        } <span class="keywordflow">else</span> {
            $self-&gt;{visibleSetIDs} = [ @allSetIDs ];
        }
    }
    
    $self-&gt;{prevVisibleSetIDs} = $self-&gt;{visibleSetIDs};
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;selected_sets&quot;</span>)) {
        $self-&gt;{selectedSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;selected_sets&quot;</span>) ];
    } <span class="keywordflow">else</span> {
        $self-&gt;{selectedSetIDs} = [];
    }
    
    $self-&gt;{editMode} = $r-&gt;param(<span class="stringliteral">&quot;editMode&quot;</span>) || 0;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to modify homework sets.&quot;</span>))
        <span class="keywordflow">if</span> $self-&gt;{editMode} and not $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;modify_problem_sets&quot;</span>);
    
    $self-&gt;{exportMode} = $r-&gt;param(<span class="stringliteral">&quot;exportMode&quot;</span>) || 0;

    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to modify set definition files.&quot;</span>))
        <span class="keywordflow">if</span> $self-&gt;{exportMode} and not $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;modify_set_def_files&quot;</span>);
    
    $self-&gt;{primarySortField} = $r-&gt;param(<span class="stringliteral">&quot;primarySortField&quot;</span>) || <span class="stringliteral">&quot;due_date&quot;</span>;
    $self-&gt;{secondarySortField} = $r-&gt;param(<span class="stringliteral">&quot;secondarySortField&quot;</span>) || <span class="stringliteral">&quot;open_date&quot;</span>;
    
    
<span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # collect date information from sets</span>
<span class="preprocessor"></span><span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span>
    my @allSets = $db-&gt;getGlobalSets(@allSetIDs);

    my (%open_dates, %due_dates, %answer_dates);
    <span class="keywordflow">foreach</span> my $Set (@allSets) {
        push @{$open_dates{defined $Set-&gt;open_date ? $Set-&gt;open_date : <span class="stringliteral">&quot;&quot;</span>}}, $Set-&gt;set_id;
        push @{$due_dates{defined $Set-&gt;due_date ? $Set-&gt;due_date : <span class="stringliteral">&quot;&quot;</span>}}, $Set-&gt;set_id;
        push @{$answer_dates{defined $Set-&gt;answer_date ? $Set-&gt;answer_date : <span class="stringliteral">&quot;&quot;</span>}}, $Set-&gt;set_id;
    }
    $self-&gt;{open_dates} = \%open_dates;
    $self-&gt;{due_dates} = \%due_dates;
    $self-&gt;{answer_dates} = \%answer_dates;
    
<span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span><span class="preprocessor">    #  call action handler  </span>
<span class="preprocessor"></span><span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span>    
    my $actionID = $r-&gt;param(<span class="stringliteral">&quot;action&quot;</span>);
    $self-&gt;{actionID} = $actionID;
    <span class="keywordflow">if</span> ($actionID) {
        unless (grep { $_ eq $actionID } @{ VIEW_FORMS() }, @{ EDIT_FORMS() }, @{ EXPORT_FORMS() }) {
            die <span class="stringliteral">&quot;Action $actionID not found&quot;</span>;
        }
<span class="preprocessor">        # Check permissions</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (not FORM_PERMS()-&gt;{$actionID} or $authz-&gt;hasPermissions($user, FORM_PERMS()-&gt;{$actionID})) {
            my $actionHandler = <span class="stringliteral">&quot;${actionID}_handler&quot;</span>;
            my %genericParams;
            <span class="keywordflow">foreach</span> my $param (qw(selected_sets)) {
                $genericParams{$param} = [ $r-&gt;param($param) ];
            }
            my %actionParams = $self-&gt;getActionParams($actionID);
            my %tableParams = $self-&gt;getTableParams();
            $self-&gt;addmessage( CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;Message&quot;</span>}, <span class="stringliteral">&quot;Results of last action performed: &quot;</span>));
            $self-&gt;addmessage(
                                 $self-&gt;$actionHandler(\%genericParams, \%actionParams, \%tableParams), 
                                 CGI::hr()
            );
        } <span class="keywordflow">else</span> {
            <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, CGI::p(<span class="stringliteral">&quot;You are not authorized to perform this action.&quot;</span>));
        }
        
        

    } <span class="keywordflow">else</span> {
    
        $self-&gt;addgoodmessage(<span class="stringliteral">&quot;Please select action to be performed.&quot;</span>);
    }
        

}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3d4ef4d8f675914be822ced8098ba577"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::menuLabels" ref="a3d4ef4d8f675914be822ced8098ba577" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::menuLabels </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-menuLabels' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-menuLabels-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-menuLabels-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-menuLabels-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in menuLabels: 12</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3d4ef4d8f675914be822ced8098ba577">menuLabels</a> {
    my ($self, $hashRef) = @_;
    my %hash = %$hashRef;
    
    my %result;
    <span class="keywordflow">foreach</span> my $key (keys %hash) {
        my $count = @{ $hash{$key} };
        my $displayKey = $self-&gt;formatDateTime($key) || <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>;
        $result{$key} = <span class="stringliteral">&quot;$displayKey ($count sets)&quot;</span>;
    }
    <span class="keywordflow">return</span> %result;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a0b1829cdcaa8abdc9cb074ebb4baad19"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::pre_header_initialize" ref="a0b1829cdcaa8abdc9cb074ebb4baad19" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::pre_header_initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-pre_header_initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-pre_header_initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-pre_header_initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-pre_header_initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in pre_header_initialize: 40</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a0b1829cdcaa8abdc9cb074ebb4baad19">pre_header_initialize</a> {
    my ($self) = @_;
    my $r      = $self-&gt;r;
    my $db     = $r-&gt;db;
    my $ce     = $r-&gt;ce;
    my $authz  = $r-&gt;authz;
    my $urlpath = $r-&gt;urlpath;
    my $user   = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $courseName = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);


<span class="preprocessor">    # Check permissions</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> unless $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;access_instructor_tools&quot;</span>);
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;action&quot;</span>) and $r-&gt;param(<span class="stringliteral">&quot;action&quot;</span>) eq <span class="stringliteral">&quot;score&quot;</span> and $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;score_sets&quot;</span>)) {
        my $scope = $r-&gt;param(<span class="stringliteral">&quot;action.score.scope&quot;</span>);
        my @setsToScore = ();
    
        <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;none&quot;</span>) { 
            <span class="keywordflow">return</span> <span class="stringliteral">&quot;No sets selected for scoring.&quot;</span>;
        } elsif ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
            @setsToScore = @{ $r-&gt;param(<span class="stringliteral">&quot;allSetIDs&quot;</span>) };
        } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
            @setsToScore = @{ $r-&gt;param(<span class="stringliteral">&quot;visibleSetIDs&quot;</span>) };
        } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
            @setsToScore = $r-&gt;param(<span class="stringliteral">&quot;selected_sets&quot;</span>);
        }

        my $uri = $self-&gt;systemLink( $urlpath-&gt;newFromModule(<span class="stringliteral">&#39;WeBWorK::ContentGenerator::Instructor::Scoring&#39;</span>, $r, courseID=&gt;$courseName),
                        params=&gt;{
                            scoreSelected=&gt;<span class="stringliteral">&quot;ScoreSelected&quot;</span>,
                            selectedSet=&gt;\@setsToScore,
<span class="preprocessor">#                           recordSingleSetScores=&gt;&#39;&#39;</span>
<span class="preprocessor"></span>                        }
        );

        $self-&gt;reply_with_redirect($uri);
    }

}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aa9aa6ef3caa8b9bd1dcc855479b0a7ef"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::printTableHTML" ref="aa9aa6ef3caa8b9bd1dcc855479b0a7ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::printTableHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-printTableHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-printTableHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-printTableHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-printTableHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in printTableHTML: 86</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa9aa6ef3caa8b9bd1dcc855479b0a7ef">printTableHTML</a> {
    my ($self, $SetsRef, $fieldNamesRef, %options) = @_;
    my $r                       = $self-&gt;r;
    my $authz                   = $r-&gt;authz;
    my $user                    = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $setTemplate             = $self-&gt;{setTemplate};
    my @Sets                    = @$SetsRef;
    my %fieldNames              = %$fieldNamesRef;
    
    my $editMode                = $options{editMode};
    my $exportMode              = $options{exportMode};
    my %selectedSetIDs          = map { $_ =&gt; 1 } @{ $options{selectedSetIDs} };
    my $currentSort             = $options{currentSort};
    
<span class="preprocessor">    # names of headings:</span>
<span class="preprocessor"></span>    my @realFieldNames = (
            $setTemplate-&gt;KEYFIELDS,
            $setTemplate-&gt;NONKEYFIELDS,
    );

    <span class="keywordflow">if</span> ($editMode) {
        @realFieldNames = @{ EDIT_FIELD_ORDER() };
    } <span class="keywordflow">else</span> {
        @realFieldNames = @{ VIEW_FIELD_ORDER() };
    }
    
    <span class="keywordflow">if</span> ($exportMode) {
        @realFieldNames = @{ EXPORT_FIELD_ORDER() };
    }

    
    my %sortSubs = %{ SORT_SUBS() };

<span class="preprocessor">    # FIXME: should this always presume to use the templates directory?</span>
<span class="preprocessor"></span><span class="preprocessor">    # (no, but that can wait until we have an abstract ProblemLibrary API -- sam)</span>
<span class="preprocessor"></span>    my $templates_dir = $r-&gt;ce-&gt;{courseDirs}-&gt;{templates};
    my $exempt_dirs = join <span class="stringliteral">&quot;|&quot;</span>, keys %{ $r-&gt;ce-&gt;{courseFiles}-&gt;{problibs} };
    my @headers = listFilesRecursive(
        $templates_dir,
        qr/<a class="code" href="classWeBWorK_1_1ContentGenerator.html#ad1905f1621af61ea10def7aae24b7b8b">header</a>.*\.pg$/i, # match these files
        qr/^(?:$exempt_dirs|CVS)$/, # prune these directories
        0, # match against file name only
        1, # prune against path relative to $templates_dir
    );
    
    @headers = sort @headers;
    my %headers = map { $_ =&gt; $_ } @headers;
    $headers{<span class="stringliteral">&quot;&quot;</span>} = <span class="stringliteral">&quot;Use System Default&quot;</span>;
    $self-&gt;{headerFiles} = \%headers;   # store these <a class="code" href="classWeBWorK_1_1ContentGenerator.html#ad1905f1621af61ea10def7aae24b7b8b">header</a> files so we don<span class="stringliteral">&#39;t have to look for them later.</span>
<span class="stringliteral"></span>
<span class="stringliteral"></span>
<span class="stringliteral">    my @tableHeadings = map { $fieldNames{$_} } @realFieldNames;</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    # prepend selection checkbox? only if we&#39;</span>re NOT editing!
<span class="preprocessor">#   unshift @tableHeadings, &quot;Select&quot;, &quot;Set&quot;, &quot;Problems&quot; unless $editMode;</span>
<span class="preprocessor"></span>
<span class="preprocessor">    # print the table</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode or $exportMode) {
        print CGI::start_table({});
    } <span class="keywordflow">else</span> {
        print CGI::start_table({-border=&gt;1});
    }
    
    print CGI::Tr({}, CGI::th({}, \@tableHeadings));
    

    <span class="keywordflow">for</span> (my $i = 0; $i &lt; @Sets; $i++) {
        my $Set = $Sets[$i];
        
        print $self-&gt;recordEditHTML($Set,
            editMode =&gt; $editMode,
            exportMode =&gt; $exportMode,
            setSelected =&gt; exists $selectedSetIDs{$Set-&gt;set_id}
        );
    }
    
    print CGI::end_table();
<span class="preprocessor">    #########################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # if there are no users shown print message</span>
<span class="preprocessor"></span><span class="preprocessor">    # </span>
<span class="preprocessor"></span><span class="preprocessor">    ##########################################</span>
<span class="preprocessor"></span>    
    print CGI::p(
                      CGI::i(<span class="stringliteral">&quot;No sets shown.  Choose one of the options above to list the sets in the course.&quot;</span>)
    ) unless @Sets;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ab24e8a0a4eb58bb79ebf301876c810ba"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::publish_form" ref="ab24e8a0a4eb58bb79ebf301876c810ba" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::publish_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-publish_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-publish_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-publish_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-publish_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in publish_form: 30</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ab24e8a0a4eb58bb79ebf301876c810ba">publish_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Make &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.publish.scope&quot;</span>,
            -values =&gt; [ qw(none all selected) ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.publish.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;selected&quot;</span>,
            -labels =&gt; {
                none =&gt; <span class="stringliteral">&quot;&quot;</span>,
                all =&gt; <span class="stringliteral">&quot;all sets&quot;</span>,
<span class="preprocessor">#               visible =&gt; &quot;visible sets&quot;,</span>
<span class="preprocessor"></span>                selected =&gt; <span class="stringliteral">&quot;selected sets&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.publish.value&quot;</span>,
            -values =&gt; [ 0, 1 ],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.publish.value&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;1&quot;</span>,
            -labels =&gt; {
                0 =&gt; <span class="stringliteral">&quot;hidden&quot;</span>,
                1 =&gt; <span class="stringliteral">&quot;visible&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot; for students.&quot;</span>,
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a285d95ae64918c3a4adc9cd37048d883"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::publish_handler" ref="a285d95ae64918c3a4adc9cd37048d883" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::publish_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-publish_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-publish_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-publish_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-publish_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in publish_handler: 37</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a285d95ae64918c3a4adc9cd37048d883">publish_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $r = $self-&gt;r;
    my $db = $r-&gt;db;

    my $result = <span class="stringliteral">&quot;&quot;</span>;
    
    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.publish.scope&quot;</span>}-&gt;[0];
    my $value = $actionParams-&gt;{<span class="stringliteral">&quot;action.publish.value&quot;</span>}-&gt;[0];

    my $verb = $value ? <span class="stringliteral">&quot;made visible for&quot;</span> : <span class="stringliteral">&quot;hidden from&quot;</span>;
    
    my @setIDs;
    
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;none&quot;</span>) { # FIXME: <span class="keywordtype">double</span> negative <span class="stringliteral">&quot;Make no sets hidden&quot;</span> might make professor expect all sets to be made visible.
        @setIDs = ();
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>},<span class="stringliteral">&quot;No change made to any set.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        @setIDs = @{ $self-&gt;{allSetIDs} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;All sets $verb all students.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        @setIDs = @{ $self-&gt;{visibleSetIDs} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;All visible sets $verb all students.&quot;</span>);
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @setIDs = @{ $genericParams-&gt;{selected_sets} };
        $result = CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithoutError&quot;</span>},<span class="stringliteral">&quot;All selected sets $verb all students.&quot;</span>);
    }
    
<span class="preprocessor">    # can we use UPDATE here, instead of fetch/change/store?</span>
<span class="preprocessor"></span>    my @sets = $db-&gt;getGlobalSets(@setIDs);
    
    map { $_-&gt;visible(<span class="stringliteral">&quot;$value&quot;</span>) <span class="keywordflow">if</span> $_; $db-&gt;putGlobalSet($_); } @sets;
    
    <span class="keywordflow">return</span> $result
    
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="af4395b239779296f9b33509d6d683d89"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::readSetDef" ref="af4395b239779296f9b33509d6d683d89" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::readSetDef </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-readSetDef' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-readSetDef-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-readSetDef-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-readSetDef-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in readSetDef: 229</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#af4395b239779296f9b33509d6d683d89">readSetDef</a> {
    my ($self, $fileName) = @_;
    my $templateDir   = $self-&gt;{ce}-&gt;{courseDirs}-&gt;{templates};
    my $filePath      = <span class="stringliteral">&quot;$templateDir/$fileName&quot;</span>;
    my $value_default = $self-&gt;{ce}-&gt;{problemDefaults}-&gt;{value};
    my $max_attempts_default = $self-&gt;{ce}-&gt;{problemDefaults}-&gt;{max_attempts};

    my $setName = <span class="stringliteral">&#39;&#39;</span>;

    <span class="keywordflow">if</span> ($fileName =~ m|^<span class="keyword">set</span>([.\w-]+)\.def$|) {
        $setName = $1;
    } <span class="keywordflow">else</span> {
        $self-&gt;addbadmessage( 
            qq{The setDefinition file name must begin with   &lt;CODE&gt;<span class="keyword">set</span>&lt;/CODE&gt;},
            qq{and must end with   &lt;CODE&gt;.def&lt;/CODE&gt;  . Every thing in between becomes the name of the <span class="keyword">set</span>. },
            qq{For example &lt;CODE&gt;set1.def&lt;/CODE&gt;, &lt;CODE&gt;setExam.def&lt;/CODE&gt;, and &lt;CODE&gt;setsample7.def&lt;/CODE&gt; },
            qq{define sets named &lt;CODE&gt;1&lt;/CODE&gt;, &lt;CODE&gt;Exam&lt;/CODE&gt;, and &lt;CODE&gt;sample7&lt;/CODE&gt; respectively. },
            qq{The filename, $fileName, you entered is not legal\n } 
        );

    }

    my ($line, $name, $value, $attemptLimit, $continueFlag);
    my $paperHeaderFile = <span class="stringliteral">&#39;&#39;</span>;
    my $screenHeaderFile = <span class="stringliteral">&#39;&#39;</span>;
    my ($dueDate, $openDate, $answerDate);
    my @problemData;    

<span class="preprocessor"># added fields for gateway test/versioned set definitions:</span>
<span class="preprocessor"></span>    my ( $assignmentType, $attemptsPerVersion, $timeInterval, 
         $versionsPerInterval, $versionTimeLimit, $problemRandOrder,
         $problemsPerPage, $restrictLoc,
         ) = 
         (<span class="stringliteral">&#39;&#39;</span>)x8;  # <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#ae51e454d30b9a1ab91fe52f2b80d3c0b">initialize</a> these to <span class="stringliteral">&#39;&#39;</span>
    my ( $timeCap, $restrictIP, $relaxRestrictIP ) = ( 0, <span class="stringliteral">&#39;No&#39;</span>, <span class="stringliteral">&#39;No&#39;</span>);
<span class="preprocessor"># additional fields currently used only by gateways; later, the world?</span>
<span class="preprocessor"></span>    my ( $hideScore, $hideWork, ) = ( <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;N&#39;</span> );

    my %setInfo;
    <span class="keywordflow">if</span> ( open (SETFILENAME, <span class="stringliteral">&quot;$filePath&quot;</span>) )    {
<span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # Read and check set data</span>
<span class="preprocessor"></span><span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span>        <span class="keywordflow">while</span> (&lt;SETFILENAME&gt;) {
        
            chomp($line = $_);
            $line =~ s|(#.*)||;                              ## don<span class="stringliteral">&#39;t read past comments</span>
<span class="stringliteral">            unless ($line =~ /\S/) {next;}                   ## skip blank lines</span>
<span class="stringliteral">            $line =~ s|\s*$||;                               ## trim trailing spaces</span>
<span class="stringliteral">            $line =~ m|^\s*(\w+)\s*=\s*(.*)|;</span>
<span class="stringliteral">            </span>
<span class="stringliteral">            ######################</span>
<span class="stringliteral">            # sanity check entries</span>
<span class="stringliteral">            ######################</span>
<span class="stringliteral">            my $item = $1;</span>
<span class="stringliteral">            $item    = &#39;</span><span class="stringliteral">&#39; unless defined $item;</span>
<span class="stringliteral">            my $value = $2;</span>
<span class="stringliteral">            $value    = &#39;</span><span class="stringliteral">&#39; unless defined $value;</span>
<span class="stringliteral">            </span>
<span class="stringliteral">            if ($item eq &#39;</span>setNumber<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                next;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>paperHeaderFile<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $paperHeaderFile = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>screenHeaderFile<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $screenHeaderFile = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>dueDate<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $dueDate = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>openDate<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $openDate = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>answerDate<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $answerDate = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>assignmentType<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $assignmentType = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>attemptsPerVersion<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $attemptsPerVersion = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>timeInterval<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $timeInterval = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>versionsPerInterval<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $versionsPerInterval = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>versionTimeLimit<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $versionTimeLimit = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>problemRandOrder<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $problemRandOrder = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>problemsPerPage<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $problemsPerPage = $value;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>hideScore<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $hideScore = ( $value ) ? $value : &#39;</span>N<span class="stringliteral">&#39;;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>hideWork<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $hideWork = ( $value ) ? $value : &#39;</span>N<span class="stringliteral">&#39;;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>capTimeLimit<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $timeCap = ( $value ) ? 1 : 0;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>restrictIP<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                $restrictIP = ( $value ) ? $value : &#39;</span>No<span class="stringliteral">&#39;;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>restrictLocation<span class="stringliteral">&#39; ) { </span>
<span class="stringliteral">                $restrictLoc = ( $value ) ? $value : &#39;</span><span class="stringliteral">&#39;;</span>
<span class="stringliteral">            } elsif ( $item eq &#39;</span>relaxRestrictIP<span class="stringliteral">&#39; ) {</span>
<span class="stringliteral">                $relaxRestrictIP = ( $value ) ? $value : &#39;</span>No<span class="stringliteral">&#39;;</span>
<span class="stringliteral">            } elsif ($item eq &#39;</span>problemList<span class="stringliteral">&#39;) {</span>
<span class="stringliteral">                last;</span>
<span class="stringliteral">            } else {</span>
<span class="stringliteral">                warn &quot;readSetDef error, can&#39;</span>t read the line: ||$line||<span class="stringliteral">&quot;;</span>
<span class="stringliteral">            }</span>
<span class="stringliteral">        }</span>
<span class="stringliteral"></span>
<span class="stringliteral">        #####################################################################</span>
<span class="stringliteral">        # Check and format dates</span>
<span class="stringliteral">        #####################################################################</span>
<span class="stringliteral">        my ($time1, $time2, $time3) = map {  $self-&gt;parseDateTime($_);  }    ($openDate, $dueDate, $answerDate);</span>
<span class="stringliteral">    </span>
<span class="stringliteral">        unless ($time1 &lt;= $time2 and $time2 &lt;= $time3) {</span>
<span class="stringliteral">            warn &quot;</span>The open date: $openDate, due date: $dueDate, and answer date: $answerDate must be defined and in chronological order.<span class="stringliteral">&quot;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral"></span>
<span class="stringliteral">        # Check header file names</span>
<span class="stringliteral">        $paperHeaderFile =~ s/(.*?)\s*$/$1/;   #remove trailing white space</span>
<span class="stringliteral">        $screenHeaderFile =~ s/(.*?)\s*$/$1/;   #remove trailing white space</span>
<span class="stringliteral">    </span>
<span class="stringliteral">                #####################################################################</span>
<span class="stringliteral">                # Gateway/version variable cleanup: convert times into seconds</span>
<span class="stringliteral">        $timeInterval = WeBWorK::Utils::timeToSec( $timeInterval )</span>
<span class="stringliteral">            if ( $timeInterval );</span>
<span class="stringliteral">        $versionTimeLimit = WeBWorK::Utils::timeToSec($versionTimeLimit)</span>
<span class="stringliteral">            if ( $versionTimeLimit );</span>
<span class="stringliteral"></span>
<span class="stringliteral">        # check that the values for hideWork and hideScore are valid</span>
<span class="stringliteral">        if ( $hideScore ne &#39;N&#39; &amp;&amp; $hideScore ne &#39;Y&#39; &amp;&amp; </span>
<span class="stringliteral">             $hideScore ne &#39;BeforeAnswerDate&#39; ) {</span>
<span class="stringliteral">            warn(&quot;</span>The value $hideScore <span class="keywordflow">for</span> the hideScore option <span class="stringliteral">&quot; .</span>
<span class="stringliteral">                 &quot;</span>is not valid; it will be replaced with <span class="charliteral">&#39;N&#39;</span>.\n<span class="stringliteral">&quot;);</span>
<span class="stringliteral">            $hideScore = &#39;N&#39;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        if ( $hideWork ne &#39;N&#39; &amp;&amp; $hideWork ne &#39;Y&#39; &amp;&amp; </span>
<span class="stringliteral">             $hideWork ne &#39;BeforeAnswerDate&#39; ) {</span>
<span class="stringliteral">            warn(&quot;</span>The value $hideWork <span class="keywordflow">for</span> the hideWork option <span class="stringliteral">&quot; .</span>
<span class="stringliteral">                 &quot;</span>is not valid; it will be replaced with <span class="charliteral">&#39;N&#39;</span>.\n<span class="stringliteral">&quot;);</span>
<span class="stringliteral">            $hideWork = &#39;N&#39;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        if ( $timeCap ne &#39;0&#39; &amp;&amp; $timeCap ne &#39;1&#39; ) {</span>
<span class="stringliteral">            warn(&quot;</span>The value $timeCap <span class="keywordflow">for</span> the capTimeLimit option <span class="stringliteral">&quot; .</span>
<span class="stringliteral">                 &quot;</span>is not valid; it will be replaced with <span class="charliteral">&#39;0&#39;</span>.\n<span class="stringliteral">&quot;);</span>
<span class="stringliteral">            $timeCap = &#39;0&#39;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        if ( $restrictIP ne &#39;No&#39; &amp;&amp; $restrictIP ne &#39;DenyFrom&#39; &amp;&amp;</span>
<span class="stringliteral">             $restrictIP ne &#39;RestrictTo&#39; ) {</span>
<span class="stringliteral">            warn(&quot;</span>The value $restrictIP <span class="keywordflow">for</span> the restrictIP <span class="stringliteral">&quot; .</span>
<span class="stringliteral">                 &quot;</span>option is not valid; it will be replaced <span class="stringliteral">&quot; . </span>
<span class="stringliteral">                 &quot;</span>with <span class="stringliteral">&#39;No&#39;</span>.\n<span class="stringliteral">&quot;);</span>
<span class="stringliteral">            $restrictIP = &#39;No&#39;;</span>
<span class="stringliteral">            $restrictLoc = &#39;&#39;;</span>
<span class="stringliteral">            $relaxRestrictIP = &#39;No&#39;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        if ( $relaxRestrictIP ne &#39;No&#39; &amp;&amp; </span>
<span class="stringliteral">             $relaxRestrictIP ne &#39;AfterAnswerDate&#39; &amp;&amp;</span>
<span class="stringliteral">             $relaxRestrictIP ne &#39;AfterVersionAnswerDate&#39; ) {</span>
<span class="stringliteral">            warn(&quot;</span>The value $relaxRestrictIP <span class="keywordflow">for</span> the <span class="stringliteral">&quot; .</span>
<span class="stringliteral">                 &quot;</span>relaxRestrictIP option is not valid; it will <span class="stringliteral">&quot; . </span>
<span class="stringliteral">                 &quot;</span>be replaced with <span class="stringliteral">&#39;No&#39;</span>.\n<span class="stringliteral">&quot;);</span>
<span class="stringliteral">            $relaxRestrictIP = &#39;No&#39;;</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        # to verify that restrictLoc is valid requires a database</span>
<span class="stringliteral">        #    call, so we defer that until we return to add the set</span>
<span class="stringliteral">        </span>
<span class="stringliteral">        #####################################################################</span>
<span class="stringliteral">        # Read and check list of problems for the set</span>
<span class="stringliteral">        #####################################################################</span>
<span class="stringliteral">        while(&lt;SETFILENAME&gt;) {</span>
<span class="stringliteral">            chomp($line=$_);</span>
<span class="stringliteral">            $line =~ s/(#.*)//;                             ## don&#39;t read past comments</span>
<span class="stringliteral">            unless ($line =~ /\S/) {next;}                  ## skip blank lines</span>
<span class="stringliteral">    </span>
<span class="stringliteral">            # commas are valid in filenames, so we have to handle commas</span>
<span class="stringliteral">            # using backslash escaping, so \X will be replaced with X</span>
<span class="stringliteral">            my @line = ();</span>
<span class="stringliteral">            my $curr = &#39;&#39;;</span>
<span class="stringliteral">            for (my $i = 0; $i &lt; length $line; $i++) {</span>
<span class="stringliteral">                my $c = substr($line,$i,1);</span>
<span class="stringliteral">                if ($c eq &#39;\\&#39;) {</span>
<span class="stringliteral">                    $curr .= substr($line,++$i,1);</span>
<span class="stringliteral">                } elsif ($c eq &#39;,&#39;) {</span>
<span class="stringliteral">                    push @line, $curr;</span>
<span class="stringliteral">                    $curr = &#39;&#39;;</span>
<span class="stringliteral">                } else {</span>
<span class="stringliteral">                    $curr .= $c;</span>
<span class="stringliteral">                }</span>
<span class="stringliteral">            }</span>
<span class="stringliteral">            ## anything left?</span>
<span class="stringliteral">            push(@line, $curr) if ( $curr );</span>
<span class="stringliteral">            </span>
<span class="stringliteral">            ($name, $value, $attemptLimit, $continueFlag) = @line;</span>
<span class="stringliteral">            #####################</span>
<span class="stringliteral">            #  clean up problem values</span>
<span class="stringliteral">            ###########################</span>
<span class="stringliteral">            $name =~ s/\s*//g;</span>
<span class="stringliteral">            $value = &quot;</span><span class="stringliteral">&quot; unless defined($value);</span>
<span class="stringliteral">            $value =~ s/[^\d\.]*//g;</span>
<span class="stringliteral">            unless ($value =~ /\d+/) {$value = $value_default;}</span>
<span class="stringliteral">            $attemptLimit = &quot;</span><span class="stringliteral">&quot; unless defined($attemptLimit);</span>
<span class="stringliteral">            $attemptLimit =~ s/[^\d-]*//g;</span>
<span class="stringliteral">            unless ($attemptLimit =~ /\d+/) {$attemptLimit = $max_attempts_default;}</span>
<span class="stringliteral">            $continueFlag = &quot;</span>0<span class="stringliteral">&quot; unless( defined($continueFlag) &amp;&amp; @problemData );  </span>
<span class="stringliteral">            # can&#39;t put continuation flag onto the first problem</span>
<span class="stringliteral">            push(@problemData, {source_file    =&gt; $name,</span>
<span class="stringliteral">                                value          =&gt;  $value,</span>
<span class="stringliteral">                                max_attempts   =&gt;, $attemptLimit,</span>
<span class="stringliteral">                                continuation   =&gt; $continueFlag </span>
<span class="stringliteral">                                });</span>
<span class="stringliteral">        }</span>
<span class="stringliteral">        close(SETFILENAME);</span>
<span class="stringliteral">        ($setName,</span>
<span class="stringliteral">         $paperHeaderFile,</span>
<span class="stringliteral">         $screenHeaderFile,</span>
<span class="stringliteral">         $time1,</span>
<span class="stringliteral">         $time2,</span>
<span class="stringliteral">         $time3,</span>
<span class="stringliteral">         \@problemData,</span>
<span class="stringliteral">         $assignmentType, $attemptsPerVersion, $timeInterval, </span>
<span class="stringliteral">         $versionsPerInterval, $versionTimeLimit, $problemRandOrder,</span>
<span class="stringliteral">         $problemsPerPage, </span>
<span class="stringliteral">         $hideScore,</span>
<span class="stringliteral">         $hideWork,</span>
<span class="stringliteral">         $timeCap,</span>
<span class="stringliteral">         $restrictIP,</span>
<span class="stringliteral">         $restrictLoc,</span>
<span class="stringliteral">         $relaxRestrictIP,</span>
<span class="stringliteral">        );</span>
<span class="stringliteral">    } else {</span>
<span class="stringliteral">        warn &quot;</span>Can<span class="stringliteral">&#39;t open file $filePath\n&quot;;</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3640eb85f061beeb8ce183d18fe105c7"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::recordEditHTML" ref="a3640eb85f061beeb8ce183d18fe105c7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::recordEditHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-recordEditHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-recordEditHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-recordEditHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-recordEditHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in recordEditHTML: 115</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a3640eb85f061beeb8ce183d18fe105c7">recordEditHTML</a> {
    my ($self, $Set, %options) = @_;
    my $r           = $self-&gt;r;
    my $urlpath     = $r-&gt;urlpath;
    my $ce          = $r-&gt;ce;
    my $db      = $r-&gt;db;
    my $authz   = $r-&gt;authz;
    my $user    = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $root        = $ce-&gt;{webworkURLs}-&gt;{root};
    my $courseName  = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    
    my $editMode = $options{editMode};
    my $exportMode = $options{exportMode};
    my $setSelected = $options{setSelected};

    my $visibleClass = $Set-&gt;visible ? <span class="stringliteral">&quot;visible&quot;</span> : <span class="stringliteral">&quot;hidden&quot;</span>;
    my $enable_reduced_scoringClass = $Set-&gt;enable_reduced_scoring ? <span class="stringliteral">&#39;Reduced Credit Enabled&#39;</span> : <span class="stringliteral">&#39;Reduced Credit Disabled&#39;</span>;

    my $users = $db-&gt;countSetUsers($Set-&gt;set_id);
    my $totalUsers = $self-&gt;{totalUsers};
<span class="preprocessor">    # DBFIXME count would suffice</span>
<span class="preprocessor"></span>    my $problems = $db-&gt;listGlobalProblems($Set-&gt;set_id);
    
        my $usersAssignedToSetURL  = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_users_assigned_to_set&#39;</span>, args=&gt;{courseID =&gt; $courseName, setID =&gt; $Set-&gt;set_id} ));
    my $problemListURL  = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_set_detail&#39;</span>, args=&gt;{courseID =&gt; $courseName, setID =&gt; $Set-&gt;set_id} ));
    my $problemSetListURL = $self-&gt;systemLink($urlpath-&gt;new(type=&gt;<span class="stringliteral">&#39;instructor_set_list&#39;</span>, args=&gt;{courseID =&gt; $courseName, setID =&gt; $Set-&gt;set_id})) . <span class="stringliteral">&quot;&amp;editMode=1&amp;visible_sets=&quot;</span> . $Set-&gt;set_id;
    my $imageURL = $ce-&gt;{webworkURLs}-&gt;{htdocs}.<span class="stringliteral">&quot;/images/edit.gif&quot;</span>;
        my $imageLink = CGI::a({href =&gt; $problemSetListURL}, CGI::img({src=&gt;$imageURL, border=&gt;0}));
    
    my @tableCells;
    my %fakeRecord;
    my $set_id = $Set-&gt;set_id;

    $fakeRecord{select} = CGI::checkbox(-name =&gt; <span class="stringliteral">&quot;selected_sets&quot;</span>, -value =&gt; $set_id, -checked =&gt; $setSelected, -label =&gt; <span class="stringliteral">&quot;&quot;</span>, );
<span class="preprocessor">#   $fakeRecord{set_id} = CGI::font({class=&gt;$visibleClass}, $set_id) . ($editMode ? &quot;&quot; : $imageLink);</span>
<span class="preprocessor"></span>    $fakeRecord{set_id} = $editMode 
                    ? CGI::a({href=&gt;$problemListURL}, <span class="stringliteral">&quot;$set_id&quot;</span>) 
                    : CGI::font({<span class="keyword">class</span>=&gt;$visibleClass}, $set_id) . $imageLink;
    $fakeRecord{problems} = (FIELD_PERMS()-&gt;{problems} and not $authz-&gt;hasPermissions($user, FIELD_PERMS()-&gt;{problems}))
                    ? <span class="stringliteral">&quot;$problems&quot;</span>
                    : CGI::a({href=&gt;$problemListURL}, <span class="stringliteral">&quot;$problems&quot;</span>);
    $fakeRecord{users} = (FIELD_PERMS()-&gt;{users} and not $authz-&gt;hasPermissions($user, FIELD_PERMS()-&gt;{users}))
                    ? <span class="stringliteral">&quot;$users/$totalUsers&quot;</span>
                    : CGI::a({href=&gt;$usersAssignedToSetURL}, <span class="stringliteral">&quot;$users/$totalUsers&quot;</span>);
    $fakeRecord{filename} = CGI::input({-name =&gt; <span class="stringliteral">&quot;set.$set_id&quot;</span>, -value=&gt;<span class="stringliteral">&quot;set$set_id.def&quot;</span>, -size=&gt;60});
                    
        
<span class="preprocessor">    # Select</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # selection checkbox</span>
<span class="preprocessor"></span>        push @tableCells, CGI::checkbox(
            -name =&gt; <span class="stringliteral">&quot;selected_sets&quot;</span>,
            -value =&gt; $set_id,
            -checked =&gt; $setSelected,
            -label =&gt; <span class="stringliteral">&quot;&quot;</span>,
        );
    }
    
<span class="preprocessor">    # Set ID</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode) {
        push @tableCells, CGI::a({href=&gt;$problemListURL}, <span class="stringliteral">&quot;$set_id&quot;</span>);
    } <span class="keywordflow">else</span> {        
    push @tableCells, CGI::font({<span class="keyword">class</span>=&gt;$visibleClass}, $set_id . $imageLink);
    }

<span class="preprocessor">    # Problems link</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # &quot;problem list&quot; link</span>
<span class="preprocessor"></span>        push @tableCells, CGI::a({href=&gt;$problemListURL}, <span class="stringliteral">&quot;$problems&quot;</span>);
    }
    
<span class="preprocessor">    # Users link</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($editMode) {
<span class="preprocessor">        # column not there</span>
<span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # &quot;edit users assigned to set&quot; link</span>
<span class="preprocessor"></span>        push @tableCells, CGI::a({href=&gt;$usersAssignedToSetURL}, <span class="stringliteral">&quot;$users/$totalUsers&quot;</span>);
    }
    
<span class="preprocessor">    # determine which non-key fields to show</span>
<span class="preprocessor"></span>    my @fieldsToShow;
    <span class="keywordflow">if</span> ($editMode) {
        @fieldsToShow = @{ EDIT_FIELD_ORDER() };
    } elsif ($exportMode) {
        @fieldsToShow = @{ EXPORT_FIELD_ORDER() };
    } <span class="keywordflow">else</span> {
        @fieldsToShow = @{ VIEW_FIELD_ORDER() };
    }
    
<span class="preprocessor">    # make a hash out of this so we can test membership easily</span>
<span class="preprocessor"></span>    my %nonkeyfields; @nonkeyfields{$Set-&gt;NONKEYFIELDS} = ();
    
<span class="preprocessor">    # Set Fields</span>
<span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $field (@fieldsToShow) {
        next unless exists $nonkeyfields{$field};
        my $fieldName = <span class="stringliteral">&quot;set.&quot;</span> . $set_id . <span class="stringliteral">&quot;.&quot;</span> . $field,        
        my $fieldValue = $Set-&gt;$field;
        my %properties = %{ FIELD_PROPERTIES()-&gt;{$field} };
        $properties{access} = <span class="stringliteral">&quot;readonly&quot;</span> unless $editMode;
        $fieldValue = $self-&gt;formatDateTime($fieldValue) <span class="keywordflow">if</span> $field =~ /_date/;
        $fieldValue =~ s/ /&amp;<a class="code" href="classWeBWorK_1_1ContentGenerator.html#a0b04a9c84777c525b5d1a7683331f7ee">nbsp</a>;/g unless $editMode;
        $fieldValue = ($fieldValue) ? <span class="stringliteral">&quot;Yes&quot;</span> : <span class="stringliteral">&quot;No&quot;</span> <span class="keywordflow">if</span> $field =~ /visible/ and not $editMode;
        $fieldValue = ($fieldValue) ? <span class="stringliteral">&quot;Yes&quot;</span> : <span class="stringliteral">&quot;No&quot;</span> <span class="keywordflow">if</span> $field =~ /enable_reduced_scoring/ and not $editMode;
        push @tableCells, CGI::font({<span class="keyword">class</span>=&gt;$visibleClass}, $self-&gt;fieldEditHTML($fieldName, $fieldValue, \%properties));
<span class="preprocessor">        #$fakeRecord{$field} = CGI::font({class=&gt;$visibleClass}, $self-&gt;fieldEditHTML($fieldName, $fieldValue, \%properties));</span>
<span class="preprocessor"></span>    }

<span class="preprocessor">    #@tableCells = map { $fakeRecord{$_} } @fieldsToShow;</span>
<span class="preprocessor"></span>
    <span class="keywordflow">return</span> CGI::Tr({}, CGI::td({}, \@tableCells));
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a975fb102bbe2aaffddc8416fc5d875e9"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveEdit_form" ref="a975fb102bbe2aaffddc8416fc5d875e9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveEdit_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveEdit_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveEdit_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveEdit_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveEdit_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveEdit_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a975fb102bbe2aaffddc8416fc5d875e9">saveEdit_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save changes&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a23aa91c87e961e26943c4f47d6993ff1"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveEdit_handler" ref="a23aa91c87e961e26943c4f47d6993ff1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveEdit_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveEdit_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveEdit_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveEdit_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveEdit_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveEdit_handler: 57</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a23aa91c87e961e26943c4f47d6993ff1">saveEdit_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r           = $self-&gt;r;
    my $db          = $r-&gt;db;
    
    my @visibleSetIDs = @{ $self-&gt;{visibleSetIDs} };
    <span class="keywordflow">foreach</span> my $setID (@visibleSetIDs) {
        my $Set = $db-&gt;getGlobalSet($setID); # checked
<span class="preprocessor">        # FIXME: we may not want to die on bad sets, they&#39;re not as bad as bad users</span>
<span class="preprocessor"></span>        die <span class="stringliteral">&quot;record for visible set $setID not found&quot;</span> unless $Set;

        <span class="keywordflow">foreach</span> my $field ($Set-&gt;NONKEYFIELDS()) {
            my $param = <span class="stringliteral">&quot;set.${setID}.${field}&quot;</span>;
            <span class="keywordflow">if</span> (defined $tableParams-&gt;{$param}-&gt;[0]) {
                <span class="keywordflow">if</span> ($field =~ /_date/) {
                    $Set-&gt;$field($self-&gt;parseDateTime($tableParams-&gt;{$param}-&gt;[0]));
                } <span class="keywordflow">else</span> {
                    $Set-&gt;$field($tableParams-&gt;{$param}-&gt;[0]);
                }
            }
        }
        
<span class="preprocessor">        # make sure the dates are not more than 10 years in the future</span>
<span class="preprocessor"></span>        my $curr_time = time;
        my $seconds_per_year = 31_556_926;
        my $cutoff = $curr_time + $seconds_per_year*10;
        <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;ResultsWithError&#39;</span>}, <span class="stringliteral">&quot;Error: open date cannot be more than 10 years from now in set $setID&quot;</span>)
            <span class="keywordflow">if</span> $Set-&gt;open_date &gt; $cutoff;
        <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;ResultsWithError&#39;</span>}, <span class="stringliteral">&quot;Error: due date cannot be more than 10 years from now in set $setID&quot;</span>)
            <span class="keywordflow">if</span> $Set-&gt;due_date &gt; $cutoff;
        <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;ResultsWithError&#39;</span>}, <span class="stringliteral">&quot;Error: answer date cannot be more than 10 years from now in set $setID&quot;</span>)
            <span class="keywordflow">if</span> $Set-&gt;answer_date &gt; $cutoff;
        
        # Check that the open, due and answer dates are in increasing order.
        # Bail <span class="keywordflow">if</span> <span class="keyword">this</span> is not correct.
        if ($Set-&gt;open_date &gt; $Set-&gt;due_date)  {
            <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;ResultsWithError&#39;</span>}, <span class="stringliteral">&quot;Error: Due date must come after open date in set $setID&quot;</span>);
        }
        <span class="keywordflow">if</span> ($Set-&gt;due_date &gt; $Set-&gt;answer_date) {
            <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;ResultsWithError&#39;</span>}, <span class="stringliteral">&quot;Error: Answer date must come after due date in set $setID&quot;</span>);
        }
        
        $db-&gt;putGlobalSet($Set);
    }
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visble_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    
    $self-&gt;{editMode} = 0;
    
    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, <span class="stringliteral">&quot;changes saved&quot;</span> );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a0e7ee9e3752eb418ebe135227232c4bb"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveExport_form" ref="a0e7ee9e3752eb418ebe135227232c4bb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveExport_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveExport_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveExport_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveExport_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveExport_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveExport_form: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a0e7ee9e3752eb418ebe135227232c4bb">saveExport_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Export selected sets.&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aa77e5ef38443c9ca1f587f8febf561d7"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveExport_handler" ref="aa77e5ef38443c9ca1f587f8febf561d7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::saveExport_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-saveExport_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-saveExport_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-saveExport_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-saveExport_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in saveExport_handler: 34</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#aa77e5ef38443c9ca1f587f8febf561d7">saveExport_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    my $r           = $self-&gt;r;
    my $db          = $r-&gt;db;
    
    my @setIDsToExport = @{ $self-&gt;{selectedSetIDs} };

    my %filenames = map { $_ =&gt; (@{ $tableParams-&gt;{<span class="stringliteral">&quot;set.$_&quot;</span>} }[0] || $_) } @setIDsToExport;

    my ($exported, $skipped, $reason) = $self-&gt;exportSetsToDef(%filenames);
    
    <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [ $r-&gt;param(<span class="stringliteral">&quot;prev_visible_sets&quot;</span>) ];
    } elsif (defined $r-&gt;param(<span class="stringliteral">&quot;no_prev_visble_sets&quot;</span>)) {
        $self-&gt;{visibleSetIDs} = [];
    } <span class="keywordflow">else</span> {
<span class="preprocessor">        # leave it alone</span>
<span class="preprocessor"></span>    }
    
    $self-&gt;{exportMode} = 0;
    
    my $numExported = @$exported;
    my $numSkipped = @$skipped;
    my $resultFont = ($numSkipped)? <span class="stringliteral">&quot;ResultsWithError&quot;</span> : <span class="stringliteral">&quot;ResultsWithoutError&quot;</span>;
    
    my @reasons = map { <span class="stringliteral">&quot;set $_ - &quot;</span> . $reason-&gt;{$_} } keys %$reason;

    <span class="keywordflow">return</span>  CGI::div( {<span class="keyword">class</span>=&gt;$resultFont},
        $numExported . <span class="stringliteral">&quot; set&quot;</span> . ($numExported == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; exported, &quot;</span>
        . $numSkipped . <span class="stringliteral">&quot; set&quot;</span> . ($numSkipped == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>) . <span class="stringliteral">&quot; skipped.&quot;</span>
        . (($numSkipped) ? CGI::ul(CGI::li(\@reasons)) : <span class="stringliteral">&quot;&quot;</span>)
        );

}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a764e242225f5100b235459ae3296586d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::score_form" ref="a764e242225f5100b235459ae3296586d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::score_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-score_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-score_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-score_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-score_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in score_form: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a764e242225f5100b235459ae3296586d">score_form</a> {
    my ($self, $onChange, %actionParams) = @_;

    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Score &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.score.scope&quot;</span>,
            -values =&gt; [qw(none all selected)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.score.scope&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;none&quot;</span>,
            -labels =&gt; {
                none =&gt; <span class="stringliteral">&quot;no sets.&quot;</span>,
                all =&gt; <span class="stringliteral">&quot;all sets.&quot;</span>,
                selected =&gt; <span class="stringliteral">&quot;selected sets.&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
    );
    


}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a9ed77db55bdf9afc4b033a1dc08c7be2"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::score_handler" ref="a9ed77db55bdf9afc4b033a1dc08c7be2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::score_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-score_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-score_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-score_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-score_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in score_handler: 32</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a9ed77db55bdf9afc4b033a1dc08c7be2">score_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;

    my $r      = $self-&gt;r;
    my $urlpath = $r-&gt;urlpath;
    my $courseName = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);

    my $scope = $actionParams-&gt;{<span class="stringliteral">&quot;action.score.scope&quot;</span>}-&gt;[0]; 
    my @setsToScore;
    
    <span class="keywordflow">if</span> ($scope eq <span class="stringliteral">&quot;none&quot;</span>) { 
        @setsToScore = ();
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;No sets selected for scoring.&quot;</span>;
    } elsif ($scope eq <span class="stringliteral">&quot;all&quot;</span>) {
        @setsToScore = @{ $self-&gt;{allSetIDs} };
    } elsif ($scope eq <span class="stringliteral">&quot;visible&quot;</span>) {
        @setsToScore = @{ $self-&gt;{visibleSetIDs} };
    } elsif ($scope eq <span class="stringliteral">&quot;selected&quot;</span>) {
        @setsToScore = @{ $genericParams-&gt;{selected_sets} };
    }

    my $uri = $self-&gt;systemLink( $urlpath-&gt;newFromModule(<span class="stringliteral">&#39;WeBWorK::ContentGenerator::Instructor::Scoring&#39;</span>,$r, courseID=&gt;$courseName),
                    params=&gt;{
                        scoreSelected=&gt;<span class="stringliteral">&quot;Score Selected&quot;</span>,
                        selectedSet=&gt;\@setsToScore,
<span class="preprocessor">#                       recordSingleSetScores=&gt;&#39;&#39;</span>
<span class="preprocessor"></span>                    }
    );
    
    
    <span class="keywordflow">return</span> $uri;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a77063db9fee569f64c295dfe9ed68e7d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::sort_form" ref="a77063db9fee569f64c295dfe9ed68e7d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::sort_form </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-sort_form' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-sort_form-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-sort_form-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-sort_form-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in sort_form: 38</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#a77063db9fee569f64c295dfe9ed68e7d">sort_form</a> {
    my ($self, $onChange, %actionParams) = @_;
    <span class="keywordflow">return</span> join (<span class="stringliteral">&quot;&quot;</span>,
        <span class="stringliteral">&quot;Primary sort: &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.sort.primary&quot;</span>,
            -values =&gt; [qw(set_id set_header hardcopy_header open_date due_date answer_date visible)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.sort.primary&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;due_date&quot;</span>,
            -labels =&gt; {
                set_id      =&gt; <span class="stringliteral">&quot;Set Name&quot;</span>,
                set_header  =&gt; <span class="stringliteral">&quot;Set Header&quot;</span>,
                hardcopy_header =&gt; <span class="stringliteral">&quot;Hardcopy Header&quot;</span>,
                open_date   =&gt; <span class="stringliteral">&quot;Open Date&quot;</span>,
                due_date    =&gt; <span class="stringliteral">&quot;Due Date&quot;</span>,
                answer_date =&gt; <span class="stringliteral">&quot;Answer Date&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;Visibility&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot; Secondary sort: &quot;</span>,
        CGI::popup_menu(
            -name =&gt; <span class="stringliteral">&quot;action.sort.secondary&quot;</span>,
            -values =&gt; [qw(set_id set_header hardcopy_header open_date due_date answer_date visible)],
            -<span class="keywordflow">default</span> =&gt; $actionParams{<span class="stringliteral">&quot;action.sort.secondary&quot;</span>}-&gt;[0] || <span class="stringliteral">&quot;open_date&quot;</span>,
            -labels =&gt; {
                set_id      =&gt; <span class="stringliteral">&quot;Set Name&quot;</span>,
                set_header  =&gt; <span class="stringliteral">&quot;Set Header&quot;</span>,
                hardcopy_header =&gt; <span class="stringliteral">&quot;Hardcopy Header&quot;</span>,
                open_date   =&gt; <span class="stringliteral">&quot;Open Date&quot;</span>,
                due_date    =&gt; <span class="stringliteral">&quot;Due Date&quot;</span>,
                answer_date =&gt; <span class="stringliteral">&quot;Answer Date&quot;</span>,
                visible =&gt; <span class="stringliteral">&quot;Visibility&quot;</span>,
            },
            -onchange =&gt; $onChange,
        ),
        <span class="stringliteral">&quot;.&quot;</span>,
    );
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="abc023f40279d632ebbf5c0776e690a62"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::ProblemSetList::sort_handler" ref="abc023f40279d632ebbf5c0776e690a62" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::ProblemSetList::sort_handler </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-sort_handler' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-sort_handler-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-sort_handler-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-sort_handler-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in sort_handler: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1ProblemSetList.html#abc023f40279d632ebbf5c0776e690a62">sort_handler</a> {
    my ($self, $genericParams, $actionParams, $tableParams) = @_;
    
    my $primary = $actionParams-&gt;{<span class="stringliteral">&quot;action.sort.primary&quot;</span>}-&gt;[0];
    my $secondary = $actionParams-&gt;{<span class="stringliteral">&quot;action.sort.secondary&quot;</span>}-&gt;[0];
    
    $self-&gt;{primarySortField} = $primary;
    $self-&gt;{secondarySortField} = $secondary;

    my %names = (
        set_id      =&gt; <span class="stringliteral">&quot;Set Name&quot;</span>,
        set_header  =&gt; <span class="stringliteral">&quot;Set Header&quot;</span>,
        hardcopy_header =&gt; <span class="stringliteral">&quot;Hardcopy Header&quot;</span>,
        open_date   =&gt; <span class="stringliteral">&quot;Open Date&quot;</span>,
        due_date    =&gt; <span class="stringliteral">&quot;Due Date&quot;</span>,
        answer_date =&gt; <span class="stringliteral">&quot;Answer Date&quot;</span>,
        visible =&gt; <span class="stringliteral">&quot;Visibility&quot;</span>,
    );
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;sort by $names{$primary} and then by $names{$secondary}.&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ProblemSetList_8pm_source.html">ProblemSetList.pm</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:57:55 2012 for WeBWorK2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
