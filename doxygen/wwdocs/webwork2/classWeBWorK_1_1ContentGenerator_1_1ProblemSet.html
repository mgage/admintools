<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WeBWorK2: WeBWorK::ContentGenerator::ProblemSet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="classWeBWorK.html">WeBWorK</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator.html">ContentGenerator</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html">ProblemSet</a>
  </div>
</div>
<div class="contents">
<h1>WeBWorK::ContentGenerator::ProblemSet Class Reference</h1><!-- doxytag: class="WeBWorK::ContentGenerator::ProblemSet" --><!-- doxytag: inherits="WeBWorK::ContentGenerator" --><div class="dynheader">
Inheritance diagram for WeBWorK::ContentGenerator::ProblemSet:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1ProblemSet__inherit__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1ProblemSet_inherit__map" alt="Inheritance graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1ProblemSet_inherit__map" id="WeBWorK_1_1ContentGenerator_1_1ProblemSet_inherit__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="44,80,236,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="99,5,181,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for WeBWorK::ContentGenerator::ProblemSet:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1ProblemSet__coll__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1ProblemSet_coll__map" alt="Collaboration graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1ProblemSet_coll__map" id="WeBWorK_1_1ContentGenerator_1_1ProblemSet_coll__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="44,80,236,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="99,5,181,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#acc85ad130e591c4bb9af9260cdb02092">body</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a99164e3b3080a860822cd4bf8d73ff99">info</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a49f14e3eca7e2cad2f3eb56d9e7a9b5d">problemListRow</a> ($$$)()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a7e430498cda6b1d20d6eb86a28a3cb01">options</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a503734fa8729807c6b70e4e77fed9413">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a2a8559bd6daef8b10ae645ede183be73">nav</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a1116101a37c0e9aad691fd29575a0aec">siblings</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="NAME">
NAME</a></h2>
<p><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html">WeBWorK::ContentGenerator::ProblemSet</a> - display an index of the problems in a problem set. </p>

<p>Definition at line <a class="el" href="ProblemSet_8pm_source.html#l00022">22</a> of file <a class="el" href="ProblemSet_8pm_source.html">ProblemSet.pm</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="acc85ad130e591c4bb9af9260cdb02092"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::body" ref="acc85ad130e591c4bb9af9260cdb02092" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::body </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-body' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-body-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-body-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-body-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in body: 116</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#acc85ad130e591c4bb9af9260cdb02092">body</a> {
    my ($self) = @_;
    my $r = $self-&gt;r;
    my $ce = $r-&gt;ce;
    my $db = $r-&gt;db;
    my $urlpath = $r-&gt;urlpath;

    my $courseID = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setName = $urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);
    my $effectiveUser = $r-&gt;param(<span class="stringliteral">&#39;effectiveUser&#39;</span>);

    my $set = $db-&gt;getMergedSet($effectiveUser, $setName);  # checked
<span class="preprocessor">    # FIXME: this was already caught in initialize()</span>
<span class="preprocessor"></span><span class="preprocessor">    # die &quot;set $setName for user $effectiveUser not found&quot; unless $set;</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> ( $self-&gt;{invalidSet} ) { 
        <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>},
                CGI::p($r-&gt;maketext(<span class="stringliteral">&quot;The selected problem set ([_1]) is not a valid set for [_2]&quot;</span>,$setName,$effectiveUser).<span class="stringliteral">&quot;:&quot;</span>),
                CGI::p($self-&gt;{invalidSet}));
    }
    
<span class="preprocessor">    #my $hardcopyURL =</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $ce-&gt;{webworkURLs}-&gt;{root} . &quot;/&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">    #   . $ce-&gt;{courseName} . &quot;/&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">    #   . &quot;hardcopy/$setName/?&quot; . $self-&gt;url_authen_args;</span>
<span class="preprocessor"></span>    
    my $hardcopyPage = $urlpath-&gt;newFromModule(<span class="stringliteral">&quot;WeBWorK::ContentGenerator::Hardcopy&quot;</span>, $r, 
        courseID =&gt; $courseID, setID =&gt; $setName);
    my $hardcopyURL = $self-&gt;systemLink($hardcopyPage);
    
<span class="preprocessor">    # print CGI::div({-class=&gt;&quot;problem_set_options&quot;}, CGI::a({href=&gt;$hardcopyURL}, $r-&gt;maketext(&quot;Download PDF or TeX Hardcopy for Current Set&quot;)));</span>
<span class="preprocessor"></span>

    my $enable_reduced_scoring = $set-&gt;enable_reduced_scoring;
    my $reducedScoringPeriod = $ce-&gt;{pg}-&gt;{ansEvalDefaults}-&gt;{reducedScoringPeriod};
    <span class="keywordflow">if</span> ($reducedScoringPeriod &gt; 0 and $enable_reduced_scoring) {
        my $dueDate = $self-&gt;formatDateTime($set-&gt;due_date());
        my $reducedScoringPeriodSec = $reducedScoringPeriod*60;   # $reducedScoringPeriod is in minutes
        my $reducedScoringValue = $ce-&gt;{pg}-&gt;{ansEvalDefaults}-&gt;{reducedScoringValue};
        my $reducedScoringPerCent = int(100*$reducedScoringValue+.5);
        my $beginReducedScoringPeriod =  $self-&gt;formatDateTime($set-&gt;due_date() - $reducedScoringPeriodSec);
        <span class="keywordflow">if</span> (time &lt; $set-&gt;due_date()) {
            print CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsAlert&quot;</span>},$r-&gt;maketext(<span class="stringliteral">&quot;_REDUCED_CREDIT_MESSAGE_1&quot;</span>,$beginReducedScoringPeriod,$dueDate,$reducedScoringPerCent));
        } <span class="keywordflow">else</span> {
            print CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsAlert&quot;</span>},$r-&gt;maketext(<span class="stringliteral">&quot;_REDUCED_CREDIT_MESSAGE_2&quot;</span>,$beginReducedScoringPeriod,$dueDate,$reducedScoringPerCent));
        }
    }
    
<span class="preprocessor">    # DBFIXME use iterator</span>
<span class="preprocessor"></span>    my @problemNumbers = <a class="code" href="classWeBWorK.html#aef5c816a59236d20a69d8de3d141c138">WeBWorK::remove_duplicates</a>($db-&gt;listUserProblems($effectiveUser, $setName));
    
    <span class="keywordflow">if</span> (@problemNumbers) {
<span class="preprocessor">        # UPDATE - ghe3</span>
<span class="preprocessor"></span><span class="preprocessor">        # This table now contains a summary, a caption, and scope variables for the columns.</span>
<span class="preprocessor"></span>        print CGI::start_table({-summary=&gt;<span class="stringliteral">&quot;This table shows the problems that are in this problem set.  The columns from left to right are: name of the problem, current number of attempts made, number of attempts remaining, the point worth, and the completion status.  Click on the link on the name of the problem to take you to the problem page.&quot;</span>, -<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;problem_set_table&quot;</span>});
        print CGI::caption($r-&gt;maketext(<span class="stringliteral">&quot;Problems&quot;</span>));
        print CGI::Tr({},

            CGI::th($r-&gt;maketext(<span class="stringliteral">&quot;Name&quot;</span>)),
            CGI::th($r-&gt;maketext(<span class="stringliteral">&quot;Attempts&quot;</span>)),
            CGI::th($r-&gt;maketext(<span class="stringliteral">&quot;Remaining&quot;</span>)),
            CGI::th($r-&gt;maketext(<span class="stringliteral">&quot;Worth&quot;</span>)),
            CGI::th($r-&gt;maketext(<span class="stringliteral">&quot;Status&quot;</span>)),

        );
        
        <span class="keywordflow">foreach</span> my $problemNumber (sort { $a &lt;=&gt; $b } @problemNumbers) {
            my $problem = $db-&gt;getMergedProblem($effectiveUser, $setName, $problemNumber); # checked
            die <span class="stringliteral">&quot;problem $problemNumber in set $setName for user $effectiveUser not found.&quot;</span> unless $problem;
            print $self-&gt;problemListRow($set, $problem);
        }
        
        print CGI::end_table();
    } <span class="keywordflow">else</span> {
        print CGI::p($r-&gt;maketext(<span class="stringliteral">&quot;This homework set contains no problems.&quot;</span>));
    }
    
<span class="preprocessor">    ## feedback form url</span>
<span class="preprocessor"></span><span class="preprocessor">    #my $feedbackPage = $urlpath-&gt;newFromModule(&quot;WeBWorK::ContentGenerator::Feedback&quot;, $r, </span>
<span class="preprocessor"></span><span class="preprocessor">    #   courseID =&gt; $courseID);</span>
<span class="preprocessor"></span><span class="preprocessor">    #my $feedbackURL = $self-&gt;systemLink($feedbackPage, authen =&gt; 0); # no authen info for form action</span>
<span class="preprocessor"></span><span class="preprocessor">    #</span>
<span class="preprocessor"></span><span class="preprocessor">    ##print feedback form</span>
<span class="preprocessor"></span><span class="preprocessor">    #print</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::start_form(-method=&gt;&quot;POST&quot;, -action=&gt;$feedbackURL),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   $self-&gt;hidden_authen_fields,&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;module&quot;,             __PACKAGE__),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;set&quot;,                $self-&gt;{set}-&gt;set_id),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;problem&quot;,            &#39;&#39;),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;displayMode&quot;,        $self-&gt;{displayMode}),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;showOldAnswers&quot;,     &#39;&#39;),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;showCorrectAnswers&quot;, &#39;&#39;),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;showHints&quot;,          &#39;&#39;),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::hidden(&quot;showSolutions&quot;,      &#39;&#39;),&quot;\n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::p({-align=&gt;&quot;left&quot;},</span>
<span class="preprocessor"></span><span class="preprocessor">    #       CGI::submit(-name=&gt;&quot;feedbackForm&quot;, -label=&gt;&quot;Email instructor&quot;)</span>
<span class="preprocessor"></span><span class="preprocessor">    #   ),</span>
<span class="preprocessor"></span><span class="preprocessor">    #   CGI::endform(),&quot;\n&quot;;</span>
<span class="preprocessor"></span>    
    print CGI::start_div({-<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;problem_set_options&quot;</span>});
    print $self-&gt;feedbackMacro(
        module =&gt; __PACKAGE__,
        <span class="keyword">set</span> =&gt; $self-&gt;{<span class="keyword">set</span>}-&gt;set_id,
        problem =&gt; <span class="stringliteral">&quot;&quot;</span>,
        displayMode =&gt; $self-&gt;{displayMode},
        showOldAnswers =&gt; <span class="stringliteral">&quot;&quot;</span>,
        showCorrectAnswers =&gt; <span class="stringliteral">&quot;&quot;</span>,
        showHints =&gt; <span class="stringliteral">&quot;&quot;</span>,
        showSolutions =&gt; <span class="stringliteral">&quot;&quot;</span>,
    );
    print CGI::end_div();
    
    print CGI::div({-<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;problem_set_options&quot;</span>}, CGI::a({href=&gt;$hardcopyURL}, $r-&gt;maketext(<span class="stringliteral">&quot;Download PDF or TeX Hardcopy for Current Set&quot;</span>))).CGI::br();
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a99164e3b3080a860822cd4bf8d73ff99"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::info" ref="a99164e3b3080a860822cd4bf8d73ff99" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::info </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-info' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-info-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-info-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-info-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in info: 95</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a99164e3b3080a860822cd4bf8d73ff99">info</a> {
    my ($self) = @_;
    my $r = $self-&gt;r;
    my $ce = $r-&gt;ce;
    my $db = $r-&gt;db;
    my $authz = $r-&gt;authz;
    my $urlpath = $r-&gt;urlpath;

    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span> <span class="keywordflow">if</span> ( $self-&gt;{invalidSet} );
    
    my $courseID = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setID = $r-&gt;urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);

    my $userID = $r-&gt;param(<span class="stringliteral">&quot;user&quot;</span>);
    my $eUserID = $r-&gt;param(<span class="stringliteral">&quot;effectiveUser&quot;</span>);
    
    my $effectiveUser = $db-&gt;getUser($eUserID); # checked 
    my $set  = $db-&gt;getMergedSet($eUserID, $setID); # checked
    
    die <span class="stringliteral">&quot;effective user $eUserID not found. One &#39;acts as&#39; the effective user.&quot;</span> unless $effectiveUser;
<span class="preprocessor">    # FIXME: this was already caught in initialize()</span>
<span class="preprocessor"></span>    die <span class="stringliteral">&quot;set $setID for effectiveUser $eUserID not found.&quot;</span> unless $set;
    
    my $psvn = $set-&gt;psvn();
<span class="preprocessor">    # hack to prevent errors from uninitialized set_headers.</span>
<span class="preprocessor"></span>    $set-&gt;set_header(<span class="stringliteral">&quot;defaultHeader&quot;</span>) unless $set-&gt;set_header =~/\S/; # (some non-white space character required)
    my $screenSetHeader = ($set-&gt;set_header eq <span class="stringliteral">&quot;defaultHeader&quot;</span>) ?
          $ce-&gt;{webworkFiles}-&gt;{screenSnippets}-&gt;{setHeader} :
          $set-&gt;set_header;

    my $displayMode     = $r-&gt;param(<span class="stringliteral">&quot;displayMode&quot;</span>) || $ce-&gt;{pg}-&gt;{options}-&gt;{displayMode};
    
    <span class="keywordflow">if</span> ($authz-&gt;hasPermissions($userID, <span class="stringliteral">&quot;modify_problem_sets&quot;</span>)) {
        <span class="keywordflow">if</span> (defined $r-&gt;param(<span class="stringliteral">&quot;editMode&quot;</span>) and $r-&gt;param(<span class="stringliteral">&quot;editMode&quot;</span>) eq <span class="stringliteral">&quot;temporaryFile&quot;</span>) {
            $screenSetHeader = $r-&gt;param(<span class="stringliteral">&#39;sourceFilePath&#39;</span>);
            $screenSetHeader = $ce-&gt;{courseDirs}{templates}.<span class="charliteral">&#39;/&#39;</span>.$screenSetHeader unless $screenSetHeader =~ m!^/!;
            die <span class="stringliteral">&quot;sourceFilePath is unsafe!&quot;</span> unless path_is_subdir($screenSetHeader, $ce-&gt;{courseDirs}-&gt;{templates});
            $self-&gt;addmessage(CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&#39;temporaryFile&#39;</span>}, $r-&gt;maketext(<span class="stringliteral">&quot;Viewing temporary file&quot;</span>).<span class="stringliteral">&quot;: &quot;</span>,
                        $screenSetHeader));
            $displayMode = $r-&gt;param(<span class="stringliteral">&quot;displayMode&quot;</span>) <span class="keywordflow">if</span> $r-&gt;param(<span class="stringliteral">&quot;displayMode&quot;</span>);
        }
    }
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span> unless defined $screenSetHeader and $screenSetHeader;
    
<span class="preprocessor">    # decide what to do about problem number</span>
<span class="preprocessor"></span>    my $problem = <a class="code" href="classWeBWorK_1_1DB_1_1Record_1_1UserProblem.html">WeBWorK::DB::Record::UserProblem</a>-&gt;new(
        problem_id =&gt; 0,
        set_id =&gt; $set-&gt;set_id,
        login_id =&gt; $effectiveUser-&gt;user_id,
        source_file =&gt; $screenSetHeader,
        # the rest of Problem<span class="stringliteral">&#39;s fields are not needed, i think</span>
<span class="stringliteral">    );</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    my $pg = WeBWorK::PG-&gt;new(</span>
<span class="stringliteral">        $ce,</span>
<span class="stringliteral">        $effectiveUser,</span>
<span class="stringliteral">        $r-&gt;param(&#39;</span>key<span class="stringliteral">&#39;),</span>
<span class="stringliteral">        $set,</span>
<span class="stringliteral">        $problem,</span>
<span class="stringliteral">        $psvn,</span>
<span class="stringliteral">        {}, # no form fields!</span>
<span class="stringliteral">        { # translation options</span>
<span class="stringliteral">            displayMode     =&gt; $displayMode,</span>
<span class="stringliteral">            showHints       =&gt; 0,</span>
<span class="stringliteral">            showSolutions   =&gt; 0,</span>
<span class="stringliteral">            processAnswers  =&gt; 0,</span>
<span class="stringliteral">        },</span>
<span class="stringliteral">    );</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    my $editorURL;</span>
<span class="stringliteral">    if (defined($set) and $authz-&gt;hasPermissions($userID, &quot;modify_problem_sets&quot;)) {  </span>
<span class="stringliteral">        my $editorPage = $urlpath-&gt;newFromModule(&quot;WeBWorK::ContentGenerator::Instructor::PGProblemEditor&quot;, $r, </span>
<span class="stringliteral">            courseID =&gt; $courseID, setID =&gt; $set-&gt;set_id, problemID =&gt; 0);</span>
<span class="stringliteral">        $editorURL = $self-&gt;systemLink($editorPage, params =&gt; { file_type =&gt; &#39;</span>set_header<span class="stringliteral">&#39;});</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    print CGI::start_div({class=&gt;&quot;info-box&quot;, id=&gt;&quot;InfoPanel&quot;});</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    if ($editorURL) {</span>
<span class="stringliteral">        print CGI::h2({},$r-&gt;maketext(&quot;Set Info&quot;), CGI::a({href=&gt;$editorURL, target=&gt;&quot;WW_Editor&quot;}, $r-&gt;maketext(&quot;~[edit~]&quot;)));</span>
<span class="stringliteral">    } else {</span>
<span class="stringliteral">        print CGI::h2($r-&gt;maketext(&quot;Set Info&quot;));</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    if ($pg-&gt;{flags}-&gt;{error_flag}) {</span>
<span class="stringliteral">        print CGI::div({class=&gt;&quot;ResultsWithError&quot;}, $self-&gt;errorOutput($pg-&gt;{errors}, $pg-&gt;{body_text}));</span>
<span class="stringliteral">    } else {</span>
<span class="stringliteral">        print $pg-&gt;{body_text};</span>
<span class="stringliteral">    }</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    print CGI::end_div();</span>
<span class="stringliteral">    </span>
<span class="stringliteral">    return &quot;&quot;;</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a503734fa8729807c6b70e4e77fed9413"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::initialize" ref="a503734fa8729807c6b70e4e77fed9413" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in initialize: 63</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a503734fa8729807c6b70e4e77fed9413">initialize</a> {
    my ($self) = @_;
    my $r = $self-&gt;r;
    my $db = $r-&gt;db;
    my $urlpath = $r-&gt;urlpath;
    my $authz = $r-&gt;authz;
    
    my $setName = $urlpath-&gt;arg(<span class="stringliteral">&quot;setID&quot;</span>);
    my $userName = $r-&gt;param(<span class="stringliteral">&quot;user&quot;</span>);
    my $effectiveUserName = $r-&gt;param(<span class="stringliteral">&quot;effectiveUser&quot;</span>);
    $self-&gt;{displayMode}  = $r-&gt;param(<span class="stringliteral">&#39;displayMode&#39;</span>) || $r-&gt;ce-&gt;{pg}-&gt;{options}-&gt;{displayMode};
    

    my $user            = $db-&gt;getUser($userName); # checked
    my $effectiveUser   = $db-&gt;getUser($effectiveUserName); # checked
    my $set             = $db-&gt;getMergedSet($effectiveUserName, $setName); # checked
    
    die <span class="stringliteral">&quot;user $user (real user) not found.&quot;</span>  unless $user;
    die <span class="stringliteral">&quot;effective user $effectiveUserName  not found. One &#39;acts as&#39; the effective user.&quot;</span>  unless $effectiveUser;

<span class="preprocessor">    # FIXME: some day it would be nice to take out this code and consolidate the two checks</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    # get result and send to message</span>
<span class="preprocessor"></span>    my $status_message = $r-&gt;param(<span class="stringliteral">&quot;status_message&quot;</span>);
    $self-&gt;addmessage(CGI::p(<span class="stringliteral">&quot;$status_message&quot;</span>)) <span class="keywordflow">if</span> $status_message;
    
<span class="preprocessor">    # $self-&gt;{invalidSet} is set by ContentGenerator.pm</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="keywordflow">if</span> $self-&gt;{invalidSet};
    <span class="keywordflow">return</span> unless defined($set);
    
<span class="preprocessor">    # Database fix (in case of undefined visible values)</span>
<span class="preprocessor"></span><span class="preprocessor">    # this is only necessary because some people keep holding to ww1.9 which did not have a visible field</span>
<span class="preprocessor"></span><span class="preprocessor">    # make sure visible is set to 0 or 1</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> ($set-&gt;visible ne <span class="stringliteral">&quot;0&quot;</span> and $set-&gt;visible ne <span class="stringliteral">&quot;1&quot;</span>) {
        my $globalSet = $db-&gt;getGlobalSet($set-&gt;set_id);
        $globalSet-&gt;visible(<span class="stringliteral">&quot;1&quot;</span>);   # defaults to visible
        $db-&gt;putGlobalSet($globalSet);
        $set = $db-&gt;getMergedSet($effectiveUserName, $set-&gt;set_id);
    }

<span class="preprocessor">    # When a set is created enable_reduced_scoring is null, so we have to set it </span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($set-&gt;enable_reduced_scoring ne <span class="stringliteral">&quot;0&quot;</span> and $set-&gt;enable_reduced_scoring ne <span class="stringliteral">&quot;1&quot;</span>) {
        my $globalSet = $db-&gt;getGlobalSet($set-&gt;set_id);
        $globalSet-&gt;enable_reduced_scoring(<span class="stringliteral">&quot;0&quot;</span>);    # defaults to disabled
        $db-&gt;putGlobalSet($globalSet);
        $set = $db-&gt;getMergedSet($effectiveUserName, $set-&gt;set_id);
    }

    my $visiblityStateText = ($set-&gt;visible) ? $r-&gt;maketext(<span class="stringliteral">&quot;visible to students&quot;</span>).<span class="stringliteral">&quot;.&quot;</span> : $r-&gt;maketext(<span class="stringliteral">&quot;hidden from students&quot;</span>).<span class="stringliteral">&quot;.&quot;</span>;
    my $visiblityStateClass = ($set-&gt;visible) ? <span class="stringliteral">&quot;visible&quot;</span> : <span class="stringliteral">&quot;hidden&quot;</span>;
    $self-&gt;addmessage(CGI::span($r-&gt;maketext(<span class="stringliteral">&quot;This set is [_1]&quot;</span>, CGI::font({<span class="keyword">class</span>=&gt;$visiblityStateClass}, $visiblityStateText)))) <span class="keywordflow">if</span> $authz-&gt;hasPermissions($userName, <span class="stringliteral">&quot;view_hidden_sets&quot;</span>);


    $self-&gt;{userName}        = $userName;
    $self-&gt;{user}            = $user;
    $self-&gt;{effectiveUser}   = $effectiveUser;
    $self-&gt;{<span class="keyword">set</span>}             = $set;
    
<span class="preprocessor">    ##### permissions #####</span>
<span class="preprocessor"></span>    
    $self-&gt;{isOpen} = time &gt;= $set-&gt;open_date || $authz-&gt;hasPermissions($userName, <span class="stringliteral">&quot;view_unopened_sets&quot;</span>);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a2a8559bd6daef8b10ae645ede183be73"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::nav" ref="a2a8559bd6daef8b10ae645ede183be73" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::nav </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-nav' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-nav-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-nav-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-nav-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in nav: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a2a8559bd6daef8b10ae645ede183be73">nav</a> {
    my ($self, $args) = @_;
    my $r = $self-&gt;r;
    my $urlpath = $r-&gt;urlpath;

    my $courseID = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
<span class="preprocessor">    #my $problemSetsPage = $urlpath-&gt;newFromModule(&quot;WeBWorK::ContentGenerator::ProblemSets&quot;,  $r, courseID =&gt; $courseID);</span>
<span class="preprocessor"></span>    my $problemSetsPage = $urlpath-&gt;parent;
    
    my @links = ($r-&gt;maketext(<span class="stringliteral">&quot;Homework Sets&quot;</span>) , $r-&gt;location . $problemSetsPage-&gt;path, $r-&gt;maketext(<span class="stringliteral">&quot;navUp&quot;</span>));
<span class="preprocessor">    # CRAP ALERT: this line relies on the hacky options() implementation in ContentGenerator.</span>
<span class="preprocessor"></span><span class="preprocessor">    # we need to find a better way to do this -- long range dependencies like this are dangerous!</span>
<span class="preprocessor"></span><span class="preprocessor">    #my $tail = &quot;&amp;displayMode=&quot;.$self-&gt;{displayMode}.&quot;&amp;showOldAnswers=&quot;.$self-&gt;{will}-&gt;{showOldAnswers};</span>
<span class="preprocessor"></span><span class="preprocessor">    # here is a hack to get some functionality back, but I don&#39;t even think it&#39;s that important to</span>
<span class="preprocessor"></span><span class="preprocessor">    # have this, since there are SO MANY PLACES where we lose the displayMode, etc.</span>
<span class="preprocessor"></span><span class="preprocessor">    # (oh boy, do we need a session table in the database!)</span>
<span class="preprocessor"></span>    my $displayMode = $r-&gt;param(<span class="stringliteral">&quot;displayMode&quot;</span>) || <span class="stringliteral">&quot;&quot;</span>;
    my $showOldAnswers = $r-&gt;param(<span class="stringliteral">&quot;showOldAnswers&quot;</span>) || <span class="stringliteral">&quot;&quot;</span>;
    my $tail = <span class="stringliteral">&quot;&amp;displayMode=$displayMode&amp;showOldAnswers=$showOldAnswers&quot;</span>;
    <span class="keywordflow">return</span> $self-&gt;navMacro($args, $tail, @links);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a7e430498cda6b1d20d6eb86a28a3cb01"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::options" ref="a7e430498cda6b1d20d6eb86a28a3cb01" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::options </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-options' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-options-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-options-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-options-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in options: 1</span>
<span class="preprocessor">sub options { shift-&gt;optionsMacro }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a49f14e3eca7e2cad2f3eb56d9e7a9b5d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::problemListRow" ref="a49f14e3eca7e2cad2f3eb56d9e7a9b5d" args="($$$)()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::problemListRow </td>
          <td>(</td>
          <td class="paramtype">$$$&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-problemListRow($$$)' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-problemListRow($$$)-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-problemListRow($$$)-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-problemListRow($$$)-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in problemListRow($$$): 43</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a49f14e3eca7e2cad2f3eb56d9e7a9b5d">problemListRow</a>($$$) {
    my ($self, $set, $problem) = @_;
    my $r = $self-&gt;r;
    my $urlpath = $r-&gt;urlpath;
    
    my $courseID = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $setID = $set-&gt;set_id;
    my $problemID = $problem-&gt;problem_id;
    
    my $interactiveURL = $self-&gt;systemLink(
        $urlpath-&gt;newFromModule(<span class="stringliteral">&quot;WeBWorK::ContentGenerator::Problem&quot;</span>, $r, 
            courseID =&gt; $courseID, setID =&gt; $setID, problemID =&gt; $problemID
        ),
        params=&gt;{  displayMode =&gt; $self-&gt;{displayMode}, 
                   showOldAnswers =&gt; $self-&gt;{will}-&gt;{showOldAnswers}
        }
    );
    
    my $interactive = CGI::a({-href=&gt;$interactiveURL}, $r-&gt;maketext(<span class="stringliteral">&quot;Problem [_1]&quot;</span>,$problemID));
    my $attempts = $problem-&gt;num_correct + $problem-&gt;num_incorrect;
    my $remaining = (($problem-&gt;max_attempts||-1) &lt; 0) #a blank yields <span class="stringliteral">&#39;infinite&#39;</span> because it evaluates as <span class="keyword">false</span> with out giving warnings about comparing non-numbers
        ? $r-&gt;maketext(<span class="stringliteral">&quot;unlimited&quot;</span>)
        : $problem-&gt;max_attempts - $attempts;
    my $rawStatus = $problem-&gt;status || 0;
    my $status;
    $status = eval{ sprintf(<span class="stringliteral">&quot;%.0f%%&quot;</span>, $rawStatus * 100)}; # round to whole number
    $status = <span class="stringliteral">&#39;unknown(FIXME)&#39;</span> <span class="keywordflow">if</span> $@; # use a blank <span class="keywordflow">if</span> problem status was not defined or not numeric.
                                      # FIXME  -- <span class="keyword">this</span> may not cover all cases.
    
<span class="preprocessor">#   my $msg = ($problem-&gt;value) ? &quot;&quot; : &quot;(This problem will not count towards your grade.)&quot;;</span>
<span class="preprocessor"></span>    
    <span class="keywordflow">return</span> CGI::Tr({},
        CGI::td({-nowrap=&gt;1, -align=&gt;<span class="stringliteral">&quot;left&quot;</span>},$interactive),
        CGI::td({-nowrap=&gt;1, -align=&gt;<span class="stringliteral">&quot;center&quot;</span>},
            [
                $attempts,
                $remaining,
                $problem-&gt;value,
                $status,
            ]));
}

1;
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a1116101a37c0e9aad691fd29575a0aec"></a><!-- doxytag: member="WeBWorK::ContentGenerator::ProblemSet::siblings" ref="a1116101a37c0e9aad691fd29575a0aec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::ProblemSet::siblings </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-siblings' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-siblings-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-siblings-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-siblings-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in siblings: 69</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1ProblemSet.html#a1116101a37c0e9aad691fd29575a0aec">siblings</a> {
    my ($self) = @_;
    my $r = $self-&gt;r;
    my $db = $r-&gt;db;
    my $authz = $r-&gt;authz;
    my $urlpath = $r-&gt;urlpath;
    
    
    my $courseID = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $user = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $eUserID = $r-&gt;param(<span class="stringliteral">&quot;effectiveUser&quot;</span>);

<span class="preprocessor"># note that listUserSets does not list versioned sets</span>
<span class="preprocessor"></span><span class="preprocessor">    # DBFIXME do filtering in WHERE clause, use iterator for results :)</span>
<span class="preprocessor"></span>    my @setIDs = sortByName(undef, $db-&gt;listUserSets($eUserID));

<span class="preprocessor">    # do not show hidden siblings unless user is allowed to view hidden sets, and </span>
<span class="preprocessor"></span><span class="preprocessor">        # exclude gateway tests in all cases</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ( $authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;view_hidden_sets&quot;</span>) ) {
        @setIDs    = grep {my $gs = $db-&gt;getGlobalSet( $_ ); 
                   $gs-&gt;assignment_type() !~ /gateway/} @setIDs;

    } <span class="keywordflow">else</span> {
        @setIDs    = grep {my $gs = $db-&gt;getGlobalSet( $_ ); 
                            $gs-&gt;assignment_type() !~ /gateway/ &amp;&amp; 
                            ( defined($gs-&gt;visible()) ? $gs-&gt;visible() : 1 )
                           }   @setIDs;
    }

    print CGI::start_div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;info-box&quot;</span>, <span class="keywordtype">id</span>=&gt;<span class="stringliteral">&quot;fisheye&quot;</span>});
    print CGI::h2($r-&gt;maketext(<span class="stringliteral">&quot;Sets&quot;</span>));
    print CGI::start_ul();

        debug(<span class="stringliteral">&quot;Begin printing sets from listUserSets()&quot;</span>);
    <span class="keywordflow">foreach</span> my $setID (@setIDs) {
        my $setPage = $urlpath-&gt;newFromModule(<span class="stringliteral">&quot;WeBWorK::ContentGenerator::ProblemSet&quot;</span>, $r, 
            courseID =&gt; $courseID, setID =&gt; $setID);
        my $pretty_set_id = $setID;
        $pretty_set_id =~ s/_/ /g;
        print CGI::li(
                 CGI::a({  href=&gt;$self-&gt;systemLink($setPage,
                            params=&gt;{
                                displayMode    =&gt; $self-&gt;{displayMode}, 
                                showOldAnswers =&gt; $self-&gt;{will}-&gt;{showOldAnswers},
                            },
                        ),
                        <span class="keywordtype">id</span>=&gt;$pretty_set_id,
                      }, $pretty_set_id)
              ) ;
    }
    debug(<span class="stringliteral">&quot;End printing sets from listUserSets()&quot;</span>);

<span class="preprocessor">    # FIXME: when database calls are faster, this will get rid of hidden sibling links</span>
<span class="preprocessor"></span><span class="preprocessor">    #debug(&quot;Begin printing sets from getMergedSets()&quot;); </span>
<span class="preprocessor"></span><span class="preprocessor">    #my @userSetIDs = map {[$eUserID, $_]} @setIDs;</span>
<span class="preprocessor"></span><span class="preprocessor">    #my @sets = $db-&gt;getMergedSets(@userSetIDs);</span>
<span class="preprocessor"></span><span class="preprocessor">    #foreach my $set (@sets) {</span>
<span class="preprocessor"></span><span class="preprocessor">    #   my $setPage = $urlpath-&gt;newFromModule(&quot;WeBWorK::ContentGenerator::ProblemSet&quot;,  $r, courseID =&gt; $courseID, setID =&gt; $set-&gt;set_id);</span>
<span class="preprocessor"></span><span class="preprocessor">    #   print CGI::li(CGI::a({href=&gt;$self-&gt;systemLink($setPage)}, $set-&gt;set_id)) unless !(defined $set &amp;&amp; ($set-&gt;published || $authz-&gt;hasPermissions($user, &quot;view_unpublished_sets&quot;));</span>
<span class="preprocessor"></span><span class="preprocessor">    #}</span>
<span class="preprocessor"></span><span class="preprocessor">    #debug(&quot;Begin printing sets from getMergedSets()&quot;);</span>
<span class="preprocessor"></span>    
    print CGI::end_ul();
<span class="preprocessor">    #print CGI::end_li();</span>
<span class="preprocessor"></span><span class="preprocessor">    #print CGI::end_ul();</span>
<span class="preprocessor"></span>    print CGI::end_div();
    
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ProblemSet_8pm_source.html">ProblemSet.pm</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:58:47 2012 for WeBWorK2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
