<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WeBWorK2: WeBWorK::ContentGenerator::Instructor::Preflight Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="classWeBWorK.html">WeBWorK</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator.html">ContentGenerator</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html">Instructor</a>::<a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html">Preflight</a>
  </div>
</div>
<div class="contents">
<h1>WeBWorK::ContentGenerator::Instructor::Preflight Class Reference</h1><!-- doxytag: class="WeBWorK::ContentGenerator::Instructor::Preflight" --><!-- doxytag: inherits="WeBWorK::ContentGenerator::Instructor" --><div class="dynheader">
Inheritance diagram for WeBWorK::ContentGenerator::Instructor::Preflight:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight__inherit__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_inherit__map" alt="Inheritance graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_inherit__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_inherit__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="32,155,288,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="64,80,256,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="119,5,201,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for WeBWorK::ContentGenerator::Instructor::Preflight:</div>
<div class="dynsection">
<div class="center"><img src="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight__coll__graph.png" border="0" usemap="#WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_coll__map" alt="Collaboration graph"/></div>
<map name="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_coll__map" id="WeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight_coll__map">
<area shape="rect" href="classWeBWorK_1_1ContentGenerator_1_1Instructor.html" title="WeBWorK::ContentGenerator::Instructor" alt="" coords="32,155,288,181"/><area shape="rect" href="classWeBWorK_1_1ContentGenerator.html" title="WeBWorK::ContentGenerator" alt="" coords="64,80,256,107"/><area shape="rect" href="classWeBWorK.html" title="WeBWorK" alt="" coords="119,5,201,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a590f766d94b2eca86f070793da84d106">byProblemID</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a33de596f7115edc36e91235e85aeb372">byUSPD</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a010f9e65bc8f38c88e619e804cc31932">tableRow</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a47d945d47e487bae9b801bb877c22c0e">initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a02d8bc814b63ba34d7ef035dfeee8062">body</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a59f029bf8ea0898a8d62a90b837d0dc6">byUserID</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a24788b99cf48392baf64e7b798230011">byDate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#ae2293d7c5e71d057cb9a2f87cce36172">bySetID</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="NAME">
NAME</a></h2>
<p>WeBWorK::ContentGenerator::Instructor::Preflight.pm -- display past answers of many students </p>

<p>Definition at line <a class="el" href="Preflight_8pm_source.html#l00018">18</a> of file <a class="el" href="Preflight_8pm_source.html">Preflight.pm</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a02d8bc814b63ba34d7ef035dfeee8062"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::body" ref="a02d8bc814b63ba34d7ef035dfeee8062" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::body </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-body' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-body-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-body-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-body-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in body: 336</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a02d8bc814b63ba34d7ef035dfeee8062">body</a> {
    my $self          = shift;
    my $r             = $self-&gt;r;
    my $urlpath       = $r-&gt;urlpath;
    my $db            = $r-&gt;db;
    my $ce            = $r-&gt;ce;
    my $authz         = $r-&gt;authz;
    my $root          = $ce-&gt;{webworkURLs}-&gt;{root};
    my $courseName    = $urlpath-&gt;arg(<span class="stringliteral">&#39;courseID&#39;</span>);  
    my $setName       = $r-&gt;param(<span class="stringliteral">&#39;setID&#39;</span>) || <span class="stringliteral">&quot;&quot;</span>;     # these are passed in the search args in <span class="keyword">this</span> <span class="keywordflow">case</span>
    my $problemNumber = $r-&gt;param(<span class="stringliteral">&#39;problemID&#39;</span>) || <span class="stringliteral">&quot;&quot;</span>;
    <span class="keywordflow">if</span> ($problemNumber =~ /\!(\d+)/) { $problemNumber = $1 };
    my $user          = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    my $key           = $r-&gt;param(<span class="stringliteral">&#39;key&#39;</span>);
    my $studentUser   = $r-&gt;param(<span class="stringliteral">&#39;studentUser&#39;</span>) || <span class="stringliteral">&quot;&quot;</span>;
    
<span class="preprocessor">    # Check permissions</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> CGI::div({<span class="keyword">class</span>=&gt;<span class="stringliteral">&quot;ResultsWithError&quot;</span>}, <span class="stringliteral">&quot;You are not authorized to access the Instructor tools.&quot;</span>)
        unless $authz-&gt;hasPermissions($r-&gt;param(<span class="stringliteral">&quot;user&quot;</span>), <span class="stringliteral">&quot;access_instructor_tools&quot;</span>);

    
    my $showAnswersPage   = $urlpath-&gt;newFromModule($urlpath-&gt;module, $r, courseID =&gt; $courseName);
    my $showAnswersURL    = $self-&gt;systemLink($showAnswersPage,authen =&gt; 0 );
    
    my ($safeUser, $safeCourse) = (<a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($studentUser), <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($courseName));
    my ($safeSet, $safeProb) = (<a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($setName), <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($problemNumber));

    my @defaultOrder = qw(user_id set_id problem_id date answers);

    my %prettyFieldNames;
    
    @prettyFieldNames{qw(
        user_id
        set_id
        problem_id
        date
        answers
    )} = (
        <span class="stringliteral">&quot;User ID&quot;</span>,
        <span class="stringliteral">&quot;Set Name&quot;</span>,
        <span class="stringliteral">&quot;Problem Number&quot;</span>,
        <span class="stringliteral">&quot;Date&quot;</span>, 
        <span class="stringliteral">&quot;Answers&quot;</span>,
    );
    $prettyFieldNames{nofield} = <span class="stringliteral">&quot;&quot;</span>;
    
<span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # print form</span>
<span class="preprocessor"></span><span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span>    
<span class="preprocessor">    # FIXME why are we filtering out users with non-word characters in their userIDs?</span>
<span class="preprocessor"></span>    my @userIDs = grep /\w/, sort $db-&gt;listUsers();
<span class="preprocessor">    # DBFIXME for these &quot;get all&quot; type queries, we shouldn&#39;t need the lists of setIDs</span>
<span class="preprocessor"></span>    my @Users = $db-&gt;getUsers(@userIDs);
    my %users = map { $_ =&gt; $db-&gt;getUser($_)-&gt;first_name } @userIDs;
    my @setIDs = sort $db-&gt;listGlobalSets();
    my @GlobalSets = $db-&gt;getGlobalSets(@setIDs);
    my @GlobalProblems = $db-&gt;getAllGlobalProblems($setName);

    my $scrolling_user_list = scrollingRecordList({
        name =&gt; <span class="stringliteral">&quot;studentUser&quot;</span>,
        request =&gt; $r,
        default_sort =&gt; <span class="stringliteral">&quot;lnfn&quot;</span>,
        default_format =&gt; <span class="stringliteral">&quot;lnfn_uid&quot;</span>,
        default_filters =&gt; [<span class="stringliteral">&quot;all&quot;</span>],
        <span class="keywordflow">default</span> =&gt; <span class="stringliteral">&quot;Select one or more users: &quot;</span>,
<span class="preprocessor">#       hide_sort =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_format =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_filter =&gt; 1,</span>
<span class="preprocessor"></span>        size =&gt; 10,
<span class="preprocessor">#       multiple =&gt; 0,</span>
<span class="preprocessor"></span>    }, @Users);
    
    my $scrolling_set_list = scrollingRecordList({
        name =&gt; <span class="stringliteral">&quot;setID&quot;</span>,
        request =&gt; $r,
        default_sort =&gt; <span class="stringliteral">&quot;set_id&quot;</span>,
        default_format =&gt; <span class="stringliteral">&quot;set_id&quot;</span>,
        default_filters =&gt; [<span class="stringliteral">&quot;all&quot;</span>],
        <span class="keywordflow">default</span> =&gt; <span class="stringliteral">&quot;Select one or more sets: &quot;</span>,
<span class="preprocessor">#       hide_sort =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_format =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_filter =&gt; 1,       </span>
<span class="preprocessor"></span>        size =&gt; 10,
<span class="preprocessor">#       multiple =&gt; 0,</span>
<span class="preprocessor"></span>    }, @GlobalSets);

    my $scrolling_problem_list = scrollingRecordList({
        name =&gt; <span class="stringliteral">&quot;problemID&quot;</span>,
        request =&gt; $r,
        <span class="keywordflow">default</span> =&gt; <span class="stringliteral">&quot;Select one or more problems: &quot;</span>,
        default_filters =&gt; [<span class="stringliteral">&quot;all&quot;</span>],     
<span class="preprocessor">#       hide_sort =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_format =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#       hide_filter =&gt; 1,       </span>
<span class="preprocessor"></span>        size =&gt; 10,
<span class="preprocessor">#       multiple =&gt; 0,</span>
<span class="preprocessor"></span>    }, @GlobalProblems);
    
    my @selected_fields = $r-&gt;param(<span class="stringliteral">&quot;selected_fields&quot;</span>);
    my @selected_answers = $r-&gt;param(<span class="stringliteral">&quot;selected_answers&quot;</span>);

    print join (<span class="stringliteral">&quot;&quot;</span>,
        CGI::br(),
        <span class="stringliteral">&quot;\n\n&quot;</span>,
        CGI::hr(),
        CGI::start_form(
            -method =&gt; <span class="stringliteral">&quot;post&quot;</span>, 
            -action =&gt; $showAnswersURL, 
            -target =&gt; <span class="stringliteral">&#39;information&#39;</span>,
        ),
            CGI::start_table(
                -border =&gt; <span class="stringliteral">&quot;0&quot;</span>, 
                -cellpadding =&gt; <span class="stringliteral">&quot;0&quot;</span>, 
                -cellspacing =&gt; <span class="stringliteral">&quot;0&quot;</span>,
            ),
                CGI::Tr(
                    CGI::td({style=&gt;<span class="stringliteral">&quot;width:33%&quot;</span>}, $scrolling_user_list),
                    CGI::td({style=&gt;<span class="stringliteral">&quot;width:33%&quot;</span>}, $scrolling_set_list),
                    CGI::td({style=&gt;<span class="stringliteral">&quot;width:33%&quot;</span>}, $scrolling_problem_list),                 
                ),
                CGI::Tr({}, 
                    CGI::submit(
                        -name =&gt; <span class="stringliteral">&#39;action&#39;</span>,
                        -value =&gt; <span class="stringliteral">&#39;Past Answers for&#39;</span>,
                    ), <span class="stringliteral">&quot;\n&quot;</span>,
<span class="preprocessor">#                   $self-&gt;hidden_authen_fields,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   &quot; &amp;nbsp; \n User: &amp;nbsp;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   CGI::textfield(</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -name =&gt; &#39;studentUser1&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -value =&gt; $safeUser,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -size =&gt; 10,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   ),</span>
<span class="preprocessor"></span><span class="preprocessor">#                   &quot; &amp;nbsp; \n Set: &amp;nbsp;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   CGI::textfield(</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -name =&gt; &#39;setID1&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -value =&gt; $safeSet,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -size =&gt; 10, </span>
<span class="preprocessor"></span><span class="preprocessor">#                   ),</span>
<span class="preprocessor"></span><span class="preprocessor">#                   &quot; &amp;nbsp; \n Problem:  &amp;nbsp;&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   CGI::textfield(</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -name =&gt; &#39;problemID&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -value =&gt; $safeProb,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -size =&gt; 10,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   ),</span>
<span class="preprocessor"></span><span class="preprocessor">#                   &quot; &amp;nbsp; \n&quot;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   CGI::br(),CGI::br(),</span>
<span class="preprocessor"></span>                ),
#               CGI::Tr({},
<span class="preprocessor">#                   CGI::popup_menu(</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -name =&gt; &#39;studentUser&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -size =&gt; 10,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -values =&gt; \@userIDs,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -multiple =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   ),</span>
<span class="preprocessor"></span><span class="preprocessor">#                   CGI::popup_menu(</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -name =&gt; &#39;setID&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -values =&gt; \@setIDs,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -size =&gt; 10,</span>
<span class="preprocessor"></span><span class="preprocessor">#                       -multiple =&gt; 1,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   ),</span>
<span class="preprocessor"></span><span class="preprocessor">#               ),</span>
<span class="preprocessor"></span>                CGI::Tr({},
                    CGI::td({}, 
                        <span class="stringliteral">&quot;Select which fields to show: &quot;</span> . CGI::br(),
                        CGI::scrolling_list(
                            -name =&gt; <span class="stringliteral">&quot;selected_fields&quot;</span>,
                            -values =&gt; \@defaultOrder,
                            -labels =&gt; \%prettyFieldNames,
                            -<span class="keywordflow">default</span> =&gt; \@selected_fields,
                            -size =&gt; 5,
                            -multiple =&gt; 1,
                        ),
                    ),
                    CGI::td({},
                        <span class="stringliteral">&quot;and which answers to show: &quot;</span> . CGI::br(),
                        CGI::scrolling_list(
                            -name =&gt; <span class="stringliteral">&quot;selected_answers&quot;</span>,
                            -values =&gt; [1..100],
                            -<span class="keywordflow">default</span> =&gt; \@selected_answers,
                            -size =&gt; 5,
                            -multiple =&gt; 1,
                        )
                    ),
                ),
            CGI::end_table({}),
        CGI::end_form({}),  
    );
    
<span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">    # create ordering system</span>
<span class="preprocessor"></span><span class="preprocessor">    #####################################################################</span>
<span class="preprocessor"></span>
<span class="preprocessor">    # FIXME: We need a way to choose the order as well as the fields!</span>
<span class="preprocessor"></span>    my (@fieldOrder) = @selected_fields ? @selected_fields : @defaultOrder;

    <span class="keywordflow">if</span> (defined($setName) and defined($problemNumber) )  {
<span class="preprocessor">        #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">        # print result table of answers</span>
<span class="preprocessor"></span><span class="preprocessor">        #####################################################################</span>
<span class="preprocessor"></span>        my $answer_log    = $self-&gt;{ce}-&gt;{courseFiles}-&gt;{logs}-&gt;{<span class="stringliteral">&#39;answer_log&#39;</span>};
    
        $studentUser = $r-&gt;param(<span class="stringliteral">&#39;studentUser&#39;</span>) <span class="keywordflow">if</span> ( defined($r-&gt;param(<span class="stringliteral">&#39;studentUser&#39;</span>)) );
        my ($safeUser, $safeCourse) = (<a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($studentUser), <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($courseName));
        my ($safeSet, $safeProb) = (<a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($setName), <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($problemNumber));
    
        
        print CGI::h3( <span class="stringliteral">&quot;Past Answers for &quot;</span> . ($safeUser ? <span class="stringliteral">&quot;user $safeUser &quot;</span> : <span class="stringliteral">&#39;&#39;</span> ) . ($safeSet ? <span class="stringliteral">&quot;set $safeSet &quot;</span> : <span class="stringliteral">&#39;&#39;</span> ) . ($safeSet and $safeProb ? <span class="stringliteral">&#39;, &#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . ($safeProb ? <span class="stringliteral">&quot;problem $safeProb&quot;</span> : <span class="stringliteral">&#39;&#39;</span>));
    
        $studentUser = <span class="stringliteral">&quot;[^|]*&quot;</span>    <span class="keywordflow">if</span> (not defined $studentUser or $studentUser eq <span class="stringliteral">&quot;&quot;</span>    or $studentUser eq <span class="stringliteral">&quot;*&quot;</span>);
        $setName = <span class="stringliteral">&quot;[^|]*&quot;</span>  <span class="keywordflow">if</span> ($setName eq <span class="stringliteral">&quot;&quot;</span>  or $setName eq <span class="stringliteral">&quot;*&quot;</span>);
        $problemNumber = <span class="stringliteral">&quot;[^|]*&quot;</span> <span class="keywordflow">if</span> ($problemNumber eq <span class="stringliteral">&quot;&quot;</span> or $problemNumber eq <span class="stringliteral">&quot;*&quot;</span>);

<span class="preprocessor">        #my $pattern = &quot;^[[^]]*]|[^|]*\\|$setName\\|$problemNumber\\|&quot;;</span>
<span class="preprocessor"></span>        my $pattern = <span class="stringliteral">&quot;\\|$studentUser\\|$setName\\|$problemNumber\\|&quot;</span>;
        
        our ($lastdate, $lasttime, $lastID, $lastn);
        
        
        <span class="keywordflow">if</span> (open(LOG,<span class="stringliteral">&quot;$answer_log&quot;</span>)) {
            my $line;
            local ($lastdate, $lasttime, $lastID, $lastn) = (<span class="stringliteral">&quot;&quot;</span>,0,<span class="stringliteral">&quot;&quot;</span>,0);
            $self-&gt;{lastdate}       = <span class="stringliteral">&#39;&#39;</span>;
            $self-&gt;{lasttime}       = <span class="stringliteral">&#39;&#39;</span>;
            $self-&gt;{lastID}         = <span class="stringliteral">&#39;&#39;</span>;
            $self-&gt;{lastn}          = <span class="stringliteral">&#39;&#39;</span>;
          
<span class="preprocessor">            # get data from file</span>
<span class="preprocessor"></span>            
            my @lines = grep(/$pattern/,&lt;LOG&gt;); close(LOG);
            chomp(@lines);
                        
            my $maxcount = 0;
            <span class="keywordflow">foreach</span> my $newline (@lines) {
                my @words = split /\t/, $newline;
                my $count = @words;
                $maxcount = $count <span class="keywordflow">if</span> $count &gt; $maxcount;
            }
            @selected_answers = (1..$maxcount) unless @selected_answers;
            
<span class="preprocessor">#           print &quot;&lt;CENTER&gt;\n&quot;;</span>
<span class="preprocessor"></span>            print CGI::start_table({
                    -border =&gt; <span class="stringliteral">&quot;1&quot;</span>,
<span class="preprocessor">#                   -cellpadding =&gt; &#39;3&#39;,</span>
<span class="preprocessor"></span><span class="preprocessor">#                   -cellspacing =&gt; &#39;0&#39;,</span>
<span class="preprocessor"></span>                    -onload =&gt; <span class="stringliteral">&quot;&quot;</span>,
                }) . <span class="stringliteral">&quot;\n&quot;</span>;
            
            my @tableHeaders;
            <span class="keywordflow">foreach</span> (@fieldOrder) {
                push @tableHeaders, $prettyFieldNames{$_} unless $_ eq <span class="stringliteral">&quot;answers&quot;</span>;
            }
            print CGI::Tr({}, CGI::th({}, \@tableHeaders) , CGI::th({-colspan =&gt; 200}, $prettyFieldNames{answers}));

            my @Records;
<span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">            # create array of records</span>
<span class="preprocessor"></span><span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span>            <span class="keywordflow">foreach</span> $line ( @lines ) {
                my %fakeRecord = ();
<span class="preprocessor">                #print CGI::br() . $line;</span>
<span class="preprocessor"></span>                next <span class="keywordflow">if</span> not $line =~ /\|(\w+)\|([\w\d_-]+)\|(\d+)\|\s*(\d+)(.*?)\t?$/;
                $fakeRecord{user_id} = <span class="stringliteral">&quot;$1&quot;</span>;
                $fakeRecord{set_id} = <span class="stringliteral">&quot;$2&quot;</span>;
                $fakeRecord{problem_id} = <span class="stringliteral">&quot;$3&quot;</span>;
                $fakeRecord{date} = $4; #$self-&gt;formatDateTime($4);
                $fakeRecord{answers} = [ split <span class="stringliteral">&quot;\t&quot;</span>, <span class="stringliteral">&quot;$5&quot;</span>, -1 ] <span class="keywordflow">if</span> $5; # the -1 stops split from dropping any trailing null fields
                my @answers = map { $_ ? <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($_) : CGI::small(CGI::i(<span class="stringliteral">&quot;empty&quot;</span>)) } @{ $fakeRecord{answers} }; 
                shift @answers; # first field is always empty
                $fakeRecord{answers} = \@answers;
                

                my @tableCells;
                <span class="keywordflow">foreach</span> (@fieldOrder) {
                
<span class="preprocessor">                    #push @tableCells, showHTML($fakeRecord{$_});</span>
<span class="preprocessor"></span>                }

                push @Records, \%fakeRecord;

<span class="preprocessor">                #print join &quot; &quot;, map { &quot;$_ = $fakeRecord{$_}&quot; } keys %fakeRecord;</span>
<span class="preprocessor"></span><span class="preprocessor">                #print CGI::br();</span>
<span class="preprocessor"></span><span class="preprocessor">#               print CGI::Tr({}, CGI::td({}, \@tableCells));</span>
<span class="preprocessor"></span>            
<span class="preprocessor">                #print $self-&gt;tableRow(split(&quot;\t&quot;,$line.&quot;\tx&quot;));</span>
<span class="preprocessor"></span>            }

<span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">            # sort array of records</span>
<span class="preprocessor"></span><span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span>
            @Records = sort <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a33de596f7115edc36e91235e85aeb372">byUSPD</a> @Records;

<span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span><span class="preprocessor">            # print array of records</span>
<span class="preprocessor"></span><span class="preprocessor">            #####################################################################</span>
<span class="preprocessor"></span>            
            <span class="keywordflow">foreach</span> my $record (@Records) {
                my @tableCells;
                <span class="keywordflow">foreach</span> (@fieldOrder) {
                    <span class="keywordflow">if</span> ($_ eq <span class="stringliteral">&quot;answers&quot;</span>) {
                        my $i = 0;
                        my %answers = map { ++$i =&gt; $_ } @{ $record-&gt;{$_} };
                        push @tableCells, @answers{@selected_answers};
                    } elsif ($_ eq <span class="stringliteral">&quot;date&quot;</span>) {
                        my ( $sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = localtime $record-&gt;{$_};
                        $wday = (<span class="stringliteral">&quot;Sun&quot;</span>, <span class="stringliteral">&quot;Mon&quot;</span>, <span class="stringliteral">&quot;Tue&quot;</span>, <span class="stringliteral">&quot;Wed&quot;</span>, <span class="stringliteral">&quot;Thu&quot;</span>, <span class="stringliteral">&quot;Fri&quot;</span>, <span class="stringliteral">&quot;Sat&quot;</span>)[$wday];
                        $mon = (<span class="stringliteral">&quot;Jan&quot;</span>, <span class="stringliteral">&quot;Feb&quot;</span>, <span class="stringliteral">&quot;Mar&quot;</span>, <span class="stringliteral">&quot;Apr&quot;</span>, <span class="stringliteral">&quot;May&quot;</span>, <span class="stringliteral">&quot;Jun&quot;</span>, <span class="stringliteral">&quot;Jul&quot;</span>, <span class="stringliteral">&quot;Aug&quot;</span>, <span class="stringliteral">&quot;Sep&quot;</span>, <span class="stringliteral">&quot;Oct&quot;</span>, <span class="stringliteral">&quot;Nov&quot;</span>, <span class="stringliteral">&quot;Dec&quot;</span>)[$mon];
                        $year += 1900;
                        my $ampm = (<span class="stringliteral">&quot;am&quot;</span>, <span class="stringliteral">&quot;pm&quot;</span>)[$hour &gt; 12];
                        $hour = $hour % 12;
                        push @tableCells, <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>(<span class="stringliteral">&quot;$wday $mday $mon $year $hour:$min $ampm&quot;</span>);
                    } <span class="keywordflow">else</span> {
                        push @tableCells, $record-&gt;{$_};
                    }
                }
                
                print CGI::Tr({}, CGI::td({}, \@tableCells));
            }
                
<span class="preprocessor">            # print a horizontal line </span>
<span class="preprocessor"></span><span class="preprocessor">            #print CGI::Tr({}, CGI::td({colspan =&gt; $lastn}, CGI::hr({size =&gt; 3})));</span>
<span class="preprocessor"></span>            print CGI::end_table({});
<span class="preprocessor">#           print &quot;\n&lt;/CENTER&gt;\n\n&quot;;</span>
<span class="preprocessor"></span>            print CGI::p(
                      CGI::i(<span class="stringliteral">&quot;No entries for &quot;</span> . ($safeUser ? <span class="stringliteral">&quot;user $safeUser &quot;</span> : <span class="stringliteral">&#39;&#39;</span> ) . ($safeSet ? <span class="stringliteral">&quot;set $safeSet &quot;</span> : <span class="stringliteral">&#39;&#39;</span> ) . ($safeSet and $safeProb ? <span class="stringliteral">&#39;, &#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . ($safeProb ? <span class="stringliteral">&quot;problem $safeProb&quot;</span> : <span class="stringliteral">&#39;&#39;</span>))
            ) unless @lines;
            
        } else {
            print CGI::em(<span class="stringliteral">&quot;Can&#39;t open the access log $answer_log&quot;</span>);
        }
    }

        
    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a24788b99cf48392baf64e7b798230011"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::byDate" ref="a24788b99cf48392baf64e7b798230011" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::byDate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byDate' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byDate-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byDate-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byDate-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byDate: 1</span>
<span class="preprocessor">sub byDate        { $a-&gt;{date}         cmp $b-&gt;{date}       }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a590f766d94b2eca86f070793da84d106"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::byProblemID" ref="a590f766d94b2eca86f070793da84d106" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::byProblemID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byProblemID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byProblemID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byProblemID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byProblemID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byProblemID: 1</span>
<span class="preprocessor">sub byProblemID   { $a-&gt;{problem_id}   &lt;=&gt; $b-&gt;{problem_id} }  </span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae2293d7c5e71d057cb9a2f87cce36172"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::bySetID" ref="ae2293d7c5e71d057cb9a2f87cce36172" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::bySetID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-bySetID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-bySetID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-bySetID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-bySetID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in bySetID: 1</span>
<span class="preprocessor">sub bySetID       { lc($a-&gt;{set_id})   cmp lc($b-&gt;{set_id})     }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a59f029bf8ea0898a8d62a90b837d0dc6"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::byUserID" ref="a59f029bf8ea0898a8d62a90b837d0dc6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::byUserID </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byUserID' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byUserID-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byUserID-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byUserID-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byUserID: 1</span>
<span class="preprocessor">sub byUserID      { $a-&gt;{user_id}      cmp $b-&gt;{user_id}    }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a33de596f7115edc36e91235e85aeb372"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::byUSPD" ref="a33de596f7115edc36e91235e85aeb372" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::byUSPD </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-byUSPD' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-byUSPD-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-byUSPD-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-byUSPD-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in byUSPD: 1</span>
<span class="preprocessor">sub byUSPD  { &amp;byUserID || &amp;bySetID || &amp;byProblemID || &amp;byDate }</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a47d945d47e487bae9b801bb877c22c0e"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::initialize" ref="a47d945d47e487bae9b801bb877c22c0e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-initialize' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-initialize-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-initialize-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-initialize-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in initialize: 13</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a47d945d47e487bae9b801bb877c22c0e">initialize</a> {
    my $self       = shift;
    my $r          = $self-&gt;r;
    my $urlpath    = $r-&gt;urlpath;
    my $db         = $r-&gt;db;
    my $ce         = $r-&gt;ce;
    my $authz      = $r-&gt;authz;
    my $courseName = $urlpath-&gt;arg(<span class="stringliteral">&quot;courseID&quot;</span>);
    my $user       = $r-&gt;param(<span class="stringliteral">&#39;user&#39;</span>);
    
<span class="preprocessor">    # Check permissions</span>
<span class="preprocessor"></span>    <span class="keywordflow">return</span> unless ($authz-&gt;hasPermissions($user, <span class="stringliteral">&quot;access_instructor_tools&quot;</span>));
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a88b772d7cc3981670aa62edec3f7164d"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::showHTML" ref="a88b772d7cc3981670aa62edec3f7164d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::showHTML </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-showHTML' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-showHTML-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-showHTML-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-showHTML-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in showHTML: 10</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a> {
    my $string = shift;
    <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span> unless defined $string;
    $string =~ s/&amp;/\&amp;amp;/g;
    $string =~ s/&lt;/\&amp;lt;/g;
    $string =~ s/&gt;/\&amp;gt;/g;
    $string =~ s/\0/,/g;
    $string =~ s/ /&amp;<a class="code" href="classWeBWorK_1_1ContentGenerator.html#a0b04a9c84777c525b5d1a7683331f7ee">nbsp</a>;/g;
    <span class="keywordflow">return</span> $string;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a010f9e65bc8f38c88e619e804cc31932"></a><!-- doxytag: member="WeBWorK::ContentGenerator::Instructor::Preflight::tableRow" ref="a010f9e65bc8f38c88e619e804cc31932" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method WeBWorK::ContentGenerator::Instructor::Preflight::tableRow </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-tableRow' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-tableRow-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-tableRow-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-tableRow-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in tableRow: 46</span>
<span class="preprocessor"></span>sub <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a010f9e65bc8f38c88e619e804cc31932">tableRow</a> {
    my $self       = shift;
    my $lastID     = $self-&gt;{lastID};
    my $lastn      = $self-&gt;{lastn};
    my $lasttime   = $self-&gt;{lasttime};
    my $lastdate   = $self-&gt;{lastdate};
    my ($out,$answer,$studentUser,$set,$prob) = <span class="stringliteral">&quot;&quot;</span>;
    my ($ID,$rtime,@answers) = @_; pop(@answers);
    my $date = scalar(localtime($rtime)); $date =~ s/\s+/ /g;
    my ($day,$month,$mdate,$time,$year) = split(<span class="stringliteral">&quot; &quot;</span>,$date);
    $date = <span class="stringliteral">&quot;$mdate $month $year&quot;</span>;
    my $n = 2*(scalar(@answers)+1);

    <span class="keywordflow">if</span> ($lastID ne $ID) {
        <span class="keywordflow">if</span> ($lastn) {
            print qq{&lt;TR&gt;&lt;TD COLSPAN=<span class="stringliteral">&quot;$lastn&quot;</span>&gt;&lt;HR SIZE=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;/TD&gt;&lt;/TR&gt;\n&lt;P&gt;\n\n};
            print <span class="stringliteral">&#39;&lt;TABLE BORDER=&quot;0&quot; CELLPADDING=&quot;0&quot; CELLSPACING=&quot;3&quot;&gt;&#39;</span>,<span class="stringliteral">&quot;\n&quot;</span>;
        }
        ($studentUser,$set,$prob) = (split(<span class="charliteral">&#39;\|&#39;</span>,$ID))[1,2,3];
        $out .= qq{&lt;TR ALIGN=<span class="stringliteral">&quot;CENTER&quot;</span>&gt;&lt;TD COLSPAN=<span class="stringliteral">&quot;$n&quot;</span>&gt;&lt;HR SIZE=<span class="stringliteral">&quot;3&quot;</span>&gt;
            User: &lt;B&gt;$studentUser&lt;/B&gt; &amp;<a class="code" href="classWeBWorK_1_1ContentGenerator.html#a0b04a9c84777c525b5d1a7683331f7ee">nbsp</a>;
            Set: &lt;B&gt;$set&lt;/B&gt; &amp;nbsp;
            Problem: &lt;B&gt;$prob&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;\n};
        $lastID = $ID; $lasttime = 0; $lastdate = <span class="stringliteral">&quot;&quot;</span>;
    }

    $out .= qq{&lt;TR&gt;&lt;TD COLSPAN=<span class="stringliteral">&quot;$n&quot;</span>&gt;&lt;HR SIZE=<span class="stringliteral">&quot;1&quot;</span>&gt;&lt;/TD&gt;&lt;/TR&gt;\n}
    <span class="keywordflow">if</span> ($rtime - $lasttime &gt; 30*60);
    $lasttime = $rtime; $lastn = $n;

    <span class="keywordflow">if</span> ($lastdate ne $date) {
        $out .= qq{&lt;TR&gt;&lt;TD COLSPAN=<span class="stringliteral">&quot;$n&quot;</span>&gt;&lt;SMALL&gt;&lt;I&gt;$date&lt;/I&gt;&lt;/SMALL&gt;&lt;/TD&gt;&lt;/TR&gt;\n};
        $lastdate = $date;
    }

    $out .= <span class="stringliteral">&#39;&lt;TR&gt;&lt;TD WIDTH=&quot;10&quot;&gt;&lt;/TD&gt;&#39;</span>.
        <span class="stringliteral">&#39;&lt;TD&gt;&lt;FONT COLOR=&quot;#808080&quot;&gt;&lt;SMALL&gt;&#39;</span>.$time.<span class="stringliteral">&#39;&lt;/SMALL&gt;&lt;/FONT&gt;&lt;/TD&gt;&#39;</span>;
    <span class="keywordflow">foreach</span> $answer (@answers) {
        $answer =~ s/(^\s+|\s+$)<span class="comment">//g;</span>
        $answer = <a class="code" href="classWeBWorK_1_1ContentGenerator_1_1Instructor_1_1Preflight.html#a88b772d7cc3981670aa62edec3f7164d">showHTML</a>($answer);
        $answer = <span class="stringliteral">&quot;&lt;SMALL&gt;&lt;I&gt;empty&lt;/I&gt;&lt;/SMALL&gt;&quot;</span> <span class="keywordflow">if</span> ($answer eq <span class="stringliteral">&quot;&quot;</span>);
        $out .= qq{&lt;TD WIDTH=<span class="stringliteral">&quot;20&quot;</span>&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;$answer&lt;/TD&gt;};
    }
    $out .= <span class="stringliteral">&quot;&lt;/TR&gt;\n&quot;</span>;
    $out;
}
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Preflight_8pm_source.html">Preflight.pm</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:57:44 2012 for WeBWorK2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
