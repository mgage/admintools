<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PG: Equation_eval Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Equation_eval Class Reference</h1><!-- doxytag: class="Equation_eval" -->
<p><a href="classEquation__eval-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEquation__eval.html#a43ea00f79be8e2e0162a8629ec898c83">number_list_cmp</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEquation__eval.html#a073414fc00c9379e270c1be52c003ea9">mode2context</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEquation__eval.html#a0af0be32d2ff7651d99b5863a255a008">split_eqn</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEquation__eval.html#ad2652cc6dad31325c8693e307f17212c">interval_cmp</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEquation__eval.html#ab2d91665fae148926332d590f89808b9">equation_cmp</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" id="MACROS">
MACROS</a></h2>
<h3><a class="anchor" id="interval_cmp">
interval_cmp</a></h3>
<p>Compares an interval or union of intervals. Typical invocations are </p>
<pre>	interval_cmp("(2, 3] U(7, 11)")</pre><p>The U is used for union symbol. In fact, any garbage (or nothing at all) can go between intervals. It makes sure open/closed parts of intervals are correct, unless you don't like that. To have it ignore the difference between open and closed endpoints, use </p>
<pre>	interval_cmp("(2, 3] U(7, 11)", sloppy=&gt;'yes')</pre><p>interval_cmp uses num_cmp on the endpoints. You can pass optional arguments for num_cmp, so to change the tolerance, you can use </p>
<pre>	interval_cmp("(2, 3] U(3+4, 11)", relTol=&gt;3)</pre><p>The intervals can be listed in any order, unless you want to force a particular order, which is signaled as </p>
<pre>	interval_cmp("(2, 3] U(3+4, 11)", ordered=&gt;'strict')</pre><p>You can specify infinity as an endpoint. It will do a case-insensitive string match looking for I, Infinity, Infty, or Inf. You can prepend a + or -, as in </p>
<pre>	interval_cmp("(-inf, 3] U [e^10, infinity)")</pre><p>or </p>
<pre>	interval_cmp("(-INF, 3] U [e^10, +I)")</pre><p>If the question might have an empty set as the answer, you can use the strings option to allow for it. So </p>
<pre>	interval_cmp("$ans", strings=&gt;['empty'])</pre><p>will not generate an error message if the student enters the string empty. Better still, it will mark a student answer of "empty" as correct iff this matches $ans. </p>
<p>You can use interval_cmp for ordered pairs, or lists of ordered pairs. Internally, this is just a distinction of whether to put nice union symbols between intervals, or commas. To get commas, use </p>
<pre>	interval_cmp("(1,2), (2,3), (4,-1)", unions=&gt;'no')</pre><p>Note that interval_cmp makes no attempt at simplifying overlapping intervals. This becomes an important feature when you are really checking lists of ordered pairs. </p>
<p>Now we use the <a class="el" href="classParser.html">Parser</a> package for checking intervals (or lists of points if unions=&gt;'no'). So, one can specify the <a class="el" href="classParser.html">Parser</a> options showCoordinateHints, showHints, partialCredit, and/or showLengthHints as optional arguments: </p>
<pre>	interval_cmp("(1,2), (2,3), (4,-1)", unions=&gt;'no', partialCredit=&gt;1)</pre><p>Also, set differences and 'R' for all real numbers now work too since they work for <a class="el" href="classParser.html">Parser</a> Intervals and Unions. </p>

<p>Definition at line <a class="el" href="extraAnswerEvaluators_8pl_source.html#l00091">91</a> of file <a class="el" href="extraAnswerEvaluators_8pl_source.html">extraAnswerEvaluators.pl</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab2d91665fae148926332d590f89808b9"></a><!-- doxytag: member="Equation_eval::equation_cmp" ref="ab2d91665fae148926332d590f89808b9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Equation_eval::equation_cmp </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-equation_cmp' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-equation_cmp-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-equation_cmp-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-equation_cmp-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in equation_cmp: 112</span>
<span class="preprocessor"></span>    sub <a class="code" href="classEquation__eval.html#ab2d91665fae148926332d590f89808b9">equation_cmp</a> {
        my $right_ans = shift;
        my %opts = @_;
        my $vars = [<span class="charliteral">&#39;x&#39;</span>,<span class="charliteral">&#39;y&#39;</span>];


        $vars = $opts{<span class="stringliteral">&#39;vars&#39;</span>} <span class="keywordflow">if</span> defined($opts{<span class="stringliteral">&#39;vars&#39;</span>});

        my $ans_eval = sub {
            my $student = shift;
            my %response_options = @_;
            my $ans_hash = <span class="keyword">new</span> <a class="code" href="classAnswerHash.html">AnswerHash</a>(
                <span class="stringliteral">&#39;score&#39;</span>=&gt;0,
                <span class="stringliteral">&#39;correct_ans&#39;</span>=&gt;$right_ans,
                <span class="stringliteral">&#39;student_ans&#39;</span>=&gt;$student,
                <span class="stringliteral">&#39;original_student_ans&#39;</span> =&gt; $student,
                <span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;equation_cmp&#39;</span>,
                <span class="stringliteral">&#39;ans_message&#39;</span>=&gt;<span class="stringliteral">&#39;&#39;</span>,
                <span class="stringliteral">&#39;preview_text_string&#39;</span>=&gt;<span class="stringliteral">&#39;&#39;</span>,
                <span class="stringliteral">&#39;preview_latex_string&#39;</span>=&gt;<span class="stringliteral">&#39;&#39;</span>,
            );

            <span class="keywordflow">if</span>(! ($student =~ /\S/)) { <span class="keywordflow">return</span> $ans_hash; }

            my @right= <a class="code" href="classEquation__eval.html#a0af0be32d2ff7651d99b5863a255a008">split_eqn</a>($right_ans);
            <span class="keywordflow">if</span>(scalar(@right) != 2) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;Tell your professor that there is an error in this problem.&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }
            my @studsplit = <a class="code" href="classEquation__eval.html#a0af0be32d2ff7651d99b5863a255a008">split_eqn</a>($student);
            <span class="keywordflow">if</span>(scalar(@studsplit) != 2) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;You did not enter an equation (with an equals sign and two sides).&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }

<span class="preprocessor">            # Next we should do syntax checks on everyone</span>
<span class="preprocessor"></span>
            my $ah = <span class="keyword">new</span> <a class="code" href="classAnswerHash.html">AnswerHash</a>;
            $ah-&gt;input($right[0]);
            $ah=<a class="code" href="classmain.html#ad84aa049dc7dbbe6856c4dbc45be7e37">main::check_syntax</a>($ah);
            <span class="keywordflow">if</span>($ah-&gt;{error_flag}) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;Tell your professor that there is an error in this problem.&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }

            $ah-&gt;input($right[1]);
            $ah=<a class="code" href="classmain.html#ad84aa049dc7dbbe6856c4dbc45be7e37">main::check_syntax</a>($ah);
            <span class="keywordflow">if</span>($ah-&gt;{error_flag}) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;Tell your professor that there is an error in this problem.&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }

<span class="preprocessor">            # Correct answer checks out, now check student&#39;s syntax</span>
<span class="preprocessor"></span>
            my @prevs = (<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);
            my @prevtxt = (<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);
            $ah-&gt;input($studsplit[0]);
            $ah=<a class="code" href="classmain.html#ad84aa049dc7dbbe6856c4dbc45be7e37">main::check_syntax</a>($ah);
            <span class="keywordflow">if</span>($ah-&gt;{error_flag}) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;Syntax error on the left side of your equation.&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }
            $prevs[0] = $ah-&gt;{<span class="stringliteral">&#39;preview_latex_string&#39;</span>};
            $prevstxt[0] = $ah-&gt;{<span class="stringliteral">&#39;preview_text_string&#39;</span>};


            $ah-&gt;input($studsplit[1]);
            $ah=<a class="code" href="classmain.html#ad84aa049dc7dbbe6856c4dbc45be7e37">main::check_syntax</a>($ah);
            <span class="keywordflow">if</span>($ah-&gt;{error_flag}) {
                $ans_hash-&gt;{<span class="stringliteral">&#39;ans_message&#39;</span>} = <span class="stringliteral">&quot;Syntax error on the right side of your equation.&quot;</span>;
                <span class="keywordflow">return</span> $ans_hash;
            }
            $prevs[1] = $ah-&gt;{<span class="stringliteral">&#39;preview_latex_string&#39;</span>};
            $prevstxt[1] = $ah-&gt;{<span class="stringliteral">&#39;preview_text_string&#39;</span>};

            $ans_hash-&gt;{<span class="stringliteral">&#39;preview_latex_string&#39;</span>} = <span class="stringliteral">&quot;$prevs[0] = $prevs[1]&quot;</span>;
            $ans_hash-&gt;{<span class="stringliteral">&#39;preview_text_string&#39;</span>} = <span class="stringliteral">&quot;$prevstxt[0] = $prevstxt[1]&quot;</span>;


<span class="preprocessor">            # Check for answer equivalent to 0=0</span>
<span class="preprocessor"></span><span class="preprocessor">            # Could be false positive below because of parameter</span>
<span class="preprocessor"></span>            my $ae = <a class="code" href="classmain.html#aaa39ca082164d1a26bb017efc8162d07">main::fun_cmp</a>(<span class="stringliteral">&quot;0&quot;</span>, %opts);
            my $res = $ae-&gt;evaluate(<span class="stringliteral">&quot;$studsplit[0]-($studsplit[1])&quot;</span>);
            <span class="keywordflow">if</span>($res-&gt;{<span class="stringliteral">&#39;score&#39;</span>}==1) {
<span class="preprocessor">                # Student is 0=0, is correct answer also like this?</span>
<span class="preprocessor"></span>                $res = $ae-&gt;evaluate(<span class="stringliteral">&quot;$right[0]-($right[1])&quot;</span>);
                <span class="keywordflow">if</span>($res-&gt;{<span class="stringliteral">&#39;score&#39;</span>}==1) {
                    $ans_hash-&gt; setKeys(<span class="stringliteral">&#39;score&#39;</span> =&gt; $res-&gt;{<span class="stringliteral">&#39;score&#39;</span>});
                }
                <span class="keywordflow">return</span> $ans_hash;
            }

<span class="preprocessor">            # Maybe answer really is 0=0, and student got it wrong, so check that</span>
<span class="preprocessor"></span>            $res = $ae-&gt;evaluate(<span class="stringliteral">&quot;$right[0]-($right[1])&quot;</span>);
            <span class="keywordflow">if</span>($res-&gt;{<span class="stringliteral">&#39;score&#39;</span>}==1) {
                <span class="keywordflow">return</span> $ans_hash;
            }

<span class="preprocessor">            # Finally, use fun_cmp to check the answers</span>
<span class="preprocessor"></span>
            $ae = <a class="code" href="classmain.html#aaa39ca082164d1a26bb017efc8162d07">main::fun_cmp</a>(<span class="stringliteral">&quot;o*($right[0]-($right[1]))&quot;</span>, vars=&gt;$vars, params=&gt;[<span class="charliteral">&#39;o&#39;</span>], %opts);
            $res= $ae-&gt;evaluate(<span class="stringliteral">&quot;$studsplit[0]-($studsplit[1])&quot;</span>,%response_options);
            $ans_hash-&gt; setKeys(<span class="stringliteral">&#39;score&#39;</span> =&gt; $res-&gt;{<span class="stringliteral">&#39;score&#39;</span>});

            <span class="keywordflow">return</span> $ans_hash;
        };

        <span class="keywordflow">return</span> $ans_eval;
    }
sub <a class="code" href="classEquation__eval.html#ab2d91665fae148926332d590f89808b9">equation_cmp</a> {
    <a class="code" href="classEquation__eval.html#ab2d91665fae148926332d590f89808b9">Equation_eval::equation_cmp</a>(@_);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ad2652cc6dad31325c8693e307f17212c"></a><!-- doxytag: member="Equation_eval::interval_cmp" ref="ad2652cc6dad31325c8693e307f17212c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Equation_eval::interval_cmp </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-interval_cmp' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-interval_cmp-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-interval_cmp-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-interval_cmp-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in interval_cmp: 141</span>
<span class="preprocessor"></span>sub <a class="code" href="classEquation__eval.html#ad2652cc6dad31325c8693e307f17212c">interval_cmp</a> {
    my $correct_ans = shift;

    my %opts = @_;
    
    my $mode          = $opts{mode} || <span class="stringliteral">&#39;std&#39;</span>;
    my %options       = (debug =&gt; $opts{debug});
    my $ans_type = <span class="stringliteral">&#39;&#39;</span>; # <span class="keyword">set</span> to <a class="code" href="classList.html">List</a>, Union, or String below
    
<span class="preprocessor">    #</span>
<span class="preprocessor"></span><span class="preprocessor">    #  Get an apppropriate context based on the mode</span>
<span class="preprocessor"></span><span class="preprocessor">    #</span>
<span class="preprocessor"></span>    my $oldContext = Context();
    my $context = <a class="code" href="classEquation__eval.html#a073414fc00c9379e270c1be52c003ea9">mode2context</a>($mode, %opts);

    <span class="keywordflow">if</span>(defined($opts{unions}) and $opts{unions} eq <span class="stringliteral">&#39;no&#39;</span> ) {
<span class="preprocessor">        # This is really a list of points, not intervals at all</span>
<span class="preprocessor"></span>        $ans_type = <span class="stringliteral">&#39;List&#39;</span>;
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;(&#39;</span>);
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;[&#39;</span>);
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;{&#39;</span>);
        $context-&gt;operators-&gt;redefine(<span class="charliteral">&#39;u&#39;</span>,<span class="keyword">using</span>=&gt;<span class="charliteral">&#39;,&#39;</span>);
        $context-&gt;operators-&gt;set(u=&gt;{<span class="keywordtype">string</span>=&gt;<span class="stringliteral">&quot;, &quot;</span>, TeX=&gt;<span class="stringliteral">&#39;,\,&#39;</span>});
    } <span class="keywordflow">else</span> {
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;(&#39;</span>, from=&gt;<span class="stringliteral">&#39;Interval&#39;</span>);
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;[&#39;</span>, from=&gt;<span class="stringliteral">&#39;Interval&#39;</span>);
        $context-&gt;parens-&gt;redefine(<span class="charliteral">&#39;{&#39;</span>, from=&gt;<span class="stringliteral">&#39;Interval&#39;</span>);
        
        $context-&gt;constants-&gt;redefine(<span class="charliteral">&#39;R&#39;</span>,from=&gt;<span class="stringliteral">&#39;Interval&#39;</span>);
        $context-&gt;operators-&gt;redefine(<span class="charliteral">&#39;U&#39;</span>,from=&gt;<span class="stringliteral">&quot;Interval&quot;</span>);
        $context-&gt;operators-&gt;redefine(<span class="charliteral">&#39;u&#39;</span>,from=&gt;<span class="stringliteral">&quot;Interval&quot;</span>,<span class="keyword">using</span>=&gt;<span class="stringliteral">&quot;U&quot;</span>);
        $ans_type = <span class="stringliteral">&#39;Union&#39;</span>;
    }
<span class="preprocessor">    # Take optional arguments intended for List, or Union</span>
<span class="preprocessor"></span>    <span class="keywordflow">for</span> my $o (qw( showCoordinateHints showHints partialCredit showLengthHints )) {
        $options{$o} = $opts{$o} || 0;
    }
    $options{showUnionReduceWarnings} = $opts{showUnionReduceWarnings};
    $options{studentsMustReduceUnions} = $opts{studentsMustReduceUnions};
    <span class="keywordflow">if</span>(defined($opts{ordered}) and $opts{ordered}) {
        $options{ordered} = 1;
<span class="preprocessor">        # Force this option if the the union must be ordered</span>
<span class="preprocessor"></span>        $options{studentsMustReduceUnions} = 1;
    }
    <span class="keywordflow">if</span> (defined($opts{<span class="stringliteral">&#39;sloppy&#39;</span>}) &amp;&amp; $opts{<span class="stringliteral">&#39;sloppy&#39;</span>} eq <span class="stringliteral">&#39;yes&#39;</span>) {
         $options{requireParenMatch} = 0;
    }
<span class="preprocessor">    # historically we allow more infinities</span>
<span class="preprocessor"></span>    $context-&gt;strings-&gt;add(
        <span class="charliteral">&#39;i&#39;</span> =&gt; {alias=&gt;<span class="stringliteral">&#39;infinity&#39;</span>},
        <span class="stringliteral">&#39;infty&#39;</span> =&gt; {alias=&gt;<span class="stringliteral">&#39;infinity&#39;</span>},
        <span class="stringliteral">&#39;minfinity&#39;</span> =&gt; {infinite=&gt;1, negative=&gt;1},
        <span class="stringliteral">&#39;minfty&#39;</span> =&gt; {alias=&gt;<span class="stringliteral">&#39;minfinity&#39;</span>},
        <span class="stringliteral">&#39;minf&#39;</span> =&gt; {alias=&gt;<span class="stringliteral">&#39;minfinity&#39;</span>},
        <span class="stringliteral">&#39;mi&#39;</span> =&gt; {alias=&gt;<span class="stringliteral">&#39;minfinity&#39;</span>},
    );
<span class="preprocessor">    # Add any strings</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($opts{<a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>}) {
        <span class="keywordflow">foreach</span> my $string (@{$opts{<a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>}}) {
            $string = uc($string);
            $context-&gt;strings-&gt;add($string) unless
                defined($context-&gt;strings-&gt;get($string));
            $ans_type = <span class="stringliteral">&#39;String&#39;</span> <span class="keywordflow">if</span> $string eq uc($correct_ans);
        }
    }
<span class="preprocessor">    # Add any variables</span>
<span class="preprocessor"></span>    $opts{vars} = $opts{var} <span class="keywordflow">if</span> ($opts{var});
    <span class="keywordflow">if</span> ($opts{vars}) {
        $context-&gt;variables-&gt;are(); # clear old vars
        $opts{vars} = [$opts{vars}] unless ref($opts{vars}) eq <span class="stringliteral">&#39;ARRAY&#39;</span>;
        <span class="keywordflow">foreach</span> my $v (@{$opts{vars}}) {
            $context-&gt;variables-&gt;add($v=&gt;<span class="stringliteral">&#39;Real&#39;</span>)
                unless $context-&gt;variables-&gt;get($v);
        }
    }
    
    my $ans_eval;
    Context($context);
    <span class="keywordflow">if</span>($ans_type eq <span class="stringliteral">&#39;List&#39;</span>) {
        $ans_eval = List($correct_ans)-&gt;cmp(%options);
    } elsif($ans_type eq <span class="stringliteral">&#39;Union&#39;</span>) {
        $ans_eval = Union($correct_ans)-&gt;cmp(%options);
    } elsif($ans_type eq <span class="stringliteral">&#39;String&#39;</span>) {
        $ans_eval = List($correct_ans)-&gt;cmp(%options);
    } <span class="keywordflow">else</span> {
        warn <span class="stringliteral">&quot;Bug -- should not be here in interval_cmp&quot;</span>;
    }
        
    Context($oldContext);
    <span class="keywordflow">return</span>($ans_eval);
}

=head2 <a class="code" href="classEquation__eval.html#a43ea00f79be8e2e0162a8629ec898c83">number_list_cmp</a>

Checks an answer which is a comma-separated list of numbers.  The actual
numbers are fed to num_cmp, so all of the flexibilty of num_cmp carries
over (values can be expressions to be evaluated).  For example,

    <a class="code" href="classEquation__eval.html#a43ea00f79be8e2e0162a8629ec898c83">number_list_cmp</a>(<span class="stringliteral">&quot;1, -2&quot;</span>)

will accept &quot;1, -2&quot;, &quot;-2, 1&quot;, or &quot;-1-1,sqrt(1)&quot;.

    <a class="code" href="classEquation__eval.html#a43ea00f79be8e2e0162a8629ec898c83">number_list_cmp</a>(&quot;1^2 + 1, 2^2 + 1, 3^2 + 1&quot;, ordered=&gt;&#39;strict&#39;)

will accept &quot;2, 5, 10&quot;, but not &quot;5, 2, 10&quot;.

If you want to allow complex number entries, complex=&gt;&#39;ok&#39; will cause it
to use cplx_cmp instead:

    number_list_cmp(&quot;2, -2, 2i, -2i&quot;, complex=&gt;&#39;ok&#39;)

In cases where you set complex=&gt;&#39;ok&#39;, be sure the problem file loads
PGcomplexmacros.pl.

Optional arguements for num_cmp (resp. cplx_cmp) can be used as well,
such as

    number_list_cmp(&quot;cos(3), sqrt(111)&quot;, relTol =&gt; 3)

The <a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>=&gt;[&#39;hello&#39;] argument is treated specially.  It can be used to
replace the entire answer.  So

    number_list_cmp(&quot;cos(3), sqrt(111)&quot;, <a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>=&gt;[&#39;none&#39;])

will mark &quot;none&quot; wrong, but not generate an error.  On the other hand,

    number_list_cmp(&quot;none&quot;, <a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>=&gt;[&#39;none&#39;])

will mark &quot;none&quot; as correct.

One can also specify optionnal arguments for <a class="code" href="classParser.html">Parser</a>&#39;s List checker: showHints,
partialCredit, and showLengthHints, as in:

    number_list_cmp(&quot;cos(3), sqrt(111)&quot;, partialCredit=&gt;1)

=cut

<span class="preprocessor"># ^function number_list_cmp</span>
<span class="preprocessor"></span><span class="preprocessor"># ^uses Context</span>
<span class="preprocessor"></span><span class="preprocessor"># ^uses mode2context</span>
<span class="preprocessor"># ^uses List</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a073414fc00c9379e270c1be52c003ea9"></a><!-- doxytag: member="Equation_eval::mode2context" ref="a073414fc00c9379e270c1be52c003ea9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Equation_eval::mode2context </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-mode2context' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-mode2context-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-mode2context-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-mode2context-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in mode2context: 60</span>
<span class="preprocessor"></span>sub <a class="code" href="classEquation__eval.html#a073414fc00c9379e270c1be52c003ea9">mode2context</a> {
    my $mode = shift;
    my %options = @_;
    my $context;
    <span class="keywordflow">for</span> ($mode) {
        /^strict$/i  and <span class="keywordflow">do</span> {
            $context = <a class="code" href="classParser_1_1Context.html">Parser::Context</a>-&gt;getCopy(\%main::context,<span class="stringliteral">&quot;LimitedNumeric&quot;</span>);
            $context-&gt;operators-&gt;redefine(<span class="charliteral">&#39;,&#39;</span>);
            last;
        };
        /^arith$/i   and <span class="keywordflow">do</span> {
            $context = <a class="code" href="classParser_1_1Context.html">Parser::Context</a>-&gt;getCopy(\%main::context,<span class="stringliteral">&quot;LegacyNumeric&quot;</span>);
            $context-&gt;functions-&gt;disable(<span class="stringliteral">&#39;All&#39;</span>);
            last;
        };
        /^frac$/i    and <span class="keywordflow">do</span> {
            $context = <a class="code" href="classParser_1_1Context.html">Parser::Context</a>-&gt;getCopy(\%main::context,<span class="stringliteral">&quot;LimitedNumeric-Fraction&quot;</span>);
            $context-&gt;operators-&gt;redefine(<span class="charliteral">&#39;,&#39;</span>);
            last;
        };
        
<span class="preprocessor">        # default</span>
<span class="preprocessor"></span>        $context = <a class="code" href="classParser_1_1Context.html">Parser::Context</a>-&gt;getCopy(\%main::context,<span class="stringliteral">&quot;LegacyNumeric&quot;</span>);
    }
<span class="preprocessor">    # If we are using complex numbers, then we ignore the other mode parts</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span>(defined($options{<span class="stringliteral">&#39;complex&#39;</span>}) &amp;&amp;
       ($options{<span class="stringliteral">&#39;complex&#39;</span>} =~ /(yes|ok)/i)) {
<span class="preprocessor">        #$context-&gt;constants-&gt;redefine(&#39;i&#39;, from=&gt;&#39;Complex&#39;);</span>
<span class="preprocessor"></span><span class="preprocessor">        #$context-&gt;functions-&gt;redefine([&#39;arg&#39;,&#39;mod&#39;,&#39;Re&#39;,&#39;Im&#39;,&#39;conj&#39;, &#39;sqrt&#39;, &#39;log&#39;], from=&gt;&#39;Complex&#39;);</span>
<span class="preprocessor"></span><span class="preprocessor">        #$context-&gt;operators-&gt;redefine([&#39;^&#39;, &#39;**&#39;], from=&gt;&#39;Complex&#39;);</span>
<span class="preprocessor"></span>        $context = <a class="code" href="classParser_1_1Context.html">Parser::Context</a>-&gt;getCopy(\%main::context,<span class="stringliteral">&quot;Complex&quot;</span>);
    }
    $options{tolType} = $options{tolType} || <span class="stringliteral">&#39;relative&#39;</span>;
    $options{tolType} = <span class="stringliteral">&#39;absolute&#39;</span> <span class="keywordflow">if</span> defined($options{tol});
    $options{zeroLevel} = $options{zeroLevel} || $options{zeroLevelTol} ||
        $main::numZeroLevelTolDefault;
    <span class="keywordflow">if</span> ($options{tolType} eq <span class="stringliteral">&#39;absolute&#39;</span> or defined($options{abstol})) {
        $options{tolerance} = $options{tolerance} || $options{tol} ||
            $options{reltol} || $options{relTol} || $options{abstol} ||
            $main::numAbsTolDefault;
        $context-&gt;flags-&gt;set(
            tolerance =&gt; $options{tolerance},
            tolType =&gt; <span class="stringliteral">&#39;absolute&#39;</span>,
            );
    } <span class="keywordflow">else</span> {
        $options{tolerance} = $options{tolerance} || $options{tol} ||
            $options{reltol} || $options{relTol} || $options{abstol} ||
            $main::numRelPercentTolDefault;
        $context-&gt;flags-&gt;set(
            tolerance =&gt; .01*$options{tolerance},
            tolType =&gt; <span class="stringliteral">&#39;relative&#39;</span>,
            );
    }
    $context-&gt;flags-&gt;set(
        zeroLevel =&gt; $options{zeroLevel},
        zeroLevelTol =&gt; $options{zeroLevelTol} || $main::numZeroLevelTolDefault,
        );
    $context-&gt;{format}{number} = $options{<span class="stringliteral">&#39;format&#39;</span>} || $main::numFormatDefault;
    <span class="keywordflow">return</span>($context);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a43ea00f79be8e2e0162a8629ec898c83"></a><!-- doxytag: member="Equation_eval::number_list_cmp" ref="a43ea00f79be8e2e0162a8629ec898c83" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Equation_eval::number_list_cmp </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-number_list_cmp' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-number_list_cmp-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-number_list_cmp-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-number_list_cmp-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in number_list_cmp: 56</span>
<span class="preprocessor"></span>sub number_list_cmp {
    my $list = shift;

    my %num_params = @_;

    my $mode          = $num_params{mode} || <span class="stringliteral">&#39;std&#39;</span>;
    my %options       = (debug =&gt; $num_params{debug});

<span class="preprocessor">    #</span>
<span class="preprocessor"></span><span class="preprocessor">    #  Get an apppropriate context based on the mode</span>
<span class="preprocessor"></span><span class="preprocessor">    #</span>
<span class="preprocessor"></span>    my $oldContext = Context();
    my $context = <a class="code" href="classEquation__eval.html#a073414fc00c9379e270c1be52c003ea9">mode2context</a>($mode, %num_params);

<span class="preprocessor">    #$context-&gt;strings-&gt;clear;</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ($num_params{<a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>}) {
        <span class="keywordflow">foreach</span> my $string (@{$num_params{<a class="code" href="PGstringevaluators_8pl.html#a06b59ff01c251186550d61193ec7f328">strings</a>}}) {
            my %tex = ($string =~ m/(-?)inf(inity)?/i)? (TeX =&gt; <span class="stringliteral">&quot;$1\\infty&quot;</span>): ();
            $string = uc($string);
            $context-&gt;strings-&gt;add($string =&gt; {%tex}) unless
                defined($context-&gt;strings-&gt;get($string));
        }
    }

    $options{ordered} = 1 <span class="keywordflow">if</span> defined($num_params{ordered});
<span class="preprocessor">    # These didn&#39;t exist before in number_list_cmp so they behaved like</span>
<span class="preprocessor"></span><span class="preprocessor">    # in List()-&gt;cmp.  Now they can be optionally set</span>
<span class="preprocessor"></span>    <span class="keywordflow">for</span> my $o (qw( showHints partialCredit showLengthHints )) {
        $options{$o} = $num_params{$o} || 0;
    }

    Context($context);
    my $ans_eval = List($list)-&gt;cmp(%options);
    Context($oldContext);
    <span class="keywordflow">return</span>($ans_eval);
}


=heads <a class="code" href="classEquation__eval.html#ab2d91665fae148926332d590f89808b9">equation_cmp</a>

Compares an equation.  This really piggy-backs off of fun_cmp.  It looks
at LHS-RHS of the equations to see <span class="keywordflow">if</span> they agree up to constant multiple.
It also guards against an answer of 0=0 (which technically gives a constant
multiple of any equation).  It is best suited to situations such as checking
the equation of a line which might be vertical and you don<span class="stringliteral">&#39;t want to give</span>
<span class="stringliteral">that away, or checking equations of ellipses where the students answer should</span>
<span class="stringliteral">be quadratic.</span>
<span class="stringliteral"></span>
<span class="stringliteral">Typical invocation would be:</span>
<span class="stringliteral"></span>
<span class="stringliteral">    equation_com(&quot;x^2+(y-1)^2 = 11&quot;, vars=&gt;[&#39;</span>x<span class="charliteral">&#39;,&#39;</span>y<span class="stringliteral">&#39;])</span>
<span class="stringliteral"></span>
<span class="stringliteral">=cut</span>
<span class="stringliteral"></span>
<span class="stringliteral"># ^function equation_cmp</span>
<span class="stringliteral"># ^uses Equation_eval::equation_cmp</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a0af0be32d2ff7651d99b5863a255a008"></a><!-- doxytag: member="Equation_eval::split_eqn" ref="a0af0be32d2ff7651d99b5863a255a008" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Equation_eval::split_eqn </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-split_eqn' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-split_eqn-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-split_eqn-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-split_eqn-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in split_eqn: 5</span>
<span class="preprocessor"></span>    sub <a class="code" href="classEquation__eval.html#a0af0be32d2ff7651d99b5863a255a008">split_eqn</a> {
        my $instring = shift;
        
        split /=/, $instring;
    }
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="extraAnswerEvaluators_8pl_source.html">extraAnswerEvaluators.pl</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:54:56 2012 for PG by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
