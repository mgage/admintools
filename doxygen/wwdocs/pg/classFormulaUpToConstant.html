<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PG: FormulaUpToConstant Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>FormulaUpToConstant Class Reference</h1><!-- doxytag: class="FormulaUpToConstant" --><div class="dynheader">
Inheritance diagram for FormulaUpToConstant:</div>
<div class="dynsection">
<div class="center"><img src="classFormulaUpToConstant__inherit__graph.png" border="0" usemap="#FormulaUpToConstant_inherit__map" alt="Inheritance graph"/></div>
<map name="FormulaUpToConstant_inherit__map" id="FormulaUpToConstant_inherit__map">
<area shape="rect" href="classFormulaUpToConstant_1_1Variable.html" title="FormulaUpToConstant::Variable" alt="" coords="5,80,208,107"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classFormulaUpToConstant-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant_1_1Variable.html">Variable</a></td></tr>
<tr><td colspan="2"><h2>Avaliable Methods</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp9be22fb8347fa3884856571d2a5f020b"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#ae523903009f400192ca1cdaa9dbb6121">compare</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#ae88029d8542a6d16ecc2e97b15210f41">cmp_postprocess</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a192ee4841c3cb10d5d9e87488832074f">cmp_diagnostics</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a9bc950b0da680b6d80d23a5280810150">cmp_defaults</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a1c34f75f9ea613970aae5b485cf1c2bf">addConstants</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#ae3c8984d0fa514a99724aabfc6639e8b">D</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#ab77e14d18ed86d58027bb078bf9a3f56">removeConstant</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a6d7bbde865403ee86fc111bda4bf48c8">Init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a3360d144ee66bcf70e17b91ed8a4159d">new</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#a79376bd49d053bc4569a30aa470d79dd">cmp_graph</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">public method&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFormulaUpToConstant.html#aeb31a9598c2c1ab5201c79f312d6c6be">adjustInherit</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="parserFormulaUpToConstant_8pl_source.html#l00098">98</a> of file <a class="el" href="parserFormulaUpToConstant_8pl_source.html">parserFormulaUpToConstant.pl</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a32fb943b0406460ee6b3b5dcada4f528"></a><!-- doxytag: member="FormulaUpToConstant::adapt" ref="a32fb943b0406460ee6b3b5dcada4f528" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::adapt </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-adapt' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-adapt-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-adapt-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-adapt-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in adapt: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a> {
  my $self = shift;
  <span class="keywordflow">return</span> $self-&gt;adjustInherit($self-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>});
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a1c34f75f9ea613970aae5b485cf1c2bf"></a><!-- doxytag: member="FormulaUpToConstant::addConstants" ref="a1c34f75f9ea613970aae5b485cf1c2bf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::addConstants </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-addConstants' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-addConstants-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-addConstants-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-addConstants-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in addConstants: 20</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#a1c34f75f9ea613970aae5b485cf1c2bf">addConstants</a> {
  my $self = shift; my $points = shift;
  my @names = $self-&gt;context-&gt;variables-&gt;variables;
  my $variables = $self-&gt;context-&gt;{variables};
  my $Points = [];
  <span class="keywordflow">foreach</span> my $p (@{$points}) {
    <span class="keywordflow">if</span> (scalar(@{$p}) == scalar(@names)) {
      push (@{$Points},$p);
    } <span class="keywordflow">else</span> {
      my @P = (.1) x scalar(@names); my $j = 0;
      <span class="keywordflow">foreach</span> my $i (0..scalar(@names)-1) {
        <span class="keywordflow">if</span> (!$variables-&gt;{$names[$i]}{arbitraryConstant}) {
      $P[$i] = $p-&gt;[$j] <span class="keywordflow">if</span> defined $p-&gt;[$j]; $j++;
    }
      }
      push (@{$Points}, \@P);
    }
  }
  <span class="keywordflow">return</span> $Points;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="aeb31a9598c2c1ab5201c79f312d6c6be"></a><!-- doxytag: member="FormulaUpToConstant::adjustInherit" ref="aeb31a9598c2c1ab5201c79f312d6c6be" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::adjustInherit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-adjustInherit' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-adjustInherit-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-adjustInherit-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-adjustInherit-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in adjustInherit: 17</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#aeb31a9598c2c1ab5201c79f312d6c6be">adjustInherit</a> {
  my $self = shift;
  my $f = shift-&gt;inherit($self);
  <span class="keyword">delete</span> $f-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>}; <span class="keyword">delete</span> $f-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>};
  <span class="keywordflow">foreach</span> my $id (<span class="stringliteral">&#39;test_points&#39;</span>,<span class="stringliteral">&#39;test_at&#39;</span>) {
    <span class="keywordflow">if</span> (defined $f-&gt;{$id}) {
      $f-&gt;{$id} = [$f-&gt;{$id}-&gt;value] <span class="keywordflow">if</span> <a class="code" href="classValue.html#a43e6b7aa1e386a5a9056190d0ac3cbb3">Value::isValue</a>($f-&gt;{$id});
      $f-&gt;{$id} = [$f-&gt;{$id}] unless ref($f-&gt;{$id}) eq <span class="stringliteral">&#39;ARRAY&#39;</span>;
      $f-&gt;{$id} = [map {
    (<a class="code" href="classValue.html#a43e6b7aa1e386a5a9056190d0ac3cbb3">Value::isValue</a>($_) ? [$_-&gt;value] :
        (ref($_) eq &#39;ARRAY&#39;? $_ : [$_]))
      } @{$f-&gt;{$id}}];
      $f-&gt;{$id} = $self-&gt;addConstants($f-&gt;{$id});
    }
  }
  <span class="keywordflow">return</span> $f;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a9bc950b0da680b6d80d23a5280810150"></a><!-- doxytag: member="FormulaUpToConstant::cmp_defaults" ref="a9bc950b0da680b6d80d23a5280810150" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::cmp_defaults </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cmp_defaults' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cmp_defaults-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cmp_defaults-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cmp_defaults-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cmp_defaults: 1</span>
<span class="preprocessor">sub cmp_defaults {((shift)-&gt;SUPER::cmp_defaults,showHints =&gt; 1, showLinearityHints =&gt; 1)};</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a192ee4841c3cb10d5d9e87488832074f"></a><!-- doxytag: member="FormulaUpToConstant::cmp_diagnostics" ref="a192ee4841c3cb10d5d9e87488832074f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::cmp_diagnostics </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cmp_diagnostics' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cmp_diagnostics-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cmp_diagnostics-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cmp_diagnostics-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cmp_diagnostics: 7</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#a192ee4841c3cb10d5d9e87488832074f">cmp_diagnostics</a> {
  my $self = shift;
  my $adapt = $self-&gt;inherit($self-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>});
  $adapt-&gt;{test_values} = $self-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>}{test_values};  # these aren<span class="stringliteral">&#39;t copied by inherit</span>
<span class="stringliteral">  $adapt-&gt;{test_adapt}  = $self-&gt;{adapt}{test_adapt};</span>
<span class="stringliteral">  $adapt-&gt;SUPER::cmp_diagnostics(@_);</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a79376bd49d053bc4569a30aa470d79dd"></a><!-- doxytag: member="FormulaUpToConstant::cmp_graph" ref="a79376bd49d053bc4569a30aa470d79dd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::cmp_graph </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cmp_graph' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cmp_graph-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cmp_graph-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cmp_graph-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cmp_graph: 10</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#a79376bd49d053bc4569a30aa470d79dd">cmp_graph</a> {
  my $self = shift; my $diagnostics = shift;
  my $F1 = shift; my $F2; ($F1,$F2) = @{$F1} <span class="keywordflow">if</span> (ref($F1) eq <span class="stringliteral">&#39;ARRAY&#39;</span>);
  my %subs; my $context = $self-&gt;context;
  <span class="keywordflow">foreach</span> my $v ($context-&gt;variables-&gt;variables)
    {$subs{$v} = 0 <span class="keywordflow">if</span> ($context-&gt;variables-&gt;get($v)-&gt;{arbitraryConstant})}
  $F1 = $F1-&gt;inherit($F1-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>})-&gt;substitute(%subs)-&gt;reduce;
  $F2 = $F2-&gt;inherit($F2-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>})-&gt;substitute(%subs)-&gt;reduce;
  $self-&gt;SUPER::cmp_graph($diagnostics,[$F1,$F2]);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae88029d8542a6d16ecc2e97b15210f41"></a><!-- doxytag: member="FormulaUpToConstant::cmp_postprocess" ref="ae88029d8542a6d16ecc2e97b15210f41" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::cmp_postprocess </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-cmp_postprocess' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-cmp_postprocess-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-cmp_postprocess-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-cmp_postprocess-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in cmp_postprocess: 21</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#ae88029d8542a6d16ecc2e97b15210f41">cmp_postprocess</a> {
  my $self = shift; my $ans = shift;
  $self-&gt;SUPER::cmp_postprocess($ans,@_);
  <span class="keywordflow">return</span> unless $ans-&gt;{score} == 0 &amp;&amp; !$ans-&gt;{isPreview};
  <span class="keywordflow">return</span> <span class="keywordflow">if</span> $ans-&gt;{ans_message} || !$self-&gt;getFlag(<span class="stringliteral">&quot;showHints&quot;</span>);
  my $student = $ans-&gt;{student_value};
  my $result = <a class="code" href="classParser.html#a5f2be0771afb5a51b5e4f5c277ca550b">Parser::Eval</a>(sub {<span class="keywordflow">return</span> $ans-&gt;{correct_value} &lt;=&gt; $student}); # <a class="code" href="classFormulaUpToConstant.html#ae523903009f400192ca1cdaa9dbb6121">compare</a> encodes the reason in the result
  $self-&gt;cmp_Error($ans,<span class="stringliteral">&quot;Note: there is always more than one possibility&quot;</span>) <span class="keywordflow">if</span> $result == 2 || $result == 3;
  <span class="keywordflow">if</span> ($result == 3) {
    my $context = $self-&gt;context;
    $context-&gt;flags-&gt;set(no_parameters=&gt;0);
    $context-&gt;variables-&gt;add(x00=&gt;<span class="stringliteral">&#39;Real&#39;</span>);
    my $correct = $self-&gt;removeConstant+<span class="stringliteral">&quot;n01+n00x00&quot;</span>;    # must use both parameters
    $result = 1 <span class="keywordflow">if</span> $correct-&gt;cmp_compare($student+<span class="stringliteral">&quot;x00&quot;</span>,{});
    $context-&gt;variables-&gt;remove(<span class="stringliteral">&#39;x00&#39;</span>);
    $context-&gt;flags-&gt;set(no_parameters=&gt;1);
  }
  $self-&gt;cmp_Error($ans,<span class="stringliteral">&quot;Your answer is not the most general solution&quot;</span>) <span class="keywordflow">if</span> $result == 1;
  $self-&gt;cmp_Error($ans,<span class="stringliteral">&quot;Your formula should be linear in the constant &#39;$student-&gt;{constant}&#39;&quot;</span>)
    <span class="keywordflow">if</span> $result == -1 &amp;&amp; $self-&gt;getFlag(<span class="stringliteral">&quot;showLinearityHints&quot;</span>) &amp;&amp; !$student-&gt;D($student-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>})-&gt;isConstant;
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae523903009f400192ca1cdaa9dbb6121"></a><!-- doxytag: member="FormulaUpToConstant::compare" ref="ae523903009f400192ca1cdaa9dbb6121" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::compare </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-compare' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-compare-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-compare-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-compare-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in compare: 30</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#ae523903009f400192ca1cdaa9dbb6121">compare</a> {
  my ($l,$r) = @_; my $self = $l; my $context = $self-&gt;context;
  $r = <a class="code" href="classValue.html#a43a81d16f2f6aee0019772bf09626569">Value::makeValue</a>($r,<a class="code" href="classcontext.html">context</a>=&gt;$context) unless <a class="code" href="classValue.html">Value</a>::isValue($r);
  <span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">  #  Not equal if the student value is constant or has no + C</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  <span class="keywordflow">return</span> 2 <span class="keywordflow">if</span> !<a class="code" href="classValue.html#afa346ffc3c989970326e02766a63523a">Value::isFormula</a>($r);
  <span class="keywordflow">return</span> 3 <span class="keywordflow">if</span> !defined($r-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>});
<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  If constants aren&#39;t the same, substitute the professor&#39;s in the student answer.</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  $r = $r-&gt;substitute($r-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>}=&gt;$l-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>}) unless $r-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>} eq $l-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>};
  $r-&gt;context($context) unless $r-&gt;context == $context;

<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  Compare with adaptive parameters to see if $l + n00 C = $r for some n0.</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  my $adapt = $l-&gt;adapt;
  my $equal = <a class="code" href="classParser.html#a5f2be0771afb5a51b5e4f5c277ca550b">Parser::Eval</a>(sub {$adapt == $r});
  $self-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>} = $self-&gt;{<a class="code" href="classFormulaUpToConstant.html#a32fb943b0406460ee6b3b5dcada4f528">adapt</a>}-&gt;inherit($adapt);            # save the adapted value<span class="stringliteral">&#39;s flags</span>
<span class="stringliteral">  $self-&gt;{adapt}{test_values} = $adapt-&gt;{test_values};         #  (these two are removed by inherit)</span>
<span class="stringliteral">  $self-&gt;{adapt}{test_adapt} = $adapt-&gt;{test_adapt};</span>
<span class="stringliteral">  $_[1]-&gt;{test_values} = $r-&gt;{test_values};            # save these in student answer for diagnostics</span>
<span class="stringliteral">  return -1 unless $equal;</span>
<span class="stringliteral">  #</span>
<span class="stringliteral">  #  Check that n00 is non-zero (i.e., there is a multiple of C in the student answer)</span>
<span class="stringliteral">  #  (remember: return value of 0 is equal, and non-zero is unequal)</span>
<span class="stringliteral">  #</span>
<span class="stringliteral">  return abs($context-&gt;variables-&gt;get(&quot;n00&quot;)-&gt;{value}) &lt; $context-&gt;flag(&quot;zeroLevelTol&quot;);</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="afddbbf92a73c5804fa50dac72c4d5bf8"></a><!-- doxytag: member="FormulaUpToConstant::constant" ref="afddbbf92a73c5804fa50dac72c4d5bf8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::constant </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-constant' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-constant-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-constant-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-constant-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in constant: 1</span>
<span class="preprocessor">sub constant {(shift)-&gt;{constant}}</span>
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="ae3c8984d0fa514a99724aabfc6639e8b"></a><!-- doxytag: member="FormulaUpToConstant::D" ref="ae3c8984d0fa514a99724aabfc6639e8b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::D </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-D' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-D-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-D-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-D-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in D: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#ae3c8984d0fa514a99724aabfc6639e8b">D</a> {
  my $self = shift;
  $self-&gt;removeConstant-&gt;D(@_);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a6d7bbde865403ee86fc111bda4bf48c8"></a><!-- doxytag: member="FormulaUpToConstant::Init" ref="a6d7bbde865403ee86fc111bda4bf48c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::Init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-Init' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-Init-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-Init-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-Init-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in Init: 3</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#a6d7bbde865403ee86fc111bda4bf48c8">Init</a> {
  main::PG_restricted_eval(<span class="stringliteral">&#39;sub FormulaUpToConstant {FormulaUpToConstant-&gt;new(@_)}&#39;</span>);
}
</pre></div>  
</div>
 
</div>
</div>
<a class="anchor" id="a3360d144ee66bcf70e17b91ed8a4159d"></a><!-- doxytag: member="FormulaUpToConstant::new" ref="a3360d144ee66bcf70e17b91ed8a4159d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::new </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-new' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-new-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-new-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-new-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in new: 42</span>
<span class="preprocessor"></span>sub <span class="keyword">new</span> {
  my $self = shift; my $class = ref($self) || $self;
<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  Copy the context (so we can modify it) and</span>
<span class="preprocessor"></span><span class="preprocessor">  #  replace the usual Variable object with our own.</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  my $context = (<a class="code" href="classValue.html#a2d6d7d0072c75611908bf0a79080e8df">Value::isContext</a>($_[0]) ? shift : $self-&gt;context)-&gt;copy;
  $context-&gt;{<a class="code" href="classparser.html">parser</a>}{Variable} = <span class="stringliteral">&#39;FormulaUpToConstant::Variable&#39;</span>;
<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  Create a formula from the user&#39;s input.</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  my $f = <a class="code" href="classmain.html#ab063cfe6ed872a57d8d0ca0b2ec1e69f">main::Formula</a>($context,@_);
<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  If it doesn&#39;t have a constant already, add one.</span>
<span class="preprocessor"></span><span class="preprocessor">  #  (should check that C isn&#39;t already in use, and look</span>
<span class="preprocessor"></span><span class="preprocessor">  #   up the first free name, but we&#39;ll cross our fingers</span>
<span class="preprocessor"></span><span class="preprocessor">  #   for now.  Could look through the defined variables</span>
<span class="preprocessor"></span><span class="preprocessor">  #   to see if there is already an arbitraryConstant</span>
<span class="preprocessor"></span><span class="preprocessor">  #   and use that.)</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  unless ($f-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>}) {$f = $f + <span class="stringliteral">&quot;C&quot;</span>, $f-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>} = <span class="stringliteral">&quot;C&quot;</span>}
<span class="preprocessor">  #</span>
<span class="preprocessor"></span><span class="preprocessor">  #  Check that the formula is linear in C.</span>
<span class="preprocessor"></span><span class="preprocessor">  #</span>
<span class="preprocessor"></span>  my $n = $f-&gt;D($f-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>});
  <a class="code" href="classValue.html">Value</a>-&gt;Error(<span class="stringliteral">&quot;Your formula isn&#39;t linear in the arbitrary constant &#39;%s&#39;&quot;</span>,$f-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>})
    unless $n-&gt;isConstant;
  #
  #  Make a version with adaptive parameters <span class="keywordflow">for</span> use in the
  #  comparison later on.  We could like n00*C, but already have $n
  #  copies of C, so <span class="keyword">remove</span> them.  That way, n00 will be 0 when there
  #  are no C<span class="stringliteral">&#39;s in the student answer during the adaptive comparison.</span>
<span class="stringliteral">  #  (Again, should really check that n00 is not in use already)</span>
<span class="stringliteral">  #</span>
<span class="stringliteral">  my $n00 = $context-&gt;variables-&gt;get(&quot;n00&quot;);</span>
<span class="stringliteral">  $context-&gt;variables-&gt;add(n00=&gt;&#39;</span>Parameter<span class="stringliteral">&#39;) unless $n00 and $n00-&gt;{parameter};</span>
<span class="stringliteral">  my $n01 = $context-&gt;variables-&gt;get(&quot;n01&quot;);</span>
<span class="stringliteral">  $context-&gt;variables-&gt;add(n01=&gt;&#39;</span>Parameter<span class="stringliteral">&#39;) unless $n01 and $n01-&gt;{parameter};</span>
<span class="stringliteral">  $f-&gt;{adapt} = $f + &quot;(n00-$n)$f-&gt;{constant} + n01&quot;;</span>
<span class="stringliteral"></span>
<span class="stringliteral">  return bless $f, $class;</span>
<span class="stringliteral">}</span>
</pre></div>  
</div>
 
<p>Reimplemented in <a class="el" href="classFormulaUpToConstant_1_1Variable.html#a2ffada8a707440f87fb1b3e896a5eedd">FormulaUpToConstant::Variable</a>.</p>

</div>
</div>
<a class="anchor" id="ab77e14d18ed86d58027bb078bf9a3f56"></a><!-- doxytag: member="FormulaUpToConstant::removeConstant" ref="ab77e14d18ed86d58027bb078bf9a3f56" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method FormulaUpToConstant::removeConstant </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Undocumented Method  
<div id='codesection-removeConstant' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
	<img id='codesection-removeConstant-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-removeConstant-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-removeConstant-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><pre class="fragment"><span class="preprocessor"># Number of lines of code in removeConstant: 4</span>
<span class="preprocessor"></span>sub <a class="code" href="classFormulaUpToConstant.html#ab77e14d18ed86d58027bb078bf9a3f56">removeConstant</a> {
  my $self = shift;
  <span class="keywordflow">return</span> $self-&gt;adjustInherit(<a class="code" href="classmain.html#ab063cfe6ed872a57d8d0ca0b2ec1e69f">main::Formula</a>($self-&gt;substitute($self-&gt;{<a class="code" href="classFormulaUpToConstant.html#afddbbf92a73c5804fa50dac72c4d5bf8">constant</a>}=&gt;0))-&gt;reduce);
}
</pre></div>  
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="parserFormulaUpToConstant_8pl_source.html">parserFormulaUpToConstant.pl</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Jun 8 22:54:56 2012 for PG by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
